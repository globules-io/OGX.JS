/* globules.io OGX.JS 1.5.5.3 */ 
window.console||(window.console={});for(var methods=["log","debug","warn","info"],i=0;i<methods.length;i++)console[methods[i]]=function(){};if(void 0===OGX)var OGX={};if(OGX.Data={},OGX.Data.weld=function(t,r,e,i){void 0===e&&(e=!1),void 0===i&&(i=!1);var a=t;return i&&(a=JSON.parse(JSON.stringify(t))),function t(r,i){for(var a in i)!r.hasOwnProperty(a)||e?r[a]=i[a]:"object"==typeof i[a]&&t(r[a],i[a])}(a,r),a},OGX.Data.merge=function(t,r,e,i,a){for(var s in void 0===e&&(e=!1),void 0===i&&(i=!1),void 0===a&&(a=!1),i&&(t=JSON.parse(JSON.stringify(t))),r)e?a?t.hasOwnProperty(s)&&(t[s]=r[s]):t[s]=r[s]:t.hasOwnProperty(s)||a||(t[s]=r[s]);return t},OGX.Data.props=function(t,r){for(var e in r)if(!t.hasOwnProperty(r[e]))return!1;return!0},OGX.Data.clone=function(t){return JSON.parse(JSON.stringify(t))},OGX.Data.isOML=function(t){for(var r in t)if(-1!==r.indexOf(":"))return!0;return!1},OGX.Data.stringToVal=function(t){var r=-1;return"true"===t&&(r=!0),"false"===t&&(r=!1),-1!==r?r:t.match(/^([0-9]+(\.[0-9]+)?)$/g)?Number(t):t.match(/^(\[|{)/g)?JSON.parse(t):t},OGX.Data.pad=function(t,r,e,i){void 0===i&&(i="0"),void 0===e&&(e=-1);for(var a=String(t);a.length<r;)-1===e?a=i+a:a+=i;return a},OGX.Data.addDec=function(t){return parseFloat(Math.round(100*t)/100).toFixed(2)},OGX.Data.isInt=function(t){return Number(t)===t&&t%1==0},OGX.Data.isFloat=function(t){return Number(t)===t&&t%1!=0},OGX.Data.getBestSize=function(t,r,e,i){if(void 0===e&&(e=10),void 0===i&&(i=200),"string"==typeof r){if(-1!==r.indexOf("|")){for(var a,s=r.split("|"),n=new OGX.List,o=0;o<s.length;o++)-1!==(a=s[o]).indexOf("px")&&(a=a.replace("px","")),-1!==a.indexOf("%")&&(a=Math.round(Number(a.split("%")[0])*t/100)),a<=t&&n.insert({m:t-a,s:s[o],n:a});return n.order("m",1),"100%"===n[0].s&&n.length>1&&n[1].m<i?n[1].n:n[0].n}(m=/(\d+)(%|px)?/gi.exec(r))&&("%"===m[2].trim()?r=Math.round(Number(m[1])*t/100):("px"===m[2].trim()&&(r=m[1]),r=Number(r)))}return r},void 0===OGX)var OGX={};OGX.List=function(){var filteringMode="and",filterCount=0,indexes=!1;1===arguments.length&&arguments[0]instanceof Array&&(arguments=arguments[0]);var array=Object.create(Array.prototype);for(var method in array=Array.apply(array,arguments)||array,OGX.List.prototype)OGX.List.prototype.hasOwnProperty(method)&&(array[method]=OGX.List.prototype[method]);function addToCache(t){var r;for(var e in indexes){if(-1!==e.indexOf("|")){e=e.split("|"),r=[];for(var i=0;i<e.length;i++)t.hasOwnProperty(e[i])&&r.push(t[e[i]]);r=r.join("|"),e=e.join("|")}else t.hasOwnProperty(e)&&(r=t[e]);indexes.hasOwnProperty(e)||(indexes[e]={}),indexes[e][r]=t}}function matchesCache(t){var r,e=[],i=[];for(var a in indexes){r=!0,e=-1!==a.indexOf("|")?a.split("|"):[a];for(var s=0;s<e.length;s++)if(!t.hasOwnProperty(e[s])){r=!1;break}r&&i.push(a)}return!!i.length&&i}function dynamicSort(t,r){return function(e,i){return e[t]<i[t]?-1*r:e[t]>i[t]?r:0}}function extract(__item,__by,__mode,__param){var data;try{data=eval("__item."+__by)}catch(t){}if(data)switch(__mode){case"substr":return data=data.substr(__param[0],__param[1]),data;case"numrange":return data=Number(data),Array.isArray(__param)?(data=Math.floor(data/__param[0]),data="pre"===__param[2]?__param[1]+data*__param[0]+" - "+__param[1]+(data+1)*__param[0]:data*__param[0]+__param[1]+" - "+(data+1)*__param[0]+__param[1]):(data=Math.floor(data/__param),data=data*__param+" - "+(data+1)*__param),data;case"date":if(!Array.isArray(__param)){if("year"===__param)return data=data.substr(0,4),data;if("month"===__param)return data=data.substr(0,7),data;if("week"===__param)return data=data.substr(0,4)+" week "+moment(data).week(),data}return data=moment(data).unix(),data=Math.floor(data/(60*__param[0]*60*24)),data*=60*__param[0]*60*24,data=moment(1e3*data).format(__param[1])+" - "+moment(1e3*data+1e3*__param[0]*60*60*24).format(__param[1]),data;default:return data}return!1}return array.insert=function(t,r){return void 0===r?array.push(t):array.splice(r,0,t),indexes&&addToCache(t),!0},array.delete=function(t){var r=this,e=array.splice(t,1);if(e.length){if(indexes){var i=matchesCache(e[0]);i&&setTimeout((function(){r.rebuild(i)}),0)}return e[0]}return!1},array.last=function(){if(this.length)return this[this.length-1]},array.findDelete=function(t,r,e){var i=0;void 0===e&&(e=0);for(var a=new OGX.List,s=0;s<this.length;s++)if(this[s][t]===r){if(a.push(this.splice(s,1)[0]),indexes){var n=matchesCache(a.last());n&&this.rebuild(n)}if(i++,e>0&&e===i)return 1===e?a[0]:a;s--}return a},array.findReplace=function(t,r,e,i){var a=0;void 0===i&&(i=0);for(var s=new OGX.List,n=0;n<this.length;n++)if(this[n][t]===r&&(s.push(this[n]),a++,this[n]=e,i>0&&i===a))return 1===i?s[0]:s;return!!s.length&&s},array.findUpdate=function(t,r,e,i,a){var s=0;void 0===i&&(i=!1),void 0===a&&(a=0);for(var n,o=new OGX.List,h=0;h<this.length;h++)if(this[h][t]===r){for(var f in n=!1,e)i?this[h].hasOwnProperty(f)&&(this[h][f]=e[f],n=!0,s++):(this[h][f]=e[f],n=!0,s++);if(n&&(o.push(this[h]),a>0&&a===s))return 1===a?o[0]:o}return!!o.length&&o},array.findIndex=function(t,r){var e=!1;r instanceof RegExp&&(e=!0);for(var i=0;i<this.length;i++)if(e){if(this[i][t].match(r))return{index:i}}else if(this[i][t]===r)return{index:i};return!1},array.find=function(t,r,e){var i=0,a=new OGX.List,s=!1;r instanceof RegExp&&(s=!0),void 0===e&&(e=0);for(var n=0;n<this.length;n++)if(s?this[n][t].match(r)&&(a.push(this[n]),i++):this[n][t]===r&&(a.push(this[n]),i++),e>0&&i===e)return 1===e?a[0]:a;return!!a.length&&a},array.swap=function(t,r){var e=this[t];this[t]=this[r],this[r]=e},array.cache=function(){indexes||(indexes={});var t=[],r=[];if(arguments.length>1){for(var e=0;e<arguments.length;e++)t.push(arguments[e]);t=t.join("|")}else t=arguments[0];indexes.hasOwnProperty(t)||(indexes[t]={});for(var i=0;i<this.length;i++){r=[];for(e=0;e<arguments.length;e++)r.push(this[i][arguments[e]]);r=r.join("|"),indexes[t].hasOwnProperty(r)||(indexes[t][r]=[]),indexes[t][r].push(this[i])}return!0},array.uncache=function(t){if(!indexes)return!1;var r=t;return arguments.length>1&&(r=arguments.join("|")),!!indexes.hasOwnProperty(r)&&(delete indexes[r],!0)},array.deleteProperty=function(t){for(var r=0,e=0;e<this.length;e++)this[e].hasOwnProperty(t)&&(delete this[e][t],r++);return indexes&&this.rebuild(),r},array.rebuild=function(t){for(var r=0;r<t.length;r++)delete indexes[t[r]],this.cache(t[r])},array.read=function(t,r,e){var i,a,s=arguments;if(!indexes)return!1;if(!s.length)return indexes;if("object"==typeof t){for(var n in e=s[1],i=[],a=[],t)i.push(n),a.push(t[n]);i=i.join("|"),a=a.join("|")}else i=t,a=r;return void 0===e&&(e=0),!(!indexes.hasOwnProperty(i)||!indexes[i].hasOwnProperty(a))&&(e?e>1?indexes[i][a].splice(0,e):indexes[i][a][0]:indexes[i][a])},array.clear=function(){indexes=!1,filterCount=0,this.length=0},array.unique=function(t,r,e){void 0===r&&(r=!0),void 0===e?e=[t]:Array.isArray(e)||(e=[e]);for(var i,a=this.get(),s=[],n=new OGX.List,o=0;o<a.length;o++)if(-1===s.indexOf(a[o][t])&&(s.push(a[o][t]),r)){i={};for(var h=0;h<e.length;h++)i[e[h]]=a[o][t];n.push(i)}return r?n:s},array.order=function(t,r){array.sort(dynamicSort(t,r))},array.group=function(t,r,e){if(Array.isArray(t))return array.groupm(t,r,e);for(var i,a={},s=0;s<this.length;s++)(i=extract(this[s],t,r,e))&&(i=i.split(".").pop(),a.hasOwnProperty(i)||(a[i]=new OGX.List),a[i].push(this[s]));return a},array.groupm=function(t,r,e){return function i(a,s){var n=new OGX.List(a),o=r,h=e;void 0!==r&&Array.isArray(r)&&(o=r[s]),void 0!==e&&Array.isArray(e)&&(h=e[s]);var f=n.group(t[s],o,h);if(s+1<=t.length-1)for(var u in f)f[u]=i(f[u],s+1);return f}(this,0)},array.filters={},array.addFilter=function(t,r,e){this.filters.hasOwnProperty(t)||(this.filters[t]=[]);var i={};return i[r]=e,this.filters[t].push(i),filterCount++,!0},array.removeFilter=function(t){return!!this.filters.hasOwnProperty(t)&&(filterCount-=this.filters[t].length,delete this.filters[t],!0)},array.getFilters=function(){return this.filters},array.resetFilters=function(){this.filters={},filterCount=0},array.setFilters=function(t){for(var r in this.resetFilters(),t)for(var e=0;e<t[r].length;e++)for(var i in t[r][e])array.addFilter(r,i,t[r][e][i])},array.setFilteringMode=function(t){filterMode=t},array.get=function(t,r,e,i,a){void 0===r&&(r=!1),void 0===e&&(e=!1),"number"==typeof e&&(i=e,e=!1),void 0===i&&(i=0),void 0===a&&(a=!1);var s=this.getFilters();for(var n in this.resetFilters(),t)for(var o in t[n])this.addFilter(n,o,t[n][o]);var h=this.filter(i,a);if(this.resetFilters(),this.setFilters(s),a)return h;if(1===i)return!!h.length&&h[0];if(r)for(var n in r){h.order(n,r[n]);break}return e?h.group.apply(null,e):h},array.unset=function(t,r){void 0===r&&(r=0);var e=new OGX.List,i=this.get(t,null,null,r,!0);if(i)for(var a=0;a<i.length;a++)e.push(this.delete(i[a]-e.length));return 1===r&&e.length?e[0]:e},array.filter=function(__limit,__as_position){void 0===__limit&&(__limit=0),void 0===__as_position&&(__as_position=!1);for(var ar=[],positions=[],isDate,isString,isArray,isObject,hasFilters=!1,reg=/[0-9]{4}\-[0-9]{2}\-[0-9]{2}( [0-9]{2}\:[0-9]{2}\:[0-9]{2})?/g,isMatch=!1,matches=0,str,o,err,counter,total,i=0;i<this.length;i++)for(var a in isMatch=!0,matches=0,this.filters){err=!1,hasFilters=!0;try{o=null,str="this["+i+"]."+a,o=eval(str)}catch(t){err=!0}if(err||void 0===o)isMatch=!1;else{isDate=!1,isString=!1,isArray=Array.isArray(o),isObject=!isArray&&"object"==typeof o,isArray?"string"==typeof o[0]&&(isString=!0,o[0].match(reg)&&(isDate=!0)):"string"==typeof o&&(isString=!0,o.match(reg)&&(isDate=!0));for(var j=0;j<this.filters[a].length;j++)for(var b in this.filters[a][j]){if(String(this.filters[a][j][b]).length)if("function"===b)isMatch=this.filters[a][j][b](o),isMatch&&matches++;else switch(b){case"eq":isDate?moment(o).format("YYYY-MM-DD")!==moment(this.filters[a][j][b]).format("YYYY-MM-DD")?isMatch=!1:matches++:isString?o.toLowerCase()!==String(this.filters[a][j][b]).toLowerCase()?isMatch=!1:matches++:o!==this.filters[a][j][b]?isMatch=!1:matches++;break;case"eqjson":JSON.stringify(o)!==JSON.stringify(this.filters[a][j][b])?isMatch=!1:matches++;break;case"neq":isDate?moment(o).format("YYYY-MM-DD")===moment(this.filters[a][j][b]).format("YYYY-MM-DD")?isMatch=!1:matches++:isString?o.toLowerCase()===this.filters[a][j][b].toLowerCase()?isMatch=!1:matches++:o===this.filters[a][j][b]?isMatch=!1:matches++;break;case"in":if(isString&&Array.isArray(this.filters[a][j][b])){isMatch=!1;for(var k=0;k<this.filters[a][j][b].length;k++)if(-1!==o.indexOf(this.filters[a][j][b][k])){isMatch=!0;break}isMatch&&matches++}else if(isString)isArray?-1===o.indexOf(this.filters[a][j][b])?isMatch=!1:matches++:-1===o.toLowerCase().indexOf(this.filters[a][j][b].toLowerCase())?isMatch=!1:matches++;else if(isArray)-1===o.indexOf(this.filters[a][j][b])?isMatch=!1:matches++;else if(isObject){for(var p in counter=0,total=0,this.filters[a][j][b])total++,o.hasOwnProperty(p)&&-1!==String(o[p]).toLocaleLowerCase().indexOf(String(this.filters[a][j][b][p]).toLowerCase())&&counter++;isMatch=total===counter,isMatch&&matches++}break;case"nin":if(Array.isArray(this.filters[a][j][b])){for(var k=0;k<this.filters[a][j][b].length;k++)if(-1!==o.indexOf(this.filters[a][j][b][k])){isMatch=!1;break}isMatch&&matches++}else isString?-1!==o.toLowerCase().indexOf(this.filters[a][j][b].toLowerCase())?isMatch=!1:matches++:-1!==o.indexOf(this.filters[a][j][b])?isMatch=!1:matches++;break;case"gt":isDate?moment(o).unix()<=moment(this.filters[a][j][b]).unix()?isMatch=!1:matches++:o<=this.filters[a][j][b]?isMatch=!1:matches++;break;case"gte":isDate?moment(o).unix()<moment(this.filters[a][j][b]).unix()?isMatch=!1:matches++:o<this.filters[a][j][b]?isMatch=!1:matches++;break;case"lt":isDate?moment(o).unix()>=moment(this.filters[a][j][b]).unix()?isMatch=!1:matches++:o>=this.filters[a][j][b]?isMatch=!1:matches++;break;case"lte":isDate?moment(o).unix()>moment(this.filters[a][j][b]).unix()?isMatch=!1:matches++:o>this.filters[a][j][b]?isMatch=!1:matches++;break;case"btw":isDate?moment(this.filters[a][j][b][0]).unix()>moment(o).unix()||moment(this.filters[a][j][b][1]).unix()<moment(o).unix()?isMatch=!1:matches++:this.filters[a][j][b][0]>o||this.filters[a][j][b][1]<o?isMatch=!1:matches++;break;case"substr":o.toLowerCase().substr(this.filters[a][j][b][0],this.filters[a][j][b][1]).toLowerCase()!==this.filters[a][j][b][2].toLowerCase()?isMatch=!1:matches++;break;case"regex":o.toString().match(this.filters[a][j][b])?matches++:isMatch=!1}else matches++;if(!isMatch)break}}if("or"===filteringMode?isMatch&&(ar.push(this[i]),positions.push(i)):matches===filterCount&&(ar.push(this[i]),positions.push(i)),__limit&&ar.length===__limit)return __as_position?positions:OGX.List.apply(null,ar)}return __as_position?positions:hasFilters?OGX.List.apply(null,ar):array},array},OGX.Object=function(){"use strict";var t=new OGX.List,r=new OGX.List;function e(t){for(var r=t.split("."),e=OGX,i=0;i<r.length;i++)void 0!==e[r[i]]&&(e=e[r[i]]);return e}r.cache("_NAME_","id"),this.isRegistered=function(t,r){return typeof("undefined"!==this.register[t][r])},this.getExtend=function(r){var e=t.get({main:{eq:r}},null,1);return!!e&&e.extends},this.getExtends=function(r){var e=[],i=t.get({main:{eq:r}},null,1);if(i){var a;e=e.concat(i.extends);for(var s=0;s<i.extends.length;s++)(a=this.getExtends(i.extends[s]))&&(e=e.concat(a))}var n=[];for(s=0;s<e.length;s++)-1===n.indexOf(e[s])&&n.push(e[s]);return n},this.register=function(){var r=Array.prototype.slice.call(arguments),e=r.shift();t.push({main:e,extends:r})},this.create=function(t,i){void 0===i&&(i={});var a=this.getExtends(t),s=!1;if(a.length){var n=e(t);n.prototype=Object.create({});var o,h=[];h.push(n.prototype);for(var f=0;f<a.length;f++)void 0!==(o=e(a[f]))&&h.push(o.prototype);Object.assign.apply(null,h),n.prototype.constructor=n,s=new n(i)}else OGX.hasOwnProperty(t)&&(s=new OGX[t](i));return!!s&&(r.insert(s),s)},this.cache=function(t){if(void 0===t)return r;r.insert(t)},this.uncache=function(t){r.findDelete("id",t.id)},this.get=function(t,e,i){return r.get(t,e,i)},this.destroy=function(t,e){void 0===e&&(e=!0),t.blur(),"function"==typeof t.destroy&&t.destroy(),"function"==typeof t.__destroy&&t.__destroy(),e&&t.clear(),t.floating&&t.el.remove(),r.findDelete("id",t.id,1)}},"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(t,r){"use strict";if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),i=1;i<arguments.length;i++){var a=arguments[i];if(null!=a)for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},writable:!0,configurable:!0});if(void 0===OGX)var OGX={};function require(){OGX.Object.register.apply(null,arguments)}function construct(__that,__cls){var ext=OGX.Object.getExtend(__cls);for(var a in ext)eval("OGX."+ext[a]).call(__that,arguments.callee.caller.arguments[0])}OGX.Object=new OGX.Object;if(OGX.OML=function(){"use strict";var thread_object={},local_object={};function createRecursive(e,t,n,i,o){var r=[];(new Date).getTime();!function e(t,s){if(Array.isArray(t))for(var a=0;a<t.length;a++)e(t[a],s);else{var d,l,u,c,f,p,h,O,g,m,v,w,G,X,_;if(!o)for(O in t)-1!==O.indexOf(":Point")&&(d=O.split(":")[0],/^(#|\.)\S+$/gi.test(d)?(t[O].el=d,t[O].mode=0):(t[O].el=null,t[O].mode=1,t[O].id=d),t[O].parent=s,t[O].data=n,t[O].route_data=i,h=OGX.Object.create("Point",t[O]),s.add(h),h.focus(),e(h.oml(),h),delete t[O]);for(O in t)if((G=/((?!:)[\S ]+):(\S+)/gi.exec(O))&&(d=G[1],void 0!==(l=u=G[2])&&-1===["Route","OML"].indexOf(l))){switch(u.indexOf(".")>0&&(u=u.substr(0,u.indexOf(".")-1)),p=t[O],f=!0,c=!0,X=!1,u){case"Fork":if("scope"===d){if(!(w=OGX.Scope.match(t[O])))return!1;e(w.node,s)}else(w=getForkChild(t[O]))&&e(w,g);c=!1,f=!1;break;case"Html":p.el=d,p.html=t[O].html,(c=isRequired(p))||(p.template=!1);break;case"Template":p.template=l.split(".")[1],p.el=d,l="Html",c=isRequired(p);break;case"Ghost":p.el=d;break;case"Controller":p.id=d;break;case"Uxi":c=!1,f=!1,X=p.uxi,_=p.html;break;default:-1!==[".","#"].indexOf(d.substr(0,1))?p.el=d:(p.id=d,p.el=s.el[0],p.parent=s)}f&&(p=runOseScripts(p,i)),g=!1,m=!1,c?(o&&(v=o.find("id",p.id.replace(/^#/gi,""),1))&&(m=!0),m?(v.wake(p.el),h=v):h=OGX.Object.create(l,p),s.add(h),g=h):X?(X.blur(),$(d).html(_),X.el=$(d),s.add(X),setTimeout((function(){s.blured||X.focus()}),0)):(g=s,"Html"===l&&OGX.HtmlRender(p)),g&&t[O].hasOwnProperty("node:OML")&&!X&&!m&&("string"==typeof t[O]["node:OML"]&&(0===t[O]["node:OML"].indexOf("{{")?t[O]["node:OML"]=OGX.OSE.exec(t[O]["node:OML"]):t[O]["node:OML"]=OGX.Data.clone(OGX.Cache.get("oml",t[O]["node:OML"]))),e(t[O]["node:OML"],g)),c&&"function"==typeof h.construct&&(m||h.construct.apply(h,[n,i])),h&&(c||m)&&(m&&(h.parent=s),s.blured||h.floating||h.focus()),void 0!==h&&h&&(r=r.concat(convertBinds(h,t[O])))}}}(t,e),r.length&&execBinds(r)}function execBinds(e){for(var t=0;t<e.length;t++)doBind(e[t])}function convertBinds(e,t){var n,i=[];for(var o in t)if(n=/^(\S*)\:Bind$/g.exec(o))if(Array.isArray(t[o]))for(var r=0;r<t[o].length;r++)t[o][r].property=n[1],bpush({uxi:e,config:t[o][r]});else t[o].property=n[1],i.push({uxi:e,config:t[o]});return i}function doBind(e){setTimeout((function(){runOseScripts(e.config),e.uxi.bind(e.config)}),0)}function isRequired(e){return e.hasOwnProperty("instance")&&e.instance||e.hasOwnProperty("scroll")&&e.scroll}function getForkChild(__prop,__node){if(0===__prop.indexOf("#")&&(__prop=eval(__prop.substr(1))),__prop)for(var val in __node)if(-1!==__prop.indexOf(val))return __node[val];return!1}function runOseScripts(e,t){var n;for(var i in e)-1!==i.indexOf(":OSE")&&(e[n=i.split(":").shift()]=OGX.OSE.exec(e[i],{},thread_object,t,local_object),delete e[i],runOseScripts(e[n]));return e}this.rendertime=!0,this.get=function(e){return OGX.Cache.get("oml",e)},this.make=function(e,t,n){var i={};return i[e+":"+t]=n,i},this.parse=function(e){return"string"==typeof e&&("{"!==e.substr(0,1)&&(e="{"+e+"}"),e=JSON.parse(e)),e},this.replaceNodeName=function(e,t,n){function i(e,t,n){var i={};for(var o in e)i[o.replace(t,n)]=e[o];return i}void 0===n&&(n="default"),Array.isArray(n)||(n=[n],t=[t]);for(var o=0;o<n.length;o++)e=i(e,n[o],t[o]);return e},this.replaceDataRecursive=function(e,t,n){function i(e){var s,a;for(var d in e)if(-1!==d.indexOf(":OSE"))s=d.split(":"),(a=r(e[d],t,n))&&(e[s[0]]=a,delete e[d],i(e[s[0]]));else if("node:OML"===d)if("string"==typeof e[d]&&0===e[d].indexOf("{{"))e[d]=OGX.OSE.exec(e[d]),o(e[d]);else if(Array.isArray(e[d]))for(var l=0;l<e[d].length;l++)o(e[d][l]);else o(e[d])}function o(e){var o;for(var s in e)-1!==s.indexOf("{{")&&(o=r(s,t,n))&&(e[o]=e[s],delete e[s],s=o),i(e[s])}function r(e,t,n){var i,o,r=/{{([\S ]+)}}/gi;for(thread_object[n]=t;i=r.exec(e);){if(o=OGX.OSE.exec(i[0],{},thread_object),-1!==["string","number"].indexOf(typeof o))e=e.replace(i[0],o);else if(-1!==["boolean","object"].indexOf(typeof o))return o;r.lastIndex=0}return e}o(e)},this.render=function(e,t,n,i,o){"string"==typeof t&&(t=OGX.OSE.exec(t,{},thread_object,i)),"string"==typeof n&&0===n.indexOf("{{")&&(n=OGX.OSE.exec(n,{},thread_object,i)),void 0===o&&(o=!1),createRecursive(e,t,n,i,o)}},OGX.OML=new OGX.OML,void 0===OGX)var OGX={};OGX.Stages={},OGX.Views={},OGX.Controllers={},require("Core","Uxi","Touch"),OGX.Core=function(){construct(this,"Core");var e,t=this,n={jwt:!0,scope:["public"],routing:{routes:{},options:{history:!0,bookmark:!0},errors:{403:!1,404:!1}},stages:{blured:!0,use:!1,closeable:!1,anim:!1},overlays:{delay:200,anim:"fade"},popups:{blured:!1,sleeping:!1},theater:!1,observe:!1,auto_exit:!1,chromeos:!1,rendertime:!1},i=!1,o=!1,r=!1,s=/(iPhone|iPod|iPad)/i.test(navigator.userAgent),a=matchMedia("(prefers-color-scheme: dark)").matches;function d(e){app.remove(OGX.Popup.NAME,e.id),e.cb&&e.cb(e.params)}function l(e){e.matches}function u(){if(i)for(var e=i.gather(""),t=0;t<e.length;t++)e[t]._NAME_!==OGX.Controller.NAME&&(-1===[OGX.Popup.NAME,OGX.Window.NAME].indexOf(e[t]._NAME_)?e[t].sleeping||(e[t].resize(),e[t].resizeNodes()):-1!==OGX.Popup.NAME.indexOf(e[t]._NAME_)?e[t].sleeping||(e[t].resize(),e[t].centered&&e[t].center(),e[t].resizeNodes()):-1!==OGX.Window.NAME.indexOf(e[t]._NAME_)&&(e[t].sleeping||(e[t].resize(),e[t].resizeNodes())))}function c(){e.routing&&(t.router=new OGX.Router(e.routing),t.router.start()),function(){var n,o,r,s,a,d,l,u=!1;for(var c in e.vapps)o=(n=c.split(":"))[0],r=n[1],(a=OGX.Data.merge(e.vapps[c],e.stages,!1,!0)).id=o,!0===a.use&&(u=o,s=o+"/"+a.home),d=t.addStage(r,a),!0===a.use&&(i=d);u&&(l=e.bookmark&&-1!==window.location.href.indexOf("#")?window.location.href.split("#").pop():s,setTimeout((function(){t.goto(l)}),0),setTimeout((function(){$(document).trigger(OGX.App.READY)}),100))}(),e.theater&&function(){for(var n=app.gather(OGX.Stage.NAME),i=[],o=0;o<n.length;o++)n[o].theater&&i.push(n[o]);e.theater.stages=i,e.theater.el="body",t.theater=t.create("Theater",e.theater)}()}this._NAME_=OGX.App.NAME,this.router=!1,this.isWebView=function(){return r},this.isTouch=function(){return this.touch.touchable()},this.getURL=function(){return i.url},this.isDarkMode=function(){return a},this.toggleTheme=function(){var e="(prefers-color-scheme: ";a?($("head").children('link[data="dark"]').attr("media",e+"light)"),$("head").children('link[data="light"]').attr("media",e+"dark)")):($("head").children('link[data="dark"]').attr("media",e+"dark)"),$("head").children('link[data="light"]').attr("media",e+"light)")),a=!a},this.addStage=function(t,n){OGX.Data.merge(n,e.stages),n.el="body";var i=OGX.Object.create(t,n);return this.add(i),n.hasOwnProperty("node:OML")&&OGX.OML.render(i,n["node:OML"]),setTimeout((function(){i.construct(n),n.use?(i.el.css("display","block"),i.focus(),o=i):i.sleep()}),0),i},this.removeStage=function(e){var t=this.cfind("Stage",e);t&&(t.destroy(),t.kill(),this.find("Stage",e,"remove"))},this.useStage=function(e){if(!i||i.id!==e){var t=this.cfind("Stage",e);return!!t&&(i=t,!0)}},this.getStage=function(e){if(void 0===e)return i||o;var t=this.find("Stage",e);return t||!1},this.showStage=function(e,n){if(!i||i.id!==e){var r=this.cfind(OGX.Stage.NAME,e);if(r){if(void 0===n&&(n=r.anim?r.anim:!!o.anim&&o.anim),n){var s=$(window).height();switch(n){case OGX.Stage.SWAP:o&&(r.wake(),o.el.on("transitionend",(function(){o.el.off("transitionend"),o.el.css("top",-s+"px"),r.el.css("top","0px"),r.el.on("transitionend",(function(){r.el.off("transitionend"),r.el.css("transform","scale(1)"),o.el.removeClass("ogx_stage_anim"),o.el.css({top:"0px",transform:"scale(1)"}),o.sleep(),t.el.trigger(OGX.Stage.SWAP,{old:o,new:r}),o=r}))})),r.el.addClass("ogx_stage_anim"),o.el.addClass("ogx_stage_anim"),o.el.css("transform","scale(0.9)")),r.el.css("top",s+"px"),r.el.css("display","block"),r.el.css("transform","scale(0.9)"),r.el.addClass("ogx_stage_anim");break;case OGX.Stage.FLIP:o&&(r.wake(),o.el.on("transitionend",(function(){o.el.off("transitionend"),o.el.removeClass("ogx_stage_anim"),o.el.css("transform","scaleX(1)"),o.sleep(),r.el.css("transform","scaleX(1)"),t.el.trigger(OGX.Stage.SWAP,{old:o,new:r}),o=r})),r.el.addClass("ogx_stage_anim"),r.el.css("transform","scaleX(0)"),o.el.addClass("ogx_stage_anim"),o.el.css("transform","scaleX(0)")),r.el.css("display","block")}}else o&&o.id!==r.id&&o.sleep(),r.sleeping&&r.wake(),r.el.css("display","block"),o=r;t.useStage(e)}}},this.getWindow=function(e){return this.cfind(OGX.Window.NAME,e)},this.getWindows=function(){return this.gather(OGX.Window.NAME)},this.windowExists=function(e){return!1!==this.cfind(OGX.Window.NAME,e)},this.addWindow=function(t,n){if(t=OGX.Data.merge(t,e.windows),void 0===n){if(!o)return!1;n=o}var i;return!!n&&(t.el=n.el,t.parent=n,t.hasOwnProperty("node:OML")?(i=OGX.Object.create(OGX.Window.NAME,t),n.add(i),i.focus(),OGX.OML.render(i,t["node:OML"])):i=n.create(OGX.Window.NAME,t),i)},this.windowOpen=function(e){return this.cfind(OGX.Window.NAME,e).status===OGX.Window.OPEN},this.showWindow=function(t,n,i,o){!0===n&&(n=e.anim);var r=this.cfind(OGX.Window.NAME,t);return!!r&&(r.sleeping&&attachWindow(t),r.blured&&r.focus(),r.show(n,i,o),!0)},this.hideWindow=function(t,n,i,o){!0===n&&(n=e.anim),"string"!=typeof t&&(t=this.findWindow(t).id),this.cfind(OGX.Window.NAME,t).hide(n,i,o)},this.swapWindows=function(e,t){var n,i,o,r;return!(!this.windowExists(e)||!this.windowExists(t))&&(n=this.getWindow(e),i=this.getWindow(t),o=n.el.css("z-index"),r=i.el.css("z-index"),n.el.css("z-index",r),i.el.css("z-index",o),!0)},this.sleepWindow=function(e){this.cfind(OGX.Window.NAME,e).sleep()},this.blurWindow=function(e){this.cfind(OGX.Window.NAME,e).blur()},this.focusWindow=function(e){this.cfind(OGX.Window.NAME,e).focus()},this.removeWindow=function(e){return this.find(OGX.Window.NAME,e,"remove")},this.removeWindows=function(e){for(var t in e)this.removeWindow(t);return!0},this.removeAllWindows=function(e){void 0===e&&(e=[]);for(var t=this.gather(OGX.Window.NAME),n=0;n<t.length;n++)-1!==e.indexOf(t[n].id)&&this.removeWindow(t[n].id)},this.findWindow=function(e){var t=e.el.parents(".ogx_window");if(t.length){var n=$(t[0]).data("ogx-id");return this.cfind(OGX.Window.NAME,n)}return!1},this.addPopup=function(t,n){var o;return void 0!==n&&n||(n=i),t.el=n.el[0],t.parent=n,t.chromeos=e.chromeos,t.hasOwnProperty("node:OML")?(o=OGX.Object.create(OGX.Popup.NAME,t),n.add(o),o.focus(),OGX.OML.render(o,t["node:OML"])):o=n.create(OGX.Popup.NAME,t),setTimeout((function(){o.show()}),0),o},this.removePopup=function(e,t,n,i,r){if(void 0===r&&(r=o),void 0===n&&(n=!1),void 0===i&&(i=!1),void 0===t&&(t=!0),r){var s=r.find(OGX.Popup.NAME,e);if(s)return s.hide(t,d,{id:e,cb:n,params:i}),!0}return!1},this.findPopup=function(e){var t;t=e instanceof HTMLElement?e:e.el;var n=$(t).parents(".ogx_popup");if(n.length){var i=$(n[0]).data("ogx-id");return this.cfind(OGX.Popup.NAME,i)}return!1},this.getVisiblePopups=function(){for(var e=this.gather(OGX.Popup.NAME),t=[],n=0;n<e.length;n++)"visible"===e[n].el.css("visibility")&&t.push(e[n]);return t},this.popupExists=function(e){return!1!==this.cfind(OGX.Popup.NAME,e)},this.groupPopups=function(e,n){var i=e.id,o=n.id,r=e.nodes.get({_NAME_:{eq:"Container"}},null,1),s=n.nodes.get({_NAME_:{eq:"Container"}},null,1);if(r&&s){var a=r.nodes.get({_NAME_:{eq:"Carousel"}},null,1),d=r.nodes.get({_NAME_:{eq:"Tabs"}},null,1).set(),l=s.nodes.get({_NAME_:{eq:"Carousel"}},null,1),u=(h=s.nodes.get({_NAME_:{eq:"Tabs"}},null,1)).index(),c=a.panels().slice();e.nodes=new OGX.List;for(var f=0;f<c.length;f++)h.addTab(d[f]),A=c[f].instance?{"default:Uxi":{uxi:c[f].instance,html:c[f].instance.el.detach()}}:{"default:Html":{html:c[f].html}},l.addNode(A,null,!1);u+=d.length,l.showPanel(u,!1),h.selectIndex(u),t.removePopup(e.id,!1,!1,!1,e.parent)}else if(r||s){var p,h,O;r?(p=r.nodes.get({_NAME_:{eq:"Carousel"}},null,1),h=r.nodes.get({_NAME_:{eq:"Tabs"}},null,1),E=n):(p=s.nodes.get({_NAME_:{eq:"Carousel"}},null,1),h=s.nodes.get({_NAME_:{eq:"Tabs"}},null,1),E=e),E.nodes.length?((O=E.nodes.slice()[0]).blur(),E.nodes=new OGX.List,A={"default:Uxi":{uxi:O,html:O.el.detach()}}):A={"default:Html":{html:E.el.find(".ogx_popup_body:first").html()}};var g=E.title();t.removePopup(E.id,!1,!1,!1,E.parent),p.addNode(A,null,!0),h.addTab(g),h.selectIndex(h.set().length-1)}else{var m,v=e.nodes.slice();v.length?(v=v[0],e.nodes=new OGX.List):v=!1,m=e.el.find(".ogx_popup_body:first").children().detach();var w,G,X,_=n.nodes.slice();_.length?(_=_[0],n.nodes=new OGX.List):_=!1,w=n.el.find(".ogx_popup_body:first").children().detach(),G=v?{"default:Uxi":{uxi:v,html:m}}:{"default:Html":{html:m}},X=_?{"default:Uxi":{uxi:_,html:w}}:{"default:Html":{html:w}};var x=n.icons()||e.icons();"boolean"==typeof x&&(x=!1),!(x&&Array.isArray(x)&&x.length)&&(x=!1);var M=this.gather("Popup");M=M.get({id:{in:e.group}});var A={id:e.group+"_"+M.length,width:e.el.width(),height:e.el.height(),title:e.group,group:e.group,drag:!0,resize:!0,anim:!1,icons:x,"node:OML":[{"default:Container":{index:1,tabs:{list:[n.title(),e.title()]},"node:OML":[X,G]}}]},b=e.parent;this.removePopup(e.id,!1,!1,!1,b),this.removePopup(n.id,!1,!1,!1,b);var E=app.addPopup(A,e.parent);$(document).trigger(OGX.Popup.GROUP,{popups:[i,o],popup:E})}},this.ungroupPopup=function(e,t,n){var i=e.icons(),o=e.nodes.get({_NAME_:{eq:"Container"}},null,1).nodes.get({_NAME_:{eq:"Carousel"}},null,1),r=o.getPanel(t),s={};if(r.instance){var a=o.nodes.get({id:{eq:r.instance.id},_NAME_:{eq:r.instance._NAME_}},null,1);a&&(s["default:Uxi"]={uxi:a,html:r.instance.el.children().detach()})}else s["default:Html"]={html:r.html};o.removePanel(t);var d="popup_"+(new Date).getTime();this.addPopup({id:d,group:e.group,title:n,resize:!0,drag:!0,icons:i,"node:OML":[s]}),$(document).trigger(OGX.Popup.UNGROUP,{from_popup:e.id,from_index:t,to_popup:d})},this.addOverlay=function(e,t){return void 0===t&&(t=o),!!t&&(t.addOverlay(e),!0)},this.removeOverlay=function(e,t){void 0===t&&(t=o),t&&t.removeOverlay(e)},this.theater=!1,this.getJSON=function(e){return OGX.Cache.get("json",e)},this.getOML=function(e){return OGX.Cache.get("oml",e)},this.goto=function(e,t){return void 0===t&&(t={}),t=OGX.Data.merge(t,{history:!0,data:null},!1),this.router.goto(e,t)},this.getDefaults=function(t){return e[t]},OGX.Net=new OGX.Net({ios:s}),OGX.Net.load("app.json",(function(i){e=i,OGX.Scope=new OGX.Scope(e.jwt),r=void 0!==window.ontouchstart,s&&$("body").addClass("ios"),e=OGX.Data.weld(e,n,!1,!1),t.el=$(document),OGX.OML.rendertime=e.rendertime,OGX.Net.preload(e.preload,c),!0?window.addEventListener("resize",u):window.removeEventListener("resize",u),function(e){if(e){var t=window.matchMedia("(prefers-color-scheme: dark)");t.addListener(l)}else t.removeListener(l)}(!0)}))},OGX.App=function(e){"use strict";return OGX.Object.create("Core",e)},OGX.App.NAME="App",OGX.App.LOADING="AppLoading",OGX.App.READY="AppReady";if(OGX.Audio=function(){"use strict";var e=!1;this.get=function(e){var t;return!!(t=OGX.Cache.get("snd",e))&&t},this.play=function(t,i){void 0===i&&(i=1);var n=this.get(t);return!!n&&((n=n.cloneNode()).volume=i,e?n.play().catch((function(){})):setTimeout((function(){n.play().catch((function(){}))}),0),!0)},$(document).on("touchstart mousedown",(function t(){e=!0,$(document).off("touchstart mousedown",t)}))},OGX.Audio=new OGX.Audio,OGX.Bind=function(){"use strict";var e=this,t={object:null,event:null,mode:"eq",action:"filter",property:null,remote_property:null,min_length:0},i={};function n(t,i){var n,o,r,s,l="string"==typeof i.object;function d(t,n){if("object"==typeof n){if(function(t,i){for(var n in t.__p)e.unbindFilter(n);t.__p={}}(i),i.remote_property&&Array.isArray(i.remote_property)){var r=0;for(var s in n)i.__p[i.remote_property[r]]=!0,o(i.remote_property[r],i.mode,n[s]),r++;return}if(i.remote_property)o(i.remote_property,i.mode,n),a(i,n);else{if(Array.isArray(i.property)){r=0;for(var s in n)i.__p[i.property[r]]=!0,o(i.property[r],i.mode,n[s]),r++;return}o(i.property,i.mode,n),a(i,n)}}else i.remote_property?o(i.remote_property,i.mode,n):o(i.property,i.mode,n)}function c(e){if(i.min_length&&e.target.value.length<i.min_length&&e.target.value.length)return!1;o(i.property,i.mode,e.target.value)}switch(l?(t&&(i.object={el:$(i.object)},n=i.event),r=c):(t&&(n=OGX[i.object._NAME_].BIND),r=d),i.action){case"render":o=e.bindRender;break;case"filter":o=e.bindFilter}t?(i.object.el.on(n,r),l?c({target:{value:i.object.el.val()}}):(s=i.object.bindValue?i.object.bindValue():i.object.val(),Array.isArray(s)&&s.hasOwnProperty("insert")&&(s=JSON.parse(JSON.stringify(s))),d(0,s))):i.object.el.off(n,r)}function a(e,t){for(var i in t)e.__p[i]=!0}this.bind=function(e){return OGX.Data.merge(e,t),!!e.property&&(e.object&&"string"==typeof e.object&&(e.event="input change",e.action="filter"),e.__p={},i.hasOwnProperty(e.property)||(i[e.property]=[]),i[e.property].push(e),n(!0,e),!0)},this.unbind=function(e){for(var t=0;t<i[e].length;t++)n(!1,i[e][t]);return delete i[e],!0},this.clearBinds=function(){for(var e in i){for(var t=0;t<i[e].length;t++)n(!1,i[e][t]);delete i[e]}}},OGX.Bind.prototype.unbindFilter=function(e){},OGX.Bind.prototype.bindFilter=function(e,t,i){},OGX.Bind.prototype.bindRender=function(e,t){},OGX.Bind.prototype.bindValue=null,OGX.Cache=function(){"use strict";var e=new OGX.List;e.cache("ext","id"),this.get=function(t,i){var n=e.read({ext:t,id:i},null,1);return!!n&&n.data},this.set=function(t){e=new OGX.List(t)},this.add=function(t){if(Array.isArray(t))for(var i=0;i<t.length;i++)e.insert(t[i]);else e.insert(t)},this.remove=function(t,i){return e.unset({ext:{eq:t},id:{eq:i}},1)},"undefined"!=typeof __array&&this.set(__array)},OGX.Cache=new OGX.Cache,require("Calendar","Uxi","Bind","Touch"),OGX.Calendar=function(e){construct(this,"Calendar");var t,i,n,a,o=this,r=e,s={display_date:moment(),date:!1,format:"YYYY-MM-DD",layouts:[{layout:"MONTH_DAYS",engine:"DAY_NUMBER",config:!1}],layout:0,selectable:!0,swipable:!0,chromeos:!1},l=[],d={x:1,y:1},c=!1;function u(e){e?i.on("click",".ogx_calendar_layout_item",h):i.off("click",".ogx_calendar_layout_item",h)}function h(e){var t=$(this);t.hasClass("ogx_calendar_selected_item")?(t.removeClass("ogx_calendar_selected_item"),o.el.trigger(OGX.Calendar.UNSELECT,""),r.date=!1):(t.parent().find(".ogx_calendar_selected_item:first").removeClass("ogx_calendar_selected_item"),t.addClass("ogx_calendar_selected_item"),r.date=moment(t.data("ogx-date")),r.display_date=r.date.clone(),o.el.trigger(OGX.Calendar.SELECT,r.date),p()),setTimeout(_,0)}function _(){for(var e=t.getCells(),i=0;i<e.length;i++)0==e[i].offset.x&&0==e[i].offset.y||v(e[i].abs,e[i].rel,e[i].offset,$(e[i].element).children(0)[0])}function f(e){e?(i.on(OGX.GridSwiper.SWIPE_START,(function(){u(!1)})),i.on(OGX.GridSwiper.SWIPE_END,(function(){u(!0)})),i.on(OGX.GridSwiper.SWIPE_LEFT,(function(e,t){var i=l[a].value();g(i.value,i.unit),m(l[a].labels(r.display_date))})),i.on(OGX.GridSwiper.SWIPE_RIGHT,(function(e,t){var i=l[a].value();g(-1*i.value,i.unit),m(l[a].labels(r.display_date))})),i.on(OGX.GridSwiper.SWIPE_UP,(function(e,t){a=t.cell.y-1,p(),m(l[a].labels(r.display_date))})),i.on(OGX.GridSwiper.SWIPE_DOWN,(function(e,t){a=t.cell.y-1,p(),m(l[a].labels(r.display_date))}))):(i.off(OGX.GridSwiper.SWIPE_LEFT),i.off(OGX.GridSwiper.SWIPE_RIGHT),i.off(OGX.GridSwiper.SWIPE_UP),i.off(OGX.GridSwiper.SWIPE_DOWN),i.off(OGX.GridSwiper.SWIPE_START),i.off(OGX.GridSwiper.SWIPE_END))}function g(e,t){r.display_date.add(e,t),p()}function p(){var e=l[a].format(r.display_date),t='<span class="ogx_calendar_display_date">'+r.display_date.format(e)+"</span>";r.date&&(t+='<span class="ogx_calendar_selected_date">'+r.date.format(r.format)+"</span>"),i.children(".ogx_calendar_head:first").children(".ogx_calendar_head_date:first").html(t)}function m(e){i.children(".ogx_calendar_head:first").children(".ogx_calendar_head_labels:first").html(e)}function v(e,t,i,n){if(t.y-1>=0&&t.y-1<r.layouts.length){var o=$(n),s=l[a].value(),d=r.display_date.clone().add(i.x*s.value,s.unit),c=l[t.y-1].html(d,OGX.CalendarEngine[r.layouts[t.y-1].engine],r.layouts[t.y-1].config,r.date);o.html(c)}}function y(e,t){return OGX.CalendarLayout[e].prototype=Object.create(OGX.CalendarLayout.BASE_LAYOUT.prototype),OGX.CalendarLayout[e].prototype.constructor=OGX.CalendarLayout[e],new OGX.CalendarLayout[e](t)}this._NAME_=OGX.Calendar.NAME,this.el=null,this.enable=function(){c||(c=!0,r.selectable&&u(!0),f(!0))},this.disable=function(){c&&(c=!1,r.selectable&&u(!1),f(!1))},this.val=function(e){return void 0!==e&&(r.date=e,moment.isMoment(r.date)||(r.date=moment(r.date)),r.display_date=r.date.clone(),p(),setTimeout(_,0)),r.date?r.date:""},this.display=function(e){return void 0!==e?(r.display_date=e,moment.isMoment(r.display_date)||(r.display_date=moment(r.display_date)),p(),setTimeout(_,0),!0):r.display_date},this.axis=function(e,t){r.axis.x=e,r.axis.y=t},this.getLayout=function(){return a},function(){for(var e in s)r.hasOwnProperty(e)||(r[e]=s[e]);o.el=i=$(r.el),i.addClass("ogx_calendar"),r.date&&(moment.isMoment(r.date)||(r.date=moment(r.date)),r.display_date=r.date.clone()),r.display_date?moment.isMoment(r.display_date)||(r.display_date=moment(r.display_date)):r.display_date=moment(),a=r.layout,d.y=a+1}(),i.html('<div class="ogx_calendar_head"><div class="ogx_calendar_head_date"></div><div class="ogx_calendar_head_labels"></div></div><div class="ogx_calendar_body"></div>'),function(){n=[[!1,!1,!1]];for(var e=0;e<r.layouts.length;e++)n.push([v,v,v]);n.push([!1,!1,!1])}(),function(){for(var e=0;e<r.layouts.length;e++)l.push(y(r.layouts[e].layout,{}))}(),t=o.create("GridSwiper",{el:r.el+" .ogx_calendar_body:first",loop:!0,map:n,start:{x:1,y:1},chromeos:r.chromeos}),p(),m(l[a].labels(r.display_date)),o.enable()},OGX.Calendar.NAME="Calendar",OGX.Calendar.SELECT="CalendarSelect",OGX.Calendar.UNSELECT="CalendarUnselect",OGX.Calendar.BIND=OGX.Calendar.SELECT+" "+OGX.Calendar.UNSELECT,OGX.CalendarLayout={},OGX.CalendarLayout.BASE_LAYOUT=function(){"use strict";this.labels=function(e){return""},this.html=function(e,t,i,n){return""},this.value=function(){return{value:1,unit:"months"}},this.format=function(){return"YYYY-MM"}},OGX.CalendarLayout.MONTH_DAYS=function(){"use strict";OGX.CalendarLayout.BASE_LAYOUT.call(this),this.labels=function(){for(var e="",t=function(){for(var e=new Date(Date.UTC(2017,0,2)),t=[],i=0;i<7;i++)t.push(e.toLocaleDateString(navigator.language,{weekday:"short"})),e.setDate(e.getDate()+1);return t}(),i=0;i<t.length;i++)e+='<span class="ogx_calendar_layout_month_days_label">'+t[i]+"</span>";return e},this.html=function(e,t,i,n){var a,o=e.format("MM"),r=moment(e.format("YYYY-MM-")+"01").day(),s=moment(e.format("YYYY-MM-")+"01").subtract(r,"days"),l="";n&&(l=n.format("YYYY-MM-DD"));for(var d,c="",u=0;u<42;u++)d="",a=s.format("YYYY-MM-DD"),s.format("MM")!==o&&(d+="ogx_calendar_layout_month_days_offset "),a===moment().format("YYYY-MM-DD")&&(d+="ogx_calendar_layout_month_days_today "),n&&l===a&&(d+="ogx_calendar_selected_item "),c+='<div class="ogx_calendar_layout_item ogx_calendar_layout_month_days '+d+'" data-ogx-date="'+a+'">'+t(a,i)+"</div>",s.add(1,"days");return c},this.value=function(){return{value:1,unit:"months"}},this.format=function(){return"YYYY-MM"}},OGX.CalendarLayout.CENTURY_DECADES=function(){"use strict";OGX.CalendarLayout.BASE_LAYOUT.call(this),this.labels=function(e){return'<span class="ogx_calendar_layout_century_decades_label">'+100*Math.floor(Number(e.format("YYYY"))/100)+"'s</span>"},this.html=function(e,t,i,n){var a,o,r=moment(),s=100*Math.floor(Number(r.format("YYYY"))/100),l=10*Math.floor(Number(r.format("YYYY").substr(2))/10),d=100*Math.floor(Number(e.format("YYYY"))/100),c=0,u=0;n&&(c=100*Math.floor(Number(n.format("YYYY"))/100),u=10*Math.floor(Number(n.format("YYYY").substr(2))/10));for(var h="",_=0;_<10;_++)o="",s+l===d+(a=10*_)&&(o="ogx_calendar_layout_century_decades_current "),c+u===d+a&&(o+="ogx_calendar_selected_item "),h+='<div class="ogx_calendar_layout_item ogx_calendar_layout_century_decades '+o+'" data-ogx-date="'+(d+a)+'-01-01">'+t(d+a,i)+"</div>";return h},this.value=function(){return{value:100,unit:"years"}},this.format=function(){return"YYYY"}},OGX.CalendarLayout.CENTURY_YEARS=function(){"use strict";OGX.CalendarLayout.BASE_LAYOUT.call(this),this.labels=function(e){return'<span class="ogx_calendar_layout_century_decades_label">'+100*Math.floor(Number(e.format("YYYY"))/100)+"'s</span>"},this.html=function(e,t,i,n){var a,o=moment(),r=100*Math.floor(Number(o.format("YYYY"))/100),s=Number(o.format("YYYY").substr(2)),l=100*Math.floor(Number(e.format("YYYY"))/100),d=0,c=0;n&&(d=100*Math.floor(Number(n.format("YYYY"))/100),c=Math.floor(Number(n.format("YYYY").substr(2))));for(var u="",h=0;h<100;h++)a="",l+h===r+s&&(a+="ogx_calendar_layout_century_years_current "),l+h===d+c&&(a+="ogx_calendar_selected_item"),u+='<div class="ogx_calendar_layout_item ogx_calendar_layout_century_years '+a+'" data-ogx-date="'+(l+h)+'-01-01">'+t(l+h+"-01-01",i)+"</div>";return u},this.value=function(){return{value:100,unit:"years"}},this.format=function(){return"Y"}},OGX.CalendarLayout.DECADE_YEARS=function(){"use strict";OGX.CalendarLayout.BASE_LAYOUT.call(this),this.labels=function(e){return'<span class="ogx_calendar_layout_century_years_label">'+10*Math.floor(Number(e.format("YYYY"))/10)+"'s</span>"},this.html=function(e,t,i,n){var a,o=10*Math.floor(Number(e.format("YYYY"))/10),r="",s=Number(moment().format("YYYY")),l="";n&&(l=Number(n.format("YYYY")));for(var d=0;d<10;d++)a="",o+d===s&&(a+="ogx_calendar_layout_decade_years_current "),o+d===l&&(a+="ogx_calendar_selected_item "),r+='<div class="ogx_calendar_layout_item ogx_calendar_layout_decade_years '+a+'" data-ogx-date="'+(o+d)+'-01-01">'+t(o+d+"-01-01",i)+"</div>";return r},this.value=function(){return{value:10,unit:"years"}},this.format=function(){return"Y"}},OGX.CalendarLayout.DECADE_MONTHS=function(){"use strict";OGX.CalendarLayout.BASE_LAYOUT.call(this),this.labels=function(e){for(var t=10*Math.floor(Number(e.format("YYYY"))/10),i=Number(String(t).substr(2,2)),n="",a=0;a<10;a++)n+='<span class="ogx_calendar_layout_decade_months_label">\''+i+"</span>",i++;return n},this.html=function(e,t,i,n){var a,o,r,s,l=10*Math.floor(Number(e.format("YYYY"))/10),d="",c=moment().format("YYYY-MM");n&&(a=n.format("YYYY-MM"));for(var u=0;u<12;u++){s=u+1;for(var h=0;h<10;h++)o="",(r=l+h+"-"+(s<10?"0"+s:s))===c&&(o="ogx_calendar_layout_decade_months_current "),r===a&&(o+="ogx_calendar_selected_item "),d+='<div class="ogx_calendar_layout_item ogx_calendar_layout_decade_months '+o+'" data-ogx-date="'+r+'-01">'+t(moment(r+"-01"),i)+"</div>"}return d},this.value=function(){return{value:10,unit:"years"}},this.format=function(e){return"["+10*Math.floor(Number(e.format("YYYY"))/10)+"'s]"}},OGX.CalendarLayout.YEAR_MONTHS=function(){"use strict";OGX.CalendarLayout.BASE_LAYOUT.call(this),this.labels=function(e){return'<span class="ogx_calendar_layout_year_months_label">Months</span>'},this.html=function(e,t,i,n){var a,o,r=moment().format("YYYY-MM"),s=e.format("YYYY"),l="",d="";n&&(d=n.format("YYYY-MM"));for(var c=1;c<13;c++)a="",s+"-"+(o=c<10?"0"+c:c)===r&&(a+="ogx_calendar_layout_year_months_current "),s+"-"+o===d&&(a+="ogx_calendar_selected_item "),l+='<div class="ogx_calendar_layout_item ogx_calendar_layout_year_months '+a+'" data-ogx-date="'+s+"-"+o+'-01">'+t(s+"-"+o+"-01",i)+"</div>";return l},this.value=function(){return{value:1,unit:"years"}},this.format=function(){return"Y"}},OGX.CalendarLayout.YEAR_WEEKS=function(){"use strict";OGX.CalendarLayout.BASE_LAYOUT.call(this),this.labels=function(e){return'<span class="ogx_calendar_layout_year_weeks_label">Weeks</span>'},this.html=function(e,t,i,n){var a=moment().week(),o=e.format("YYYY"),r=moment().format("YYYY"),s="",l="";n&&(l=n.week(),s=n.format("YYYY"));for(var d,c,u="",h=1;h<53;h++)d="",a===h&&o===r&&(d="ogx_calendar_layout_year_weeks_current "),l===h&&o===s&&(d+="ogx_calendar_selected_item "),u+='<div class="ogx_calendar_layout_item ogx_calendar_layout_year_weeks '+d+'" data-ogx-date="'+(c=moment().year(o).week(h).format("YYYY-MM-DD"))+'">'+t(c,i)+"</div>";return u},this.value=function(){return{value:1,unit:"years"}},this.format=function(){return"Y"}},OGX.CalendarLayout.YEAR_DAYS=function(){"use strict";OGX.CalendarLayout.BASE_LAYOUT.call(this),this.labels=function(e){return'<span class="ogx_calendar_layout_year_weeks_label">Nth Day</span>'},this.html=function(e,t,i,n){var a,o,r,s="",l=e.format("YYYY-MM-DD"),d=moment(e.format("YYYY")+"-01-01"),c="";n&&(c=n.format("YYYY-MM-DD")),o=e.isLeapYear()?366:365;for(var u=0;u<o;u++)a="",(r=d.format("YYYY-MM-DD"))===l&&(a="ogx_calendar_layout_year_days_current "),r===c&&(a+="ogx_calendar_selected_item "),s+='<div class="ogx_calendar_layout_item ogx_calendar_layout_year_days '+a+'" data-ogx-date="'+r+'">'+t(moment(r),i)+"</div>",d.add(1,"days");return s},this.value=function(){return{value:1,unit:"years"}},this.format=function(){return"Y"}},OGX.CalendarLayout.MONTH_WEEKS=function(){"use strict";OGX.CalendarLayout.BASE_LAYOUT.call(this),this.labels=function(e){return'<span class="ogx_calendar_layout_year_weeks_label">Nth Week</span>'},this.html=function(e,t,i,n){var a,o="",r=moment(),s=Number(r.format("YYYY")),l=Number(r.format("w")),d=Number(e.format("YYYY")),c=0,u=0;n&&(c=Number(n.format("YYYY")),u=Number(n.format("w")));o="";for(var h,_=moment(e.format("YYYY-MM-[01]")),f=0;f<5;f++)h="",a=Number(_.format("w")),d===c&&a===u&&(h+="ogx_calendar_selected_item "),d===s&&a===l&&(h+="ogx_calendar_layout_month_weeks_current"),o+='<div class="ogx_calendar_layout_item ogx_calendar_layout_month_weeks '+h+'" data-ogx-date="'+_.format("YYYY-MM-DD")+'">'+t(_.clone(),i)+"</div>",_.add(7,"days");return o},this.value=function(){return{value:1,unit:"months"}},this.format=function(){return"[(]YYYY-MM[)] W"}},OGX.CalendarLayout.WEEK_DAYS=function(){"use strict";OGX.CalendarLayout.BASE_LAYOUT.call(this),this.labels=function(e){for(var t="",i=function(){for(var e=new Date(Date.UTC(2017,0,2)),t=[],i=0;i<7;i++)t.push(e.toLocaleDateString(navigator.language,{weekday:"short"})),e.setDate(e.getDate()+1);return t}(),n=0;n<i.length;n++)t+='<span class="ogx_calendar_layout_month_days_label">'+i[n]+"</span>";return t},this.html=function(e,t,i,n){var a,o,r="",s=e.weekday(),l=e.subtract(s,"days"),d=moment().format("YYYY-MM-DD"),c="";n&&(c=n.format("YYYY-MM-DD"));for(var u=0;u<7;u++)a="",(o=l.format("YYYY-MM-DD"))===d&&(a="ogx_calendar_layout_week_days_current "),o===c&&(a+="ogx_calendar_selected_item "),r+='<div class="ogx_calendar_layout_item ogx_calendar_layout_week_days '+a+'" data-ogx-date="'+o+'">'+t(moment(o),i)+"</div>",l.add(1,"days");return r},this.value=function(){return{value:1,unit:"weeks"}},this.format=function(){return"YYYY-MM"}},OGX.CalendarLayout.DAY_HOURS=function(){"use strict";OGX.CalendarLayout.BASE_LAYOUT.call(this),this.labels=function(e){return'<span class="ogx_calendar_layout_day_hours_label">Hours</span>'},this.html=function(e,t,i,n){var a,o,r="",s=Number(moment().format("HH")),l=e.format("YYYY-MM-DD "),d=moment().format("YYYY-MM-DD "),c="",u="";n&&(c=Number(n.format("HH")),u=n.format("YYYY-MM-DD "));for(var h=0;h<24;h++)o="",h===s&&l===d&&(o="ogx_calendar_layout_days_hours_current "),h===c&&l===u&&(o+="ogx_calendar_selected_item "),r+='<div class="ogx_calendar_layout_item ogx_calendar_layout_days_hours '+o+'" data-ogx-date="'+(l+(a=h<10?"0"+h:String(h)))+':00">'+t(moment(l+a+":00"),i)+"</div>";return r},this.value=function(){return{value:1,unit:"days"}},this.format=function(){return"YYYY-MM-DD HH:[00]"}},OGX.CalendarLayout.DAY_WORK_HOURS=function(){"use strict";OGX.CalendarLayout.BASE_LAYOUT.call(this),this.labels=function(e){return'<span class="ogx_calendar_layout_day_work_hours_label">Work Hours</span>'},this.html=function(e,t,i,n){i&&void 0!==i?i.hasOwnProperty("start")||(i.start=8,i.end=17):i={start:8,end:17};var a,o,r="",s=Number(moment().format("HH")),l=e.format("YYYY-MM-DD "),d=moment().format("YYYY-MM-DD "),c="",u="";n&&(c=Number(n.format("HH")),u=n.format("YYYY-MM-DD "));for(var h=i.start;h<i.end+1;h++)o="",h===s&&l===d&&(o="ogx_calendar_layout_days_work_hours_current "),h===c&&u===l&&(o+="ogx_calendar_selected_item "),r+='<div class="ogx_calendar_layout_item ogx_calendar_layout_days_work_hours '+o+'" data-ogx-date="'+(l+(a=h<10?"0"+h:h))+':00">'+t(moment(l+a+":00"),i)+"</div>";return r},this.value=function(){return{value:1,unit:"days"}},this.format=function(){return"YYYY-MM-DD HH:[00]"}},OGX.CalendarLayout.DAY=function(e){"use strict";this.labels=function(e){return'<span class="ogx_calendar_layout_day_label">'+function(e){for(var t=new Date(Date.UTC(2017,0,2)),i=[],n=e.day(),a=0;a<7;a++)i.push(t.toLocaleDateString(navigator.language,{weekday:"long"})),t.setDate(t.getDate()+1);return i[n]}(e)+"</span>"},this.html=function(e,t,i,n){var a="",o=e.format("YYYY-MM-DD"),r=moment().format("YYYY-MM-DD");return n&&o===n.format("YYYY-MM-DD")&&(a+="ogx_calendar_selected_item "),o===r&&(a+="ogx_calendar_layout_day_current "),'<div class="ogx_calendar_layout_item ogx_calendar_layout_day '+a+'" data-ogx-date="'+o+'">'+t(e,i)+"</div>"},this.value=function(){return{value:1,unit:"days"}},this.format=function(){return"YYYY-MM-DD"},this.select=function(e){}},OGX.CalendarEngine={},OGX.CalendarEngine.CELL_VALUE=function(e,t){var i=moment(e);return t.hasOwnProperty("css")||(t.css=""),'<div class="ogx_calendar_engine_cell_value '+t.css+'">'+i.format(t.format)+"</div>"},OGX.CalendarEngine.DAY_NUMBER=function(e,t){return OGX.CalendarEngine.CELL_VALUE(e,{format:"DD",css:"ogx_calendar_engine_day_number"})},OGX.CalendarEngine.WEEK_NUMBER=function(e,t){return'<div class="ogx_calendar_engine_week_number">'+moment(e).week()+"</div>"},OGX.CalendarEngine.MONTH_NUMBER=function(e,t){return OGX.CalendarEngine.CELL_VALUE(e,{format:"MM",css:"ogx_calendar_engine_month_number"})},OGX.CalendarEngine.YEAR_NUMBER=function(e,t){return OGX.CalendarEngine.CELL_VALUE(e,{format:"YY",css:"ogx_calendar_engine_year_number"})},OGX.CalendarEngine.DECADE_NUMBER=function(e){return'<div class="ogx_calendar_engine_date_day_number">'+String(e).substr(2)+"'s</div>"},require("Carousel","Uxi","Placeholder","Touch"),OGX.Carousel=function(e){construct(this,"Carousel");var t,i,n,a,o,r,s=this,l=e,d={min_x:100,anim:!0,drag:!0,dots:!1,css:!1,index:0},c={position:"bottom"},u=!1,h=0,_=0,f=new OGX.List,g="ogx_carousel";function p(e){void 0!==e&&f[e]&&f[e].instance&&s.find(f[e].instance._NAME_,f[e].instance.id).blur(2)}function m(e){i.off("transitionend"),i.removeClass(g+"_anim")}function v(e){if(e.distX>e.distY){var t=r*n*-1+e.distX*e.dirX;t<=0&&t>-1*(i.width()-s.el.width())&&i.css({transform:"translate3d("+t+"px, 0, 0)"})}}function y(e){if(e.distX>l.min_x){var i=r+-1*e.dirX;i>=0&&i<_&&r!==i&&(p(r),r=i,t.trigger(OGX.Carousel.CHANGE,r))}var n=0;r&&(n=100/_*(-1*r)),x(n,r,!0)}function x(e,t,n){n?(i.addClass(g+"_anim"),i.on("transitionend",(function(){var e;i.off("transitionend"),i.removeClass(g+"_anim"),void 0!==(e=t)&&f[e]&&f[e].instance&&s.find(f[e].instance._NAME_,f[e].instance.id).focus(2)}))):i.removeClass(g+"_anim"),i.css({transform:"translate3d("+e+"%, 0, 0)"})}function O(){u=!0,clearInterval(a),a=setInterval(b,50),n=Math.floor(t.innerWidth()),i.removeClass(g+"_anim")}function b(){u=!1,clearInterval(a),a=!1}function w(){var e,t,n;_&&(f.clear(),i.children("."+g+"_view").each((function(i,a){e=$(a),(t=e.children(":first")).length?(t[0].hasAttribute("data-ogx-id")&&(n=t.data("ogx-id"),t.hasClass("ogx_scroller_outer")&&(n=t.find(".ogx_scroller_inner:first").data("ogx-id"))),void 0!==s.nodes[i]&&(i!==r?s.nodes[i].blur():s.nodes[i].focus(),f.push({index:i,instance:s.nodes.get({id:{eq:n}},null,1),html:!1}))):f.push({index:i,instance:!1,html:e.html()})})))}this._NAME_=OGX.Carousel.NAME,this.el=null,this.construct=function(){w(),l.index&&this.showPanel(l.index,!1)},this.enable=function(){l.drag&&this.touch.swipe.enable(),setTimeout((function(){for(var e=0;e<f.length;e++)f[e].instance&&e!==r&&f[e].instance.blur()}),0)},this.disable=function(){l.drag&&this.touch.swipe.disable()},this.focus=function(){this.blured&&(this.blured=!1,this.enabled&&(this.ux(!0),this.enable()))},this.blur=function(){this.always_on||this.blured||(this.blured=!0,this.ux(!1),this.disable())},this.resize=function(){setTimeout(O,0)},this.show=function(e,t){var i=this.getNodeIndex(e,t);i&&this.showPanel(i.index)},this.getNodeIndex=function(e,t){var i=f.get({"instance.id":{eq:t},"instance._NAME_":{eq:e}},null,1);return!!i&&{index:i.index}},this.anim=function(e){if(void 0===e)return l.anim;l.anim=e},this.destroy=function(){a&&clearInterval(a),l.dots&&o.destroy()},this.val=function(e){if(void 0===e)return r;this.showPanel(e)},this.panels=function(){return f},this.addNode=function(e,t,n,a){void 0===n&&(n=!1),void 0===a&&(a=!1);var o=function(e){void 0===e&&(e="");return _++,i.append('<div class="'+g+'_view" style="width:'+100/_+'%;" data-ogx-panel-id="'+h+'">'+e+"</div>"),i.css("width",Math.round(100*_)+"%"),i.children("."+g+"_view").css("width",100/_+"%"),++h-1}(),r="."+g+'[data-ogx-id="'+this.id+'"] .'+g+"_views:first ."+g+'_view[data-ogx-panel-id="'+o+'"]',l={},d=r;for(var c in e){d+=":"+c.split(":")[1],l[d]=e[c];break}setTimeout((function(){OGX.OML.render(s,l,t),setTimeout(w,0),n&&s.showPanel(_-1,a)}),0)},this.removeNode=function(e){for(var t=0;t<f.length;t++)if(f[t].instance.id===e)return this.removePanel(t),!0;return!1},this.showPanel=function(e,t,i){if((void 0===i&&(i=!1),e>=0&&e<_&&!u)&&((a=r)!==e||i)){void 0===t&&(t=l.anim),p(r);var n=100/_*(-1*e),a=e;return setTimeout((function(){x(n,a,t)}),0),r=e,l.dots&&o.select(e),!0}return!1},this.getPanel=function(e){return f.get({index:{eq:e}},null,1)},this.swapPanels=function(e,n){var a=i.children("."+g+"_view:eq("+e+")").detach();n>e?i.children("."+g+"_view:eq("+(n-1)+")").after(a):i.children("."+g+"_view:eq("+n+")").before(a);var o=100/_*(-1*n);i.removeClass(g+"_anim"),i.css({transform:"translate3d("+o+"%, 0, 0)"}),r=n,setTimeout(w,0),t.trigger(OGX.Carousel.CHANGE,r)},this.removePanel=function(e){if(e>=0&&e<_){if(i.children("."+g+"_view:eq("+e+")").children().data("ogx-id")){var t=f[e];t.instance&&this.find(t.instance._NAME_,t.instance.id,"remove")}return _--,r>=e&&r--,i.children("."+g+"_view:eq("+e+")").remove(),i.removeClass(g+"_anim").css("width",Math.round(100*_)+"%"),i.children("."+g+"_view").css("width",100/_+"%"),setTimeout(w,0),s.showPanel(e-1,!1,!0),!0}return!1},OGX.Data.merge(l,d,!1),l.dots&&("boolean"==typeof l.dots&&(l.dots={}),OGX.Data.merge(l.dots,c)),r=l.index,s.el=t=$(l.el),n=Math.floor(t.innerWidth()),l.hasOwnProperty("node:OML")&&(_=l["node:OML"].length),function(){l.css||(l.css=""),t.addClass(g+" "+l.css);var e="";l.dots&&"top"===l.dots.position&&(e+='<div class="carousel_dots"></div>'),e+='<div class="'+g+'_views" style="width:'+100*_+'%;"></div>',l.dots&&"bottom"===l.dots.position&&(e+='<div class="carousel_dots"></div>'),t.append(e),(i=t.find("."+g+"_views:first")).css({transform:"translate3d("+100/_*(-1*r)+"%, 0, 0)"})}(),l.dots&&(o=s.create("Dots",{el:"."+g+'[data-ogx-id="'+s.id+'"] > .carousel_dots',total:_})).bind("dots",s),function(){for(var e=[],n=0;n<_;n++)i.append('<div class="'+g+'_view" style="width:'+100/_+'%;" data-ogx-panel-id="'+h+'"></div>'),e.push("."+g+'[data-ogx-id="'+s.id+'"] > .'+g+"_views > ."+g+'_view[data-ogx-panel-id="'+h+'"]'),h++;s.placeholders(l,e),t.trigger(OGX.Carousel.READY)}(),s.touch.swipe.set({x:!0,cb_down:m,cb_swipe:v,cb_up:y})},OGX.Carousel.NAME="Carousel",OGX.Carousel.READY="CarouselReady",OGX.Carousel.DRAG="CarouselDrag",OGX.Carousel.CHANGE="CarouselChange",OGX.Carousel.RESTORE="CarouselRestore",void 0===OGX)var OGX={};require("Chat","Uxi"),OGX.Chat=function(__config){construct(this,"Chat");var that=this,config=__config,config_default={placeholder:"Type a message",dot_speed:600,on_keyb_update_delay:300,messages:[],handle_keyboard:!0,hide_keyboard_on_send:!1,template_left:'<div class="ogx_chat_message ogx_chat_message_left" style="{{$opacity}} data-id="{{$uid}}"><span class="ogx_chat_message_icon" style="{{$bg}}"><span>{{$letter}}</span></span><span class="ogx_chat_message_container"><span class="ogx_chat_message_body">{{$body}}</span><span class="ogx_chat_message_date">{{$date}}</span><span style="clear:both"></span></span></div>',template_right:'<div class="ogx_chat_message ogx_chat_message_right" style="{{$opacity}}" data-id="{{$uid}}"><span class="ogx_chat_message_container"><span class="ogx_chat_message_body">{{$body}}</span><span class="ogx_chat_message_date">{{$date}}</span><span style="clear:both"></span></span></div>',key:"_id",users:[],user:!1,display_mode:OGX.Chat.DISPLAY_INITIALS,picture_key:"",restrict:{multiline:!1,length:500},date_format:"YYYY-MM-DD h:mm:ss A",url_encode:!0},container,inner,scroller,composer,intv,oldh=!1,typing={},type=".",enabled=!1;function render(){if(config.messages.length>0){for(var e=0;e<config.messages.length;e++)addMessage(config.messages[e]);scroller.resize(),scroller.bottom()}scroller.vocal()}function addMessage(__msg,__prepend){void 0===__prepend&&(__prepend=!1),scroller.observe(!1),scroller.mute();var u=config.users.find(config.key,__msg.from,1);if(u){var initals=u.first_name.substr(0,1).toUpperCase()+u.last_name.substr(0,1).toUpperCase();switch(config.display_mode){case OGX.Chat.DISPLAY_INITIALS:__msg.letter=initals,__msg.bg="";break;case OGX.Chat.DISPLAY_PICTURE:__msg.letter="";var e=eval("u."+config.picture_key);"undefined"!==e?__msg.bg="background-image:url('"+e+"')":(__msg.letter=initals,__msg.bg="")}__msg.uid=u[config.key],__msg.opacity=__prepend?"opacity:1;":"",config.url_encode&&(__msg.body=decodeURIComponent(__msg.body));var html=OGX.Templater.templatize(getTemplate(__msg),__msg);__prepend?inner.prepend(html):inner.append(html);var msg=inner.children(".ogx_chat_message:last");setTimeout((function(){msg.addClass("ogx_chat_message_anim"),scroller.resize(),__prepend?scroller.top():scroller.bottom(),scroller.vocal(),scroller.observe(!0)}),100)}}function addTyping(e){typing[e]=!0;var t='<div class="ogx_chat_typing" data-user="'+e+'"><span class="ogx_chat_typing_body">.</div></div>';inner.append(t),animTyping(!0)}function removeTyping(e){typing[e]=!1,inner.find('.ogx_chat_typing[data-user="'+e+'"]').remove(),0===inner.find(".ogx_chat_typing").length&&animTyping(!1)}function animTyping(e){e?intv||(intv=setInterval(typeDot,config.dot_speed)):(clearInterval(intv),intv=null)}function typeDot(){(type+=".").length>3&&(type="."),inner.find(".ogx_chat_typing_body").html(type)}function getTemplate(e){return e.from===config.user?config.template_right:config.template_left}function sendMessage(){var e=composer.find("textarea:first").val();if(e.length&&(e=(e=(e=e.replace(/^[\r|\n\r]+/,"")).replace(/<\/?[^>]+(>|$)/g,"")).replace(//,"'")).length){e=e.replace(/[\r\n]/g,"<br>");var t={from:config.user,body:e,date:moment().format(config.date_format)};addMessage(t);var i=OGX.Data.clone(t);config.url_encode&&(i.body=encodeURIComponent(i.body)),delete i.bg,delete i.letter,composer.find("textarea:first").val(""),that.el.trigger(OGX.Chat.SEND_MESSAGE,i)}}function handleShowKeyb(e){oldh||(oldh=container.height()),container.height(oldh-e.keyboardHeight),updateScroller()}function handleHideKeyb(){container.height(oldh),updateScroller()}function updateScroller(){setTimeout((function(){scroller.resize(),scroller.bottom()}),config.on_keyb_update_delay)}function listenKeyb(e){e?(window.addEventListener("native.keyboardshow",handleShowKeyb),window.addEventListener("native.keyboardhide",handleHideKeyb)):(window.removeEventListener("native.keyboardshow",handleShowKeyb),window.removeEventListener("native.keyboardhide",handleHideKeyb))}function listenArea(e){e?composer.on("keyup","textarea",(function(e){13===e.which&&(sendMessage(),config.hide_keyboard_on_send&&handleHideKeyb())})):composer.off("keyup","textarea")}function listenComposer(e){e?composer.on("click",".ogx_chat_composer_send",(function(){sendMessage(),config.hide_keyboard_on_send&&handleHideKeyb()})):composer.off("click",".ogx_chat_composer_send")}function initScroller(){scroller=that.create("Scroller",{el:that.el.find(".ogx_chat_messages:first")[0],initDelay:100,auto_scroll:!0,trigger:!0}),inner=scroller.inner(),(inner=$(inner)).addClass("ogx_chat_messages_inner"),scroller.mute(),scroller.resize(),render()}function initMarkup(){var e='<div class="ogx_chat_messages"></div><div class="ogx_chat_composer">';e+='<span class="ogx_chat_composer_input"><textarea placeholder="'+config.placeholder+'">',e+='</textarea></span><span class="ogx_chat_composer_send"></span></div>',container.append(e),composer=container.find(".ogx_chat_composer:first")}function initUsers(){for(var e in config.users)typing[e]=!1}function initDefaults(){for(var e in config_default)config.hasOwnProperty(e)||(config[e]=config_default[e]);config.users.hasOwnProperty("find")||(config.users=new OGX.List(config.users)),that.el=container=$(config.el),container.addClass("ogx_chat")}function init(){if(initDefaults(),initMarkup(),initUsers(),initScroller(),config.restrict){var e=JSON.parse(JSON.stringify(config.restrict));config.restrict.hasOwnProperty("forbidden")&&(e.forbidden=config.restrict.forbidden),config.restrict.hasOwnProperty("allowed")&&(e.allowed=config.restrict.allowed),e.el=that.el.find(".ogx_chat_composer:first .ogx_chat_composer_input:first textarea")[0],OGX.Form.restrictField(e)}that.enable()}this._NAME_=OGX.Chat.NAME,this.el=null,this.enable=function(){enabled||(enabled=!0,config.handle_keyboard&&listenKeyb(!0),listenComposer(!0),listenArea(!0))},this.disable=function(){this.el.find(".ogx_chat_composer:first .ogx_chat_composer_input:first textarea").blur(),enabled&&(enabled=!1,config.handle_keyboard&&listenKeyb(!1),listenComposer(!1),listenArea(!1))},this.users=function(e){return void 0!==e?(e.hasOwnProperty("find")||(e=new OGX.List(e)),config.users=e,!0):config.users},this.user=function(e){return void 0===e?config.user:(config.user=e,!0)},this.typing=function(e,t){e&&!typing[t]?addTyping(t):!e&&typing[t]&&removeTyping(t)},this.compose=function(e){composer.find("textarea:first").val(e)},this.clear=function(){inner.empty()},this.getScroller=function(){return scroller},this.addMessage=function(e){addMessage(e)},this.setMessages=function(e){config.messages=e,render()},this.prependMessages=function(e){for(var t=0;t<e.length;t++)addMessage(e[t],!0);config.messages=e.concat(config.messages)},this.destroy=function(){config.restrict&&OGX.Form.unrestrictField(that.el.find(".ogx_chat_composer:first .ogx_chat_composer_input:first textarea")[0])},init()},OGX.Chat.NAME="Chat",OGX.Chat.SEND_MESSAGE="ChatSend",OGX.Chat.DISPLAY_INITIALS="ChatDisplayInitials",OGX.Chat.DISPLAY_PICTURE="ChatDisplayPicture",OGX.Color={},OGX.Color.hexToRgb=function(e){"use strict";e=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(function(e,t,i,n){return t+t+i+i+n+n}));var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null},OGX.Color.rgbToHex=function(e,t,i){"use strict";return"#"+((1<<24)+(e<<16)+(t<<8)+i).toString(16).slice(1)},OGX.Color.rgbToHsl=function(e){"use strict";var t,i,n,a=new RegExp("rgb\\(([0-9]+)\\, ([0-9 ]+)\\, ([0-9]+)","g").exec(e);if(a){a.shift(),t=a[0],i=a[1],n=a[2],t/=255,i/=255,n/=255;var o,r,s=Math.max(t,i,n),l=Math.min(t,i,n),d=(s+l)/2;if(s===l)o=r=0;else{var c=s-l;switch(r=d>.5?c/(2-s-l):c/(s+l),s){case t:o=(i-n)/c+(i<n?6:0);break;case i:o=(n-t)/c+2;break;case n:o=(t-i)/c+4}o/=6}return[o,r,d]}return!1},OGX.Color.hslToRgb=function(e,t,i){"use strict";var n,a,o;if(0===t)n=a=o=i;else{var r=function(e,t,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?e+6*(t-e)*i:i<.5?t:i<2/3?e+(t-e)*(2/3-i)*6:e},s=i<.5?i*(1+t):i+t-i*t,l=2*i-s;n=r(l,s,e+1/3),a=r(l,s,e),o=r(l,s,e-1/3)}return[Math.round(255*n),Math.round(255*a),Math.round(255*o)]},require("Container","Uxi"),OGX.Container=function(e){construct(this,"Container");var t=this,i={tabs:!0,carousel:{enabled:!0},enabled:!0,reorder:!0,anim:!0,drag:!0,flatten:!1,chromeos:!1,index:0,dots:!1},n=e,a=!1,o=!1,r=!1,s="normal",l=0;function d(e){e?(o.el.on(OGX.Tabs.SELECT,(function(e,i){var n=o.index();r.val(n),t.el.trigger(OGX.Container.CHANGE,n)})),o.el.on(OGX.Tabs.CLOSE,(function(){})),o.el.on(OGX.Tabs.REORDER,(function(e,t){r.swapPanels(t.from,t.to)})),o.el.on(OGX.Tabs.ADD,(function(){})),r.el.on(OGX.Carousel.CHANGE,(function(e,i){o.selectIndex(i),t.el.trigger(OGX.Container.CHANGE,i)}))):(o.el.off(OGX.Tabs.SELECT),o.el.off(OGX.Tabs.CLOSE),o.el.off(OGX.Tabs.REORDER),o.el.off(OGX.Tabs.ADD),r.el.off(OGX.Carousel.CHANGE)),function e(i){i?o.el.on(OGX.Tabs.REMOVE,(function(i,n){e(!1);var a=t.el.parents(".ogx_popup:first").data("ogx-id");a=app.cfind("Popup",a),app.ungroupPopup(a,n.index,n.label),setTimeout((function(){e(!0)}),200)})):o.el.off(OGX.Tabs.REMOVE)}(e)}this.el=null,this._NAME_=OGX.Container.NAME,this.construct=function(){r=this.find(OGX.Carousel.NAME,this.id+"_carousel")},this.show=function(e,t){if(r&&"normal"===s){var i=r.getNodeIndex(e,t);i&&(r.val(i.index),n.tabs&&o.selectIndex(i.index))}},this.showIndex=function(e){return!(!r||"normal"!==s)&&(r.val(e),n.tabs&&o.selectIndex(e),!0)},this.enable=function(){n.tabs&&r&&d(!0)},this.disable=function(){n.tabs&&r&&d(!1)},this.resize=function(){var e,t;n.flatten&&(r&&"flattened"!==s&&this.el.width()>=n.flatten?(s="flattened",n.tabs&&(o.blur(),o.hide()),r.blur(),l=(e=r.el.children(".ogx_carousel_views:first"),t=e[0].style.transform,t=(t=t.match(/translate3d\(([0-9px%,\.\- ]+)\)/))[1].split(","))[0],r.el.children(".ogx_carousel_views:first").addClass("ogx_container_flattened").css("transform","translate3d(0px, 0px, 0px)")):r&&"flattened"===s&&this.el.width()<n.flatten&&(s="normal",n.tabs&&(o.focus(),o.show()),r.focus(),r.el.children(".ogx_carousel_views:first").removeClass("ogx_container_flattened").css("transform","translate3d("+l+", 0px, 0px)")))},function(){OGX.Data.merge(n,i,!1),n.tabs&&"object"!=typeof n.tabs&&(n.tabs={}),t.el=a=$(n.el),a.addClass("ogx_container");var e,r=!1;n.tabs&&(e={el:'.ogx_container[data-ogx-id="'+t.id+'"]',reorder:n.reorder,editable:!1,chromeos:n.chromeos,enabled:n.enabled,index:n.index},e=OGX.Data.merge(n.tabs,e),o=t.create("Tabs",e),r="ogx_carousel_shink");var s=n["node:OML"].slice(),l={},d='.ogx_container[data-ogx-id="'+t.id+'"]:Carousel';l["node:OML"]={},l["node:OML"][d]={id:t.id+"_carousel",css:r,anim:n.anim,chromeos:n.chromeos,drag:n.drag,enabled:n.carousel.enabled,index:n.index,dots:n.dots,"node:OML":s},n["node:OML"]=l["node:OML"],setTimeout((function(){t.resize()}),0)}()},OGX.Container.NAME="Container",OGX.Container.CHANGE="ContainerChange",require("Controller","Touch"),OGX.Controller=function(e){construct(this,"Controller");e=OGX.Data.merge(e,{enabled:!0,blured:!0,always_on:!1}),this.el=!1,this.enabled=e.enabled,this.blured=e.blured,this.floating=!1,this.always_on=e.always_on,this.id=e.id,this._NAME_=OGX.Controller.NAME},OGX.Controller.prototype.blur=function(){this.always_on||this.blured||(this.blured=!0,this.ux(!1),this.disable())},OGX.Controller.prototype.focus=function(){this.blured&&(this.blured=!1,this.enabled&&(this.ux(!0),this.enable()))},OGX.Controller.prototype.construct=function(){},OGX.Controller.prototype.enable=function(){},OGX.Controller.prototype.disable=function(){},OGX.Controller.prototype.ux=function(){},OGX.Controller.prototype.resize=function(){},OGX.Controller.prototype.clear=function(){},OGX.Controller.prototype.destroy=function(){},OGX.Controller.prototype.kill=function(){OGX.Object.destroy(this)},OGX.Controller.NAME="Controller",OGX.Display=function(e){"use strict";var t,i,n={display:!1,displays:!1},a={html:!1,css:!1,oml:!1,placeholder:!1,template:!1,view:!1,bind_css:!1,add_css:!1,calc_css:!1,bind_template:!1};function o(e){if(t.display&&!t.display.hasOwnProperty("bind"))return t.display;if(t.displays&&t.display.hasOwnProperty("bind")){if(e.hasOwnProperty(t.display.bind)){var i=e[t.display.bind];return t.displays[i]}if(t.displays.hasOwnProperty("__default"))return t.displays.__default}return!1}function r(e){var t=OGX.Data.merge(a,e,!0,!0);return t.template&&("object"==typeof t.template?t.bind_template=!0:(t.html=OGX.Templater.getTemplate(t.template),t.template=!1)),t.css&&(t.bind_css="object"==typeof t.css&&t.css.hasOwnProperty("bind"),t.add_css="object"==typeof t.css&&t.css.hasOwnProperty("add"),t.calc_css="object"==typeof t.css&&t.css.hasOwnProperty("conditions")),t}function s(e){if(void 0===e&&(e={}),t=OGX.Data.clone(n),!e.hasOwnProperty("display")&&!e.hasOwnProperty("displays"))return t.display=OGX.Data.merge(a,e,!0,!0,!0),t.display=r(t.display),void(i=o());if(e.hasOwnProperty("display")&&e.display&&!e.display.hasOwnProperty("bind"))return t.display=OGX.Data.merge(a,e.display,!0,!0,!0),t.display=r(t.display),void(i=o());if(e.hasOwnProperty("display")&&e.display&&e.display.hasOwnProperty("bind")&&e.hasOwnProperty("displays")&&e.displays&&(t.display=e.display,t.displays=OGX.Data.clone(e.displays)),t.displays)for(var s in t.displays)t.displays[s]=OGX.Data.merge(a,t.displays[s],!0,!0,!0),t.displays[s]=r(t.displays[s])}this._NAME_=OGX.Display.NAME,this.val=function(e){if(void 0===e)return OGX.Data.clone(t);s(e)},this.display=function(e){return t.displays&&t.displays.hasOwnProperty(e)?(i=t.displays[e],!0):i},this.css=function(e){var t,n="",a=void 0!==e;if((t=a?o(e):i)&&(t.bind_css&&a?n+=e[t.css.bind]:t.css&&"string"==typeof t.css&&(n=t.css),t.add_css&&(n+=" "+t.css.add),t.calc_css&&a))for(var r,s,l=0;l<t.css.conditions.length;l++)if("true"===OGX.Templater.templatize(t.css.conditions[l][0],e)&&((r=t.css.conditions[l][1]).hasOwnProperty("css")&&(n=r.css),r.hasOwnProperty("add")&&(n+=" "+r.add),r.hasOwnProperty("remove"))){s=r.remove.explode(" ");for(var d=0;d<s.length;d++)n=n.replace(s[0],"")}return n||""},this.html=function(e){var t,n=!1,a=void 0!==e;return(t=a?o(e):i)&&(t.bind_template&&a?n=OGX.Templater.getTemplate(e[t.template.bind]):(t.template||t.html)&&(n=t.html),a&&n&&(n=OGX.Templater.templatize(n,e))),n||(n=""),n},this.oml=function(e,t,n){void 0===n&&(n="&item");var a={},r=o(t);if(r||(r=i),r){if(r.oml)return a=OGX.OML.replaceNodeName(OGX.Data.clone(r.oml),e),void 0!==n&&OGX.OML.replaceDataRecursive(a,t,n),r.placeholder?function(e,t,i){var n,a,o=OGX.Data.clone(e.oml);for(var r in o){var s,l;for(var d in n=r.replace("default",t),o[n]=o[r],o[n]["node:OML"]=[],e.placeholder){l=i[d].length;for(var c=0;c<l;c++){for(var u in s=OGX.Data.clone(e.placeholder[d]),(a=OGX.Data.clone(i))[d]=a[d][c],s){s[u].data=a;break}o[n]["node:OML"].push(s)}return delete o[r],o}}return!1}(r,e,t):a;if(r.template)return"string"==typeof r.template?a[e+":Templates."+r.template]={data:t}:a[e+":Templates."+t[r.template.bind]]={data:t},a;if(r.hasOwnProperty("html"))return a[e+":Html"]={html:this.html(t)},a}return!1},this.hasOML=function(){return!1!==i.oml},this.toJSON=function(){return t},s(e)},OGX.Display.NAME="Display",require("Dots","Uxi","Touch"),OGX.Dots=function(e){construct(this,"Dots");var t,i=this,n=e,a={el:"document",total:0,current:0,clickable:!0},o={};function r(e){switch(o[e]._NAME_){case OGX.Carousel.NAME:o[e].el.off(OGX.Carousel.CHANGE,s),delete o[e];break;case OGX.Iceberg.NAME:o[e].el.off(OGX.Iceberg.SHOW,s),delete o[e]}}function s(e,t){i.select(t)}function l(e){e?t.on(i.touch.down,".ogx_dots_item",(function(){var e=Number($(this).data("id"));i.select(e),t.trigger(OGX.Dots.SELECT,e),function(e){for(var t in o)switch(o[t]._NAME_){case OGX.Carousel.NAME:o[t].val(e)}}(e)})):t.off(i.touch.down)}function d(){for(var e,i="",a=0;a<n.total;a++)e="",n.current===a&&(e="ogx_dots_selected"),i+='<div class="ogx_dots_item" data-id="'+a+'"><span class="ogx_dots_gfx '+e+'"></span></div>';t.html(i)}this._NAME_=OGX.Dots.NAME,this.el=null,this.enable=function(){n.clickable&&l(!0)},this.disable=function(){n.clickable&&l(!1)},this.bind=function(e,t){return!(o.hasOwnProperty(e)||!t.hasOwnProperty("_NAME_"))&&function(e,t){switch(o[e]=t,t._NAME_){case OGX.Carousel.NAME:n.total=t.panels().length,n.current=t.val(),setTimeout(d,0),t.el.on(OGX.Carousel.CHANGE,s);break;case OGX.Iceberg.NAME:n.total=t.panels().length,n.current=t.val(),setTimeout(d,0),t.el.on(OGX.Iceberg.SHOW,s)}return!0}(e,t)},this.unbind=function(e){return!!o.hasOwnProperty(e)&&r(e)},this.select=function(e){t.find(".ogx_dots_selected").removeClass("ogx_dots_selected"),t.children(".ogx_dots_item:eq("+e+")").children(".ogx_dots_gfx:first").addClass("ogx_dots_selected"),n.current=e},this.destroy=function(){!function(){for(var e in o)r(e)}()},OGX.Data.merge(n,a),i.el=t=$(n.el),t.addClass("ogx_dots"),d()},OGX.Dots.NAME="Dots",OGX.Dots.SELECT="DotsSelect",require("DynamicList","Uxi","Bind","Touch"),OGX.DynamicList=function(e){construct(this,"DynamicList");var t,i,n,a,o=this,r=e,s={el:null,key:!1,as:"item",display:!1,displays:!1,reorder:!1,swipe:!1,chromeos:!1,min_x:30,click_time:100,hold_time:2e3,interval:5,list:[],mode:OGX.DynamicList.SELECT_MODE_SINGLE,trigger:!1,swipe_template:'<div class="ogx_dynamic_list_item ogx_dynamic_list_swiper_back_item" style="height:{{$height}}px; z-index:{{$zindex}}; margin-bottom:{{$margin}}px;">{{$template}}</div>',zindex:1},l={mode:OGX.DynamicList.SWIPE_MODE_DELETE,options:{},template:!1,html:""},d=new OGX.List,c=1,u={mode:!1,stime:0,target:0,si:0,ei:0,y:0},h=null,_=null,f=null,g=0,p=new OGX.Display(r),m=!1,v=!1;function y(e,t,i){if(p.hasOML()){var n,a,s=p.oml('.ogx_dynamic_list[data-ogx-id="'+o.id+'"] .ogx_dynamic_list_item[data-ogx-id="'+i[t]+'"]',i,r.as);$('.ogx_dynamic_list[data-ogx-id="'+o.id+'"] .ogx_dynamic_list_item[data-ogx-id="'+i[t]+'"]').find(".ogx_uxi").each((function(e,t){n=$(t).data("ogx-id"),(a=o.cfind(!1,n,1))&&o.find(a._NAME_,a.id,"remove")})),OGX.OML.render(o,s,i)}else e.html(p.html(i))}function x(){var e=R(),i=d;n&&(d.resetFilters(),d.setFilters(r.list.getFilters()),i=d.filter(),i.length!==d.length&&(i.length?t.trigger(OGX.DynamicList.SELECT,i):t.trigger(OGX.DynamicList.UNSELECT)));for(var s,l,c,u="",h=[],_=0;_<e.length;_++)!1,l="",s=e[_][a],d.find(a,s,1)&&(l="ogx_dynamic_list_selected_item"),p.html(e[_]),u+='<div class="ogx_dynamic_list_item '+l+" "+p.css(e[_])+'" data-ogx-id='+s+"></div>",c=p.oml('.ogx_dynamic_list[data-ogx-id="'+o.id+'"] .ogx_dynamic_list_item[data-ogx-id="'+s+'"]',e[_],r.as),h.push(c);t.html(u),function(e){for(var t=0;t<e.length;t++)o.parse(e[t])}(h),r.trigger&&t.trigger(OGX.DynamicList.RENDER)}function O(e){void 0!==t&&m&&(e?t.on("click",".ogx_dynamic_list_item",I):t.off("click",".ogx_dynamic_list_item",I))}function b(e){e?t.on(o.touch.down,".ogx_dynamic_list_item",X):t.off(o.touch.down,".ogx_dynamic_list_item",X)}function w(e){e?_=setInterval(T,20):(clearInterval(_),_=null)}function G(e){e?t.on(o.touch.move,".ogx_dynamic_list_item",E):t.off(o.touch.move,".ogx_dynamic_list_item")}function X(e){u.mode=!1,u.target=$(e.currentTarget),u.si=u.target.index(),u.cy=t.offset().top,e=o.event(e),u.startx=e.pageX,u.starty=e.pageY,f&&clearInterval(f),u.stime=(new Date).getTime(),r.reorder&&w(!0),G(!0),$("body").on(o.touch.up,C)}function E(e){e=o.event(e),u.y=-1*(u.starty-e.pageY),u.mx=e.pageX-u.startx,u.px=e.pageX,u.py=e.pageY,u.st=!1,r.swipe&&!u.mode&&Math.abs(u.mx)>r.min_x&&(u.mode="swipe",r.scroll&&!u.st&&(u.st=!0,v.disable(),v.container().css("cssText","height:"+v.container().height()+"px !important;")),r.reorder&&w(!1),D(!0))}function T(){!u.mode&&(new Date).getTime()-u.stime>r.hold_time&&(u.mode="reorder",u.item=r.list.find(a,u.target.data("id").toString(),1),t.trigger(OGX.DynamicList.HOLD,u.item),w(!1),setTimeout(function(){u.tgy=u.target.position().top,u.tgx=u.target.position().left,u.y=0;var e=u.target.outerWidth(),i=u.target.outerHeight();u.clone=u.target.clone().css({position:"absolute",left:u.tgx+"px",top:u.tgy+"px",width:e+"px",height:i+"px"}).addClass("ogx_dynamic_list_reorder").prependTo(t),u.target.addClass("ogx_dynamic_list_frozen"),f=setInterval(Y,r.interval),t.on(o.touch.move,A)}(),0))}function C(e){if($("body").off(o.touch.up,C),(r.reorder||r.swipe)&&(clearInterval(f),f=!1,G(!1)),r.swipe&&D(!1),r.reorder&&w(!1),r.scroll&&(v.enable(),v.container().removeAttr("style")),r.reorder&&"reorder"===u.mode){if(t.off(o.touch.move,A),u.clone){var i=JSON.parse(JSON.stringify(r.list[u.si]));return r.list.delete(u.si),r.list.insert(i,u.ei),u.clone.remove(),u.clone=!1,u.target.removeClass("ogx_dynamic_list_frozen"),void t.trigger(OGX.DynamicList.DROP,u.item)}if((new Date).getTime()-u.stime<r.click_time){var n=u.target.data("id").toString(),s=r.list.find(a,n,1);t.trigger(OGX.DynamicList.SELECT,s),o.select(a,n)}}else if(r.swipe&&"swipe"===u.mode){var l=u.target.outerWidth(!0),d=Math.abs(100*u.mx/l);d<50?d?(u.target.addClass("ogx_dynamic_list_swiper_trans_item_restore"),u.target.addClass("ogx_dynamic_list_swiper_trans_item").css("transform","translateX(0px)")):(u.target.next(".ogx_dynamic_list_swiper_back_item:first").remove(),u.target.css("transform","translateX(0px)")):u.mx>0?(u.target.attr("data-side","left"),u.target.addClass("ogx_dynamic_list_swiper_trans_item").css("transform","translateX("+l+"px)")):(u.target.attr("data-side","right"),u.target.addClass("ogx_dynamic_list_swiper_trans_item").css("transform","translateX("+-1*l+"px)"))}u.mode=!1}function D(e){e?h=setInterval(M,r.interval):(clearInterval(h),h=!1)}function M(){if("swipe"===u.mode&&Math.abs(u.mx)>r.min_x){var e=parseInt(u.target.css("border-top-width").split("px")[0]),t=parseInt(u.target.css("border-bottom-width").split("px")[0]),i=u.target.outerHeight();if(!u.target.hasClass("ogx_dynamic_list_swiper_work")){u.target.addClass("ogx_dynamic_list_swiper_work");var n={};n.height=i,n.margin=-2*(e+t),n.top=u.target.position().top,n.zindex=r.zindex;var a="";r.swipe.template?a=OGX.Templater.getTemplate(r.swipe.template):r.swipe.html&&(a=r.swipe.html),n.template=a,a=OGX.Templater.templatize(r.swipe_template,n),u.target.after(a)}if(r.swipe.mode===OGX.DynamicList.SWIPE_MODE_SIDE&&(u.mx<0?(g=1,u.target.next(".ogx_dynamic_list_swiper_back_item:first").addClass("ogx_dynamic_list_swiper_side_left").removeClass("ogx_dynamic_list_swiper_side_right")):(g=-1,u.target.next(".ogx_dynamic_list_swiper_back_item:first").addClass("ogx_dynamic_list_swiper_side_right").removeClass("ogx_dynamic_list_swiper_side_left"))),u.py>=u.target.offset().top&&u.py<=u.target.offset().top+i){u.target.css("transform","translateX("+u.mx+"px)");var o=u.target.next(".ogx_dynamic_list_swiper_back_item:first");u.mx<0?o.addClass("ogx_dynamic_list_swiper_right").removeClass("ogx_dynamic_list_swiper_left"):o.addClass("ogx_dynamic_list_swiper_left").removeClass("ogx_dynamic_list_swiper_right")}else C(u.target)}}function S(e){e?t.on("transitionend",".ogx_dynamic_list_swiper_trans_item",L):t.off("transitionend",".ogx_dynamic_list_swiper_trans_item",L)}function L(e){var i=$(this),n=i.next(".ogx_dynamic_list_swiper_back_item:first");if(i.hasClass("ogx_dynamic_list_swiper_trans_item_restore"))n.remove(),i.css("transform","translateX(0px)"),i.removeClass("ogx_dynamic_list_swiper_trans_item");else{var a,o=i.index(),s=i.data("ogx-id");switch(r.swipe.mode){case OGX.DynamicList.SWIPE_MODE_DELETE:i.remove(),N(n),a=r.list.findDelete(r.key,String(s),1),t.trigger(OGX.DynamicList.DELETE,{item:a,index:o});break;case OGX.DynamicList.SWIPE_MODE_SIDE:var l;a=r.list.find(r.key,s,1),l=-1===g?"right":"left",t.trigger(OGX.DynamicList.SIDED,{side:l,item:a,index:o});break;case OGX.DynamicList.SWIPE_MODE_CUSTOM:}}i.removeClass("ogx_dynamic_list_swiper_work"),i.removeClass("ogx_dynamic_list_swiper_trans_item_restore")}function N(e,t){e.addClass("ogx_dynamic_list_swiper_delete"),e.on("transitionend",(function(){e.off("transitionend"),e.remove()}))}function A(e){e.preventDefault(),e.stopImmediatePropagation(),e=o.event(e),u.y=-1*(u.starty-e.pageY)}function Y(){if(Math.abs(t.offset().top-u.cy)>1)return clearInterval(f),f=!1,u.clone.remove(),u.clone=!1,u.target.removeClass("ogx_dynamic_list_frozen"),void t.trigger(OGX.DynamicList.RELEASE);var e=!1,i=t.children(".ogx_dynamic_list_item:last"),n=i.offset().top+-1*u.cy;if(u.tgy+u.y<n?u.clone.css({top:u.tgy+u.y}):e=i,!e){var o,s,l,d,c=0;t.children(".ogx_dynamic_list_item").each((function(t,i){if((i=$(i))[0]!==u.clone[0]&&!i.hasClass("ogx_dynamic_list_frozen")){if(o=i.offset().top,s=i.outerHeight(),d=o+s/2,(l=u.clone.offset().top)>o&&l<d)return c=-1,void(e=i);if(l>d&&l<o+s)return c=1,void(e=i)}}))}if(e){switch(u.ei=r.list.findIndex(a,$(e).data("id").toString()).index,c){case-1:e.index()-1!==u.target.index()&&u.target.detach().insertBefore(e);break;case 1:e.index()+1!==u.target.index()&&u.target.detach().insertAfter(e)}e=!1}}function I(e){var i,n=$(this);switch(r.mode){case OGX.DynamicList.SELECT_MODE_SINGLE:n.hasClass("ogx_dynamic_list_selected_item")||n.hasClass("ogx_dynamic_list_swiper_trans_item")||(i=P(n.index(),!0),t.trigger(OGX.DynamicList.SELECT,i));break;case OGX.DynamicList.SELECT_MODE_TOGGLE:n.hasClass("ogx_dynamic_list_selected_item")||n.hasClass("ogx_dynamic_list_swiper_trans_item")?(i=P(n.index(),!1),t.trigger(OGX.DynamicList.UNSELECT,i)):(o.resetSelection(),i=P(n.index(),!0),t.trigger(OGX.DynamicList.SELECT,i));break;case OGX.DynamicList.SELECT_MODE_MULTI:n.hasClass("ogx_dynamic_list_selected_item")||n.hasClass("ogx_dynamic_list_swiper_trans_item")?(i=P(n.index(),!1),t.trigger(OGX.DynamicList.UNSELECT,i)):(i=P(n.index(),!0),t.trigger(OGX.DynamicList.SELECT,i));break;case OGX.DynamicList.SELECT_MODE_HIT:var a=R();if(n.hasClass("ogx_dynamic_list_swiper_back_item")){var s="left";n.hasClass("ogx_dynamic_list_swiper_side_right")&&(s="right"),t.trigger(OGX.DynamicList.BACK_HIT,{side:s,item:a[n.index()]})}else t.trigger(OGX.DynamicList.SELECT,a[n.index()])}}function k(e,i,n){"single"===r.mode&&o.resetSelection();var s,l=R().find(e,i);l&&!Array.isArray(l)&&(l=[l]);for(var c=0;c<l.length;c++)(s=t.find('.ogx_dynamic_list_item[data-ogx-id="'+l[c][a]+'"]:first'))&&(n?(s.addClass("ogx_dynamic_list_selected_item"),d.push(l[c])):s.removeClass("ogx_dynamic_list_selected_item"));return"single"===r.mode&&l.length?l[0]:l}function P(e,i){var n,s,l=R();if((n=t.find(".ogx_dynamic_list_item:eq("+e+")")).length>0){if(r.mode===OGX.DynamicList.SELECT_MODE_SINGLE&&o.resetSelection(),s=l[e],i)n.addClass("ogx_dynamic_list_selected_item"),d.push(l[e]);else{n.removeClass("ogx_dynamic_list_selected_item");var c=n.data("ogx-id");r.key||(c=String(c)),d.findDelete(a,c,1)}return s}return!1}function R(){return n?i:r.list}function W(){for(var e=0;e<r.list.length;e++)r.list[e][a]=String(c),c++}function z(e){for(var t=0;t<e.length;t++)delete e[t][a];return e}this._NAME_=OGX.DynamicList.NAME,this.el=null,this.enable=function(){return r.mode!==OGX.DynamicList.STATIC&&(this.touch.enable(),O(!0),(r.reorder||r.swipe)&&(b(!0),r.swipe&&S(!0)),!0)},this.disable=function(){return r.mode!==OGX.DynamicList.STATIC&&(this.touch.disable(),O(!1),(r.reorder||r.swipe)&&(b(!1),r.swipe&&S(!1)),!0)},this.bindFilter=function(e,t,a){void 0!==a&&(r.list.removeFilter(e),r.list.addFilter(e,t,a)),r.list.getFilters()&&(i=r.list.filter(),n=!0),setTimeout(x,0)},this.unbindFilter=function(e){r.list.removeFilter(e),i=r.list.filter(),n=!0,setTimeout(x,0)},this.bindValue=function(){return this.getSelection()},this.destroy=function(){this.clearBinds(),t.empty(),t.removeClass("ogx_dynamic_list")},this.val=function(e,t){if(void 0===e){if(!r.key){var i=JSON.parse(JSON.stringify(r.list));return z(OGX.List(i))}return r.list}var n;void 0===t&&(t=!1),e.hasOwnProperty("insert")||(e=new OGX.List(e)),t||(n=r.list.getFilters()),r.list=e,r.key||(c=1,a="__id__",W()),!t&&Object.keys(n).length?(r.list.setFilters(n),setTimeout(this.filter,0)):setTimeout(x,0)},this.getFilteredList=function(){if(n){if(!r.key){var e=JSON.parse(JSON.stringify(i));return z(OGX.List(e))}return i}return!1},this.display=function(e){return void 0===e?r.display:r.display.val(e)},this.mode=function(e){return void 0===e?r.mode:(r.mode=e,!0)},this.order=function(e,t){return r.list.order(e,t),setTimeout(x,0),!0},this.filter=function(){return i=r.list.filter(),n=!0,setTimeout(x,0),i},this.unfilter=function(){return n=!1,setTimeout(x,0),!0},this.addFilter=function(e,t,i){return r.list.addFilter(e,t,i)},this.removeFilter=function(e,t,i){return r.list.removeFilter(e,t,i)},this.resetFilters=function(){return r.list.resetFilters()},this.getFilters=function(){return r.list.getFilters()},this.insert=function(e,o){if(!Array.isArray(e)){r.key||(e[a]=c++);var s=!1,l=!0;if(n){var d=new OGX.List(e);d.setFilters(r.list.getFilters()),0===d.filter().length?l=!1:i.push(e)}var u='<div class="ogx_dynamic_list_item '+p.css(e)+'" data-ogx-id='+e[a]+"></div>",h=p.oml('.ogx_dynamic_list[data-ogx-id="'+this.id+'"] .ogx_dynamic_list_item[data-ogx-id="'+e[a]+'"]',e,r.as);if(void 0===o)r.list.push(e),l&&t.append(u);else if(r.list.insert(e,o),l&&(n?s=(i=r.list.filter()).findIndex(a,e[a]):0===o?t.prepend(u):s=r.list.findIndex(a,e[a]),s)){var _=t.children(".ogx_dynamic_list_item:nth-child("+(s.index+1)+")");_.length>0?_.before(u):t.append(u)}return this.parse(h),r.trigger&&t.trigger(OGX.DynamicList.RENDER),l}for(var f=0;f<__items.length;f++)void 0!==o?this.insert(__items[f],o+f):this.insert(__items[f])},this.delete=function(e){var n=R().delete(e);if(n){r.list.findDelete("_id",n[a],1),i.findDelete("_id",n[a],1);var o=t.children(".ogx_dynamic_list_item:eq("+e+")");return this.remove(n[a]),o.remove(),!0}return!1},this.deleteSelection=function(){for(var e=0;e<d.length;e++)r.list.findDelete(a,d[e][a],1),n&&i.findDelete(a,d[e][a],1),this.remove(d[e][a]),t.children(".ogx_dynamic_list_selected_item").remove();return!0},this.findDelete=function(e,o,s){void 0===s&&1===arguments.length&&(o=e,e=a);var l,d,c=r.list.findDelete(e,o,s);c&&!Array.isArray(c)&&(c=[c]);for(var u=0;u<c.length;u++)n&&i.findDelete(e,o,s),d=(l=t.children('.ogx_dynamic_list_item[data-ogx-id="'+c[u][a]+'"]:first')).next(".ogx_dynamic_list_swiper_back_item:first"),l.remove(),this.remove(c[u][a]),N(d);return c},this.findIndex=function(e,i){var n=arguments.length;1===n&&(i=e,e=a);var o=r.list.find(e,i,1);return o?t.children('.ogx_dynamic_list_item[data-ogx-id="'+o[a]+'"]').index():-1},this.findReplace=function(e,o,s){var l=arguments.length;2===l&&(s=o,o=e,e=a),r.key||(s[a]=c++);var d=r.list.findReplace(e,o,s,1);if(d){n&&i.findReplace(e,o,s,1);var u=t.children('.ogx_dynamic_list_item[data-ogx-id="'+d[a]+'"]:first');return u.length&&(u.attr("data-ogx-id",s[a]),y(u,a,s),r.trigger&&t.trigger(OGX.DynamicList.RENDER)),!0}return!1},this.select=function(e,t){return k(e,t,!0)},this.selectIndex=function(e){return P(e,!0)},this.unselect=function(e,t){return k(e,t,!1)},this.unselectIndex=function(e){return P(e,!1)},this.resetSelection=function(){d=new OGX.List,t.children(".ogx_dynamic_list_selected_item").removeClass("ogx_dynamic_list_selected_item")},this.getSelection=function(e){return void 0===e&&(e=!1),e?t.children(".ogx_dynamic_list_selected_item"):r.key?d:z(JSON.parse(JSON.stringify(d)))},this.getElement=function(e,i){var n=arguments.length;1===n&&(i=e,e=a);var o=r.list.find(e,i,1);return!!o&&t.children('.ogx_dynamic_list_item[data-ogx-id="'+o[a]+'"]')[0]},this.findUpdate=function(e,o,s,l,d,c){var u;"number"==typeof l&&(c=d,Array.prototype.unshift.call(arguments,a)),void 0===c&&(c=!0);var h=r.list.findUpdate.apply(r.list,arguments);if(h&&!Array.isArray(h)&&(h=[h]),h.length&&c){n&&i.findUpdate.apply(i,arguments);for(var _=0;_<h.length;_++)(u=t.children('.ogx_dynamic_list_item[data-ogx-id="'+h[_][a]+'"]:first')).length&&(y(u,a,h[_]),r.trigger&&t.trigger(OGX.DynamicList.RENDER));return h.length}return!1},this.refresh=function(e,i,n){var o=arguments.length;void 0!==n&&o--,1===o&&(i=e,e=a);var s=r.list.find(e,i,n);if(s&&s.length){for(var l,d=0;d<s.length;d++)(l=t.children('.ogx_dynamic_list_item[data-ogx-id="'+s[d][a]+'"]')).length>0&&y(l,a,s[d]);return!0}return!1},this.restore=function(e,i){var n=arguments.length;1===n&&(i=e,e=a);var o=r.list.find(e,i,1),s=t.children('.ogx_dynamic_list_item[data-ogx-id="'+o[a]+'"]');s.addClass("ogx_dynamic_list_swiper_trans_item_restore"),s.css({transform:"translateX(0px)","z-index":r.zindex+1}),setTimeout((function(){s.next(".ogx_dynamic_list_swiper_back_item:first").remove()}),200)},this.clear=function(){t.empty()},this.reset=function(){t.empty(),n=!1,r.list=new OGX.List,d=new OGX.List,i=new OGX.List},this.render=function(){setTimeout(x,0)},r||(r={}),OGX.Data.merge(r,s),r.list.hasOwnProperty("_NAME_")||(r.list=new OGX.List(r.list)),!r.key&&r.list.length>0?(a="__id__",W()):a=r.key,r.swipe&&("object"!=typeof r.swipe&&(r.swipe={}),OGX.Data.merge(r.swipe,l)),o.el=t=$(r.el),t.addClass("ogx_dynamic_list"),o.val(r.list),m=!0,o.blured||O(!0),t.trigger(OGX.DynamicList.READY),r.scroll&&(v=o.find(OGX.Scroller.NAME,r.id+"_scroller"))},OGX.DynamicList.NAME="DynamicList",OGX.DynamicList.HOLD="DynamicListHold",OGX.DynamicList.RELEASE="DynamicListRelease",OGX.DynamicList.DROP="DynamicListDrop",OGX.DynamicList.SELECT="DynamicListSelect",OGX.DynamicList.DELETE="DynamicListDelete",OGX.DynamicList.SIDED="DynamicListSided",OGX.DynamicList.BACK_HIT="DynamicListBackHit",OGX.DynamicList.UNSELECT="DynamicListUnselect",OGX.DynamicList.RENDER="DynamicListRender",OGX.DynamicList.SELECT_MODE_SINGLE="single",OGX.DynamicList.SELECT_MODE_TOGGLE="toggle",OGX.DynamicList.SELECT_MODE_MULTI="multi",OGX.DynamicList.SELECT_MODE_HIT="hit",OGX.DynamicList.STATIC="static",OGX.DynamicList.SWIPE_LEFT="DynamicListSwipeLeft",OGX.DynamicList.SWIPE_RIGHT="DynamicListSwipeRight",OGX.DynamicList.SWIPE_MODE_DELETE="DynamicListSwipeModeDelete",OGX.DynamicList.SWIPE_MODE_SIDE="DynamicListSwipeModeSide",OGX.DynamicList.SWIPE_MODE_CUSTOM="DynamicListSwipeModeCustom",OGX.DynamicList.READY="DynamicListReady",OGX.DynamicList.BIND=OGX.DynamicList.SELECT+" "+OGX.DynamicList.UNSELECT,OGX.Form=function(){"use strict";var that=this,form_default={el:!1,allowed:!1,forbidden:!1,change_cb:!1,submit_cb:!1,validate:!1,elem_types:["input","textarea"],wait:1e3,fields:{}},field_default={el:!1,allowed:/^[a-z0-9\\!\\.\\?\\#\\@\\$\\:\\(\\)\\/_,;%'" \\-]$/gi,forbidden:!1,pattern:!1,validate:!1,mask:!1,mask_char:"%",paste:!0,autocomplete:null,multiline:!1,input_cb:!1,change_cb:!1,val:null,changing:!1,wait:2e3,intv:!1,max:2500,type:"string",params:null},binds=new OGX.List,restricts=new OGX.List;function bindForm(e){for(var t,i,n={el:e.el,config:e,form:$(e.el),fields:new OGX.List,val:""},a=0;a<e.elem_types.length;a++)n.form.find(e.elem_types[a]).each((function(o,r){r.hasAttribute("name")&&(i=r.getAttribute("name"),t=OGX.Data.clone(field_default),OGX.Data.merge(t,e,!0,!1,!0),e.fields.hasOwnProperty(i)&&(t=OGX.Data.merge(t,e.fields[i],!0)),t.el=e.el+" "+e.elem_types[a]+'[name="'+i+'"]',t.change_cb=onFormChange,t.params=e.el,bindField(t),n.fields.insert({el:t.el}))}));n.form.on("submit",(function(e){e.preventDefault(),e.stopImmediatePropagation();var t={obj:formToObject(n.el),form:n.el};if(n.config.validate){var i=that.validateForm(n.el);!0===i?t.valid=!0:(t.valid=!1,t.error=i)}n.config.submit_cb?n.config.submit_cb(t):n.form.trigger("submit",t)})),binds.insert(n)}function onFormChange(e,t){var i,n=binds.find("el",t,1);if(n&&n.config.change_cb){for(var a in n.fields)if(n.fields[a].intv)return;var o=formToObject(n.form);for(var r in o)n.config.fields.hasOwnProperty(r)&&n.config.fields[r].hasOwnProperty("type")?o[r]=typeVal(n.config.fields[r].type,o[r]):n.config.hasOwnProperty("type")&&(o[r]=typeVal(n.config.type,o[r]));if(i=JSON.stringify(o),n.val!==i){var s;if(n.val=i,n.config.validate){s={obj:o,form:t,valid:!1};var l=that.validateForm(n.form);!0===l?s.valid=!0:(s.valid=!1,s.error=l)}else s=o;n.config.change_cb(s)}}}function bindField(e){var t={el:e.el,config:e,field:$(e.el),intv:!1};t.name=t.field.attr("name"),t.val=t.field.val(),t.field.val(t.val),e.pattern&&t.field.attr("pattern",e.pattern),binds.insert(t),$(document).on("input change",t.el,(function(){var e=$(this).val();if(e!==t.val){if(t.config.input_cb){var i={value:null,obj:{},el:null};e=typeVal(t.config.type,e),i.el=t.field[0],i.value=e,i.property=name,i.obj[name]=e,t.config.input_cb(i,t.config.params)}t.intv||(t.intv=setInterval((function(){checkField(t)}),50))}})),e.multiline||$(document).on("keydown",t.el,(function(e){if(8!==e.which&&13!==e.which&&void 0!==e.key&&1===e.key.length){var i=$(this).val(),n=e.key;if(13!==e.which&&t.config.mask){if(i.length>=t.config.mask.length)return e.preventDefault(),e.stopImmediatePropagation(),!1;for(var a=t.config.mask,o=0;o<i.length;o++)t.config.mask.substr(o,1)===t.config.mask_char&&(a=a.replace(t.config.mask_char,i.substr(o,1)));var r=a.indexOf(t.config.mask_char),s=!1;return r+1<a.length+1&&(s=a.substr(r+1,1)),-1!==r&&(n===t.config.mask.substr(a.indexOf(t.config.mask_char)-1,1)?a=a.substr(0,a.indexOf(t.config.mask_char)-1):(a=a.substr(0,a.indexOf(t.config.mask_char)),s&&s!==t.config.mask_char&&setTimeout((function(){t.field.val(a+n+s)}),0))),void t.field.val(a)}}if(13===e.which){e.preventDefault(),e.stopImmediatePropagation();i=$(this).val();if(t.intv&&(clearInterval(t.intv),t.intv=null),t.config.change_cb){var l={value:null,obj:{},el:null};i=typeVal(t.config.type,i),l.el=t.field[0],l.property=t.name,l.value=i,l.obj[t.name]=i,t.config.validate&&(l.valid=t.field[0].checkValidity()),t.config.change_cb(l,t.config.params)}else t.field.trigger("change",i)}})),(t.config.allowed||t.config.forbidden)&&that.restrictField(t.config)}function typeVal(e,t){switch(e){case"string":return String(t);case"number":return Number(t);case"int":return parseInt(t);case"bool":return"true"===t||1===t}}function restrictField(e){var t={el:e.el,config:e,field:$(e.el),keys:[],content:null},i=[8,9];if(null===e.autocomplete&&t.field[0].hasAttribute("autocomplete")&&"on"===t.field.attr("autocomplete")?e.autocomplete=!0:e.autocomplete=!1,e.autocomplete||t.keys.push(229),(e.autocomplete||e.paste)&&e.hasOwnProperty("allowed")&&e.allowed){var n=e.allowed.toString(),a=n.match(/\$\/([gi])+/),o="gi";a&&(n=n.replace(a[0],"+$"),o=a[1]),n=n.replace("/^","^"),e.allowed=new RegExp(n,o)}-1!==["input","texarea"].indexOf(t.field.get(0).tagName.toLowerCase())?t.content="val":t.content="html",t.config.multiline||t.keys.push(13),$(document).on("textInput keydown",t.el,(function(e){if("textInput"===e.type){var n=e.originalEvent.data;if(t.config.allowed&&!n.match(t.config.allowed))return e.preventDefault(),e.stopImmediatePropagation(),!1;if(t.config.forbidden&&n.match(t.config.forbidden))return e.preventDefault(),e.stopImmediatePropagation(),!1;if("keydown"===e.type){if(-1!==t.keys.indexOf(e.which))return e.preventDefault(),e.stopImmediatePropagation(),!1;if($(this)[t.content]().length>=t.config.max&&-1===e.which.indexOf(i))return e.preventDefault(),e.stopImmediatePropagation(),!1}}})),t.config.paste||$(document).on("paste",t.el,(function(e){e.preventDefault(),e.stopImmediatePropagation()})),restricts.insert(t)}function formToObject(e){return $(e).serializeArray().map(function(e){return this[e.name]=e.value,this}.bind({}))[0]}function checkField(e){var t=$(e.el).val();if(e.val!==t&&(e.val=t,e.config.changing=(new Date).getTime()),e.config.changing&&(new Date).getTime()>e.config.wait+e.config.changing&&(clearInterval(e.intv),e.intv=!1,e.config.change_cb)){var i={value:null,obj:{},el:null};t=typeVal(e.config.type,t),i.el=e.field[0],i.property=e.name,i.value=t,i.obj[i.property]=t,e.config.validate&&(i.valid=i.el.checkValidity()),e.config.change_cb(i,e.config.params)}}this.bindForm=function(e){return OGX.Data.merge(e,form_default),bindForm(e),!0},this.unbindForm=function(e){var t=binds.find("el",e,1);if(t){for(var i in $(document).off("submit",t.el),t.fields)this.unbindField(t.fields[i].el);binds.findDelete("el",e,1)}},this.bindField=function(e){return OGX.Data.merge(e,field_default),bindField(e),!0},this.unbindField=function(e){var t=binds.find("el",e,1);t&&($(document).off("input change",t.el),t.config.multiline||$(document).off("keydown",t.el),t.intv&&clearInterval(t.intv),restricts.find("el",t.el,1)&&this.unrestrictField(t.el),binds.findDelete("el",t.el,1))},this.restrictField=function(e){return restrictField(e),!0},this.unrestrictField=function(e){var t=restricts.find("el",e,1);return!!t&&($(document).off("textInput keydown",t.el),t.config.paste||$(document).off("paste",t.el),restricts.findDelete("el",e,1),!0)},this.formToObj=function(e){return formToObject(e)},this.populateForm=function(__form,__data){var form=$(__form),name,el,val;form.find("*[name]").each((function(__idx,__el){name=__el.getAttribute("name"),val=!1;try{val=eval("__data."+name)}catch(e){}val&&(el=$(__el),el.val(val),__el.hasAttribute("type")&&"hidden"===el.attr("type")&&el.trigger("change"))}))},this.validateForm=function(e){for(var t,i,n,a=$(e),o={},r=!0,s=form_default.elem_types,l=0,d=0,c=0;c<s.length;c++)a.find(s[c]).each((function(e,a){"submit"!==(t=$(a)).attr("type")&&(d++,(n=t.val()).length||l++,a.hasAttribute("pattern")?(i=t.attr("pattern"))&&(a.hasAttribute("required")||n.length)&&(!(i=new RegExp(i,"g")).test(n)||!n.length&&a.hasAttribute("required"))&&(o[t.attr("name")]=!1,r=!1):!n.length&&a.hasAttribute("required")&&(o[t.attr("name")]=!1,r=!1))}));return d===l&&(r=!1),!!r||o}},OGX.Form=new OGX.Form,OGX.Geo=function(e){"use strict";var t=this;void 0===e&&(e={});var i,n,a,o={map:null,markers:[],icon:"",browser_loc:null},r=e;function s(e,i){for(var n,a={},o=0;o<e.length;o++){n=!1;for(var r=0;r<i.length;r++){for(var s=0;s<i[r].address_components.length;s++)if(-1!==i[r].address_components[s].types.indexOf(e[o][0])){a.hasOwnProperty(e[o][1])&&a[e[o][1]].length||(a[e[o][1]]=i[r].address_components[s].short_name),n=!0;break}if(n)break}}return a=t.clean(a)}function l(e){return e*(Math.PI/180)}function d(e){return Array.isArray(e)?new google.maps.LatLng(e[0],e[1]):"function"!=typeof e.lat?new google.maps.LatLng(e.lat,e.lng):e}function c(e){var t={gmap:new google.maps.LatLng(e.coords.latitude,e.coords.longitude),raw:{lat:e.coords.latitude,lng:e.coords.longitude}};a?(a(t),a=null):$(document).trigger(OGX.Geo.BROWSER_LOC_SUCCESS,t)}function u(e){$(document).trigger(OGX.Geo.BROWSER_LOC_ERROR,e)}this._NAME_=OGX.Geo.NAME,this.setMap=function(e){r.map=e,google.maps.event.addListenerOnce(r.map,"tilesloaded",(function(){$(document).trigger(OGX.Geo.MAP_LOADED)}))},this.getMap=function(){return r.map},this.getMapRadius=function(){return!!r.map&&function(){if(r.map){var e=r.map.getBounds(),t=e.getCenter(),i=e.getNorthEast(),n=t.lat()/57.2958,a=t.lng()/57.2958,o=i.lat()/57.2958,s=i.lng()/57.2958;return 3963*Math.acos(Math.sin(n)*Math.sin(o)+Math.cos(n)*Math.cos(o)*Math.cos(s-a))}return!1}()},this.getCurrentLocation=function(){return!!r.map&&(e=r.map.getCenter(),new google.maps.LatLng(e.lat(),e.lng()));var e},this.getBrowserLocation=function(e){a=void 0===e?null:e,navigator.geolocation.getCurrentPosition(c,u,{maximumAge:0,timeout:1e4,enableHighAccuracy:!0})},this.getDistance=function(e,t,i,n){var a=l(i-e),o=l(n-t),r=Math.sin(a/2)*Math.sin(a/2)+Math.cos(l(e))*Math.cos(l(i))*Math.sin(o/2)*Math.sin(o/2),s=6371*(2*Math.atan2(Math.sqrt(r),Math.sqrt(1-r)));return Math.round(1e3*s)/1e3},this.addressToLatLng=function(e,t,n){i.geocode({address:e},(function(e,i){i==google.maps.GeocoderStatus.OK?t(e[0].geometry.location,n):t(!1,n)}))},this.getCityBoundaries=function(e,t,n,a,o){i.geocode({address:e+", "+t+", "+n},(function(e,t){t==google.maps.GeocoderStatus.OK?a(e[0].geometry,o):a(!1,o)}))},this.latLngToZip=function(e,t,n){e=d(e),i.geocode({location:e},(function(e,i){if(i===google.maps.GeocoderStatus.OK){var n=s([["postal_code","zip"]],e);t(n)}}))},this.latLngToCountryStateCity=function(e,t,n){e=d(e),i.geocode({location:e},(function(e,i){if(i===google.maps.GeocoderStatus.OK){var a=s([["country","country"],["administrative_area_level_1","state"],["locality","city"],["administrative_area_level_2","city"]],e);t(a,n)}else t(!1,n)}))},this.partialAddressToCountryStateCity=function(e,t,n){i.geocode({address:e},(function(e,i){if(i===google.maps.GeocoderStatus.OK){var a=s([["country","country"],["administrative_area_level_1","state"],["locality","city"],["administrative_area_level_2","city"]],e);t(a,n)}else t(!1,n)}))},this.latLngToAddress=function(e,t,n){e=d(e),i.geocode({location:e},(function(e,i){if(i===google.maps.GeocoderStatus.OK){var a=s([["street_number","number"],["route","street"],["postal_code","zip"],["country","country"],["administrative_area_level_1","state"],["locality","city"],["administrative_area_level_2","city"]],e);e[0].hasOwnProperty("formatted_address")&&(a.formatted=e[0].formatted_address),t(a,n)}else t(!1,n)}))},this.partialAddressToAddress=function(e,t,n){i.geocode({address:e},(function(e,i){if(i===google.maps.GeocoderStatus.OK){var a=s([["street_number","number"],["route","street"],["postal_code","zip"],["country","country"],["administrative_area_level_1","state"],["locality","city"],["administrative_area_level_2","city"]],e);e[0].hasOwnProperty("formatted_address")&&(a.formatted=e[0].formatted_address),a.lat=e[0].geometry.location.lat(),a.lng=e[0].geometry.location.lng(),t(a,n)}else t(!1,n)}))},this.zipToAddress=function(e,t,i){this.partialAddressToAddress(e,t,i)},this.zipToLatLng=function(e,t,n){i.geocode({address:e},(function(e,i){if(i===google.maps.GeocoderStatus.OK){var a={};a.lat=e[0].geometry.location.lat(),a.lng=e[0].geometry.location.lng(),t(a,n)}else t(!1,n)}))},this.getRoute=function(e){var t={start:!1,end:!1,waypoints:!1,optimize:!0,mode:OGX.Geo.TRAVEL_MODE_CAR,callback:!1,params:!1};for(var i in t)e.hasOwnProperty(i)||(e[i]=t[i]);var n=new google.maps.DirectionsService,a={origin:e.start,destination:e.end,travelMode:e.mode};e.waypoints&&(a.waypoints=e.waypoints,e.optimize&&(a.optimizeWaypoints=!0)),n.route(a,(function(t,i){i===google.maps.DirectionsStatus.OK?e.callback(t,e.params):e.callback(!1,e.params)}))},this.calcRouteMinutes=function(e){for(var t=0,i=0;i<e.legs.length;i++)t+=e.legs[i].duration.value;return t=Math.round(t/60)},this.drawRoute=function(e){n||(n=new google.maps.DirectionsRenderer),n.setMap(r.map),n.setDirections(e)},this.clearMap=function(){r.map&&n&&n.setMap(null)},this.latLngToLoc=function(e,t){return new google.maps.LatLng(e,t)},this.clean=function(e,t){var i;if(void 0===t&&(t=!1),e.hasOwnProperty("city")&&e.hasOwnProperty("vicinity")&&-1!==e.vicinity.indexOf(",")&&(i=new RegExp(", ([a-z -']+)$","gi").exec(e.vicinity))&&i.length>1&&(e.city===i[1]?e.vicinity=e.vicinity.replace(i[0],""):e.city?e.city.length>i[1].length&&(e.city=i[1],e.vicinity=e.vicinity.replace(i[0],"")):e.city=i[1]),t)for(var n in e)-1===t.indexOf(n)&&delete e[n];return e},"undefined"!=typeof google&&void 0!==google.maps?(i=new google.maps.Geocoder,function(){for(var e in o)r.hasOwnProperty(e)||(r[e]=o[e])}(),r.map&&r.markers.length):$(document).trigger(OGX.Geo.ERROR_GMAP)},OGX.Geo.NAME="Geo",OGX.Geo.ERROR="GEO_error",OGX.Geo.ERROR_GMAP="GEO_GMAP_ERROR",OGX.Geo.TRAVEL_MODE_CAR="DRIVING",OGX.Geo.TRAVEL_MODE_TRANSIT="TRANSIT",OGX.Geo.TRAVEL_MODE_WALK="WALKING",OGX.Geo.TRAVEL_MODE_BIKE="BICYCLING",OGX.Geo.BROWSER_LOC_SUCCESS="GEO_BROWSER_LOC_SUCCESS",OGX.Geo.BROWSER_LOC_ERROR="GEO_BROWSER_LOC_ERROR",OGX.Geo.MAP_LOADED="GEO_MAP_LOADED",require("Ghost","Uxi"),OGX.Ghost=function(e){construct(this,"Ghost"),this.el=$(e.el),this._NAME_=OGX.Ghost.NAME,css="ogx_ghost",e.hasOwnProperty("css")&&(css+=" "+e.css),this.el.addClass(css),delete css},OGX.Ghost.NAME="Ghost",require("GridSwiper","Uxi","Touch"),OGX.GridSwiper=function(e){construct(this,"GridSwiper");var t,i,n,a,o,r,s,l,d,c,u,h,_=this,f=e,g={map:[[!0,!0,!0],[!0,!0,!0],[!0,!0,!0]],axis:{x:!0,y:!0},loop:!0,start:!1,chromeos:!1},p=!1,m={x:null,y:null},v={x:0,y:0},y=".ogx_grid_swiper_cell",x=!1,O=!1,b={x:0,y:0},w={x:0,y:0},G=(new Date).getTime()+Math.round(1e3*Math.random()),X=[];function E(e){e?t.on(_.touch.down,T):t.off(_.touch.down,T)}function T(e){p=!1,o=0,r=0,s=0,l=0,e=k(e),m.x=e.pageX,m.y=e.pageY,x=!0,S(!0)}function C(e){e?$("body").on(_.touch.up,D):$("body").off(_.touch.up,D)}function D(e){x&&(x=!1,S(!1),M())}function M(e,t,o){var r,s;void 0===e&&(e=0),void 0===t&&(t=0),void 0===o&&(o=!0),o&&Y(!0),i.addClass("ogx_grid_swiper_anim"),v=I(i),r=-1*Math.round((v.x+e)/n)*n*-1,s=-1*Math.round((v.y+t)/a)*a*-1,i.css({transform:"translate3d("+r+"px, "+s+"px, 0px)"})}function S(e){e?(N(!0),t.on(_.touch.move,L)):(N(!1),t.off(_.touch.move,L))}function L(e){e=k(e),o=0,r=0,s=0,l=0,p||(f.axis.x&&Math.abs(e.pageX-m.x)>Math.abs(e.pageY-m.y)?p="x":f.axis.y&&Math.abs(e.pageX-m.x)<Math.abs(e.pageY-m.y)&&(p="y")),p&&(f.axis.x&&"x"===p?(o=Math.abs(e.pageX-m.x),s=e.pageX-m.x>0?1:-1):f.axis.y&&"y"===p&&(r=Math.abs(e.pageY-m.y),l=e.pageY-m.y>0?1:-1))}function N(e){e?h||(O=!1,h=setInterval(A,10)):h&&(clearInterval(h),h=null)}function A(){if((o||r)&&(O||t.trigger(OGX.GridSwiper.SWIPE_START),O=!0),f.axis.x&&"x"===p&&o&&s&&o<=n){if(!f.loop&&(b.x+-1*s<0||b.x+-1*s>f.map[0].length-1))return;if((d=(b.x+-1*s)%f.map[0].length)<0&&(d=Math.abs(f.map[0].length+d)),!1===f.map[w.y][d])return;u=o*s,i.css({transform:"translate3d("+(-1*b.x*n+u)+"px, "+v.y+"px, 0px)"})}else if(f.axis.y&&"y"===p&&r&&l&&r<=a){if(!f.loop&&(b.y+-1*l<0||b.y+-1*l>f.map.length-1))return;if((c=(b.y+-1*l)%f.map.length)<0&&(c=Math.abs(f.map.length+c)),!1===f.map[c][w.x])return;u=r*l,i.css({transform:"translate3d("+v.x+"px, "+(-1*b.y*a+u)+"px, 0px)"})}}function Y(e){e?(i.off("transitionend"),i.on("transitionend",(function(){O&&(t.trigger(OGX.GridSwiper.SWIPE_END),O=!1),i.off("transitionend"),i.removeClass("ogx_grid_swiper_anim"),v=I(i);var e={x:null,y:null};e.x=-1*Math.round(v.x/n),e.y=-1*Math.round(v.y/a),b.x!==e.x?(s=b.x>e.x?1:-1,b.x=e.x,w.x=P(b).x,-1===s?(i.children(y+"[data-y="+(b.y-1)+"]").attr("data-x",b.x).css("left",b.x*n),i.children(y+"[data-y="+(b.y+1)+"]").attr("data-x",b.x).css("left",b.x*n),i.children(y+"[data-x="+(b.x-2)+"][data-y="+b.y+"]").attr("data-x",b.x+1).css("left",(b.x+1)*n),t.trigger(OGX.GridSwiper.SWIPE_LEFT,{cell:w,point:b}),R(X=[{x:b.x+1,y:b.y},{x:b.x,y:b.y-1},{x:b.x,y:b.y+1}]),z()):(i.children(y+"[data-y="+(b.y-1)+"]").attr("data-x",b.x).css("left",b.x*n),i.children(y+"[data-y="+(b.y+1)+"]").attr("data-x",b.x).css("left",b.x*n),i.children(y+"[data-x="+(b.x+2)+"][data-y="+b.y+"]").attr("data-x",b.x-1).css("left",(b.x-1)*n),t.trigger(OGX.GridSwiper.SWIPE_RIGHT,{cell:w,point:b}),R(X=[{x:b.x-1,y:b.y},{x:b.x,y:b.y-1},{x:b.x,y:b.y+1}]),z())):b.y!==e.y&&(l=b.y>e.y?1:-1,b.y=e.y,w.y=P(b).y,-1===l?(i.children(y+"[data-x="+(b.x-1)+"]").attr("data-y",b.y).css("top",b.y*a),i.children(y+"[data-x="+(b.x+1)+"]").attr("data-y",b.y).css("top",b.y*a),i.children(y+"[data-y="+(b.y-2)+"][data-x="+b.x+"]").attr("data-y",b.y+1).css("top",(b.y+1)*a),t.trigger(OGX.GridSwiper.SWIPE_UP,{cell:w,point:b}),R(X=[{x:b.x,y:b.y+1},{x:b.x-1,y:b.y},{x:b.x+1,y:b.y}]),z()):(i.children(y+"[data-x="+(b.x-1)+"]").attr("data-y",b.y).css("top",b.y*a),i.children(y+"[data-x="+(b.x+1)+"]").attr("data-y",b.y).css("top",b.y*a),i.children(y+"[data-y="+(b.y+2)+"][data-x="+b.x+"]").attr("data-y",b.y-1).css("top",(b.y-1)*a),t.trigger(OGX.GridSwiper.SWIPE_DOWN,{cell:w,point:b}),R(X=[{x:b.x,y:b.y-1},{x:b.x-1,y:b.y},{x:b.x+1,y:b.y}]),z())),p=0}))):i.off("transitionend")}function I(e,t){var i=e.css("transform");return"none"===i?0:(i=(i=(i=i.substr(7)).substr(0,i.length-1)).split(","),{x:Number(i[4]),y:Number(i[5])})}function k(e){return e.hasOwnProperty("originalEvent")&&void 0!==e.originalEvent.changedTouches?e.originalEvent.changedTouches[0]:e}function P(e){var t={x:0,y:0};return t.x=e.x%f.map[0].length,t.x<0&&(t.x=Math.abs(f.map[0].length+t.x)),t.y=e.y%f.map.length,t.y<0&&(t.y=Math.abs(f.map.length+t.y)),t}function R(e){for(var t,i={x:null,y:null},n=0;n<e.length;n++){if(e[n].y<0||e[n].y>f.map.length-1){if(!f.loop)return!1;i.y=P(e[n]).y}else i.y=e[n].y;if(e[n].x<0||e[n].x>f.map[0].length-1){if(!f.loop)return!1;i.x=P(e[n]).x}else i.x=e[n].x;t=f.map[i.y][i.x],W(e[n],t)}}function W(e,t){var n=!1;switch(typeof t){case"string":i.children(y+'[data-x="'+e.x+'"][data-y="'+e.y+'"]').children(y+"_content:first").html(t);break;case"function":(n=t(e,P(e),{x:e.x-b.x,y:e.y-b.y},i.children(y+'[data-x="'+e.x+'"][data-y="'+e.y+'"]').children(y+"_content:first")[0]))&&i.children(y+'[data-x="'+e.x+'"][data-y="'+e.y+'"]').children(y+"_content:first").html(n);break;case"object":var a='.ogx_grid_swiper[data-ogx-id="'+G+'"] > .ogx_grid_swiper_container > '+y+'[data-x="'+e.x+'"][data-y="'+e.y+'"] > '+y+"_content",o=P(e);for(var r in t){t[r].id="cell_"+o.x+"_"+o.y;break}t=OGX.OML.replaceNodeName(t,a);var s=_.nodes.find("id","cell_"+o.x+"_"+o.y,1);s&&_.remove(s._NAME_,s.id),$(a).empty(),OGX.OML.render(_,t,{abs:e,rel:P(e)}),z()}}function z(){for(var e=0;e<_.nodes.length;e++)_.nodes[e].id==="cell_"+w.x+"_"+w.y?_.nodes[e].focus():_.nodes[e].blur()}function H(){X=[],f.axis.x&&(X.push({x:f.start.x-1,y:f.start.y}),X.push({x:f.start.x+1,y:f.start.y})),X.push({x:f.start.x,y:f.start.y}),f.axis.y&&(X.push({x:f.start.x,y:f.start.y-1}),X.push({x:f.start.x,y:f.start.y+1})),R(X)}function U(){f.map.length||(f.map=[[]],f.axis.y=!1),f.map.length&&!Array.isArray(f.map[0])&&(f.map=[f.map],f.axis.y=!1),f.start||(f.start={x:null,y:null},f.start.y=Math.floor(f.map.length/2),f.start.x=Math.floor(f.map[0].length/2))}function F(){var e=f.start.x*-n,o=f.start.y*-a,r=f.start.y-1,s=f.start.x,l='<div class="ogx_grid_swiper_container" style="transform:translate3d('+e+"px, "+o+'px, 0px);">',d=-1*e,c=-1*o-a;f.axis.y&&(l+='<div class="ogx_grid_swiper_cell" style="left:'+d+"px; top:"+c+'px;" data-x="'+s+'" data-y="'+r+'"><div class="ogx_grid_swiper_cell_content"></div></div>',l+='<div class="ogx_grid_swiper_cell" style="left:'+d+"px; top:"+(c+2*a)+'px;" data-x="'+s+'" data-y="'+(r+2)+'"><div class="ogx_grid_swiper_cell_content"></div></div>'),l+='<div class="ogx_grid_swiper_cell" style="left:'+d+"px; top:"+(c+a)+'px;" data-x="'+s+'" data-y="'+(r+1)+'"><div class="ogx_grid_swiper_cell_content"></div></div>',f.axis.x&&(l+='<div class="ogx_grid_swiper_cell" style="left:'+(d-n)+"px; top:"+-1*o+'px;" data-x="'+(s-1)+'" data-y="'+f.start.y+'"><div class="ogx_grid_swiper_cell_content"></div></div>',l+='<div class="ogx_grid_swiper_cell" style="left:'+(d+n)+"px; top:"+-1*o+'px;" data-x="'+(s+1)+'" data-y="'+f.start.y+'"><div class="ogx_grid_swiper_cell_content"></div></div>'),l+="</div>",t.html(l),i=t.children(".ogx_grid_swiper_container:first"),b.x=f.start.x,b.y=f.start.y,v.x=e,v.y=o,w.x=f.start.x,w.y=f.start.y}this._NAME_=OGX.GridSwiper.NAME,this.el=null,this.enable=function(){E(!0),C(!0)},this.disable=function(){E(!1),C(!1),N(!1)},this.resize=function(){Y(!1),i.removeClass("ogx_grid_swiper_anim"),n=t.width(),a=t.height();var e=b.x*-n,o=b.y*-a;i.children(y+"[data-y="+(b.y-1)+"]").css({top:(b.y-1)*a,left:b.x*n}),i.children(y+"[data-y="+b.y+"]").css({top:b.y*a,left:b.x*n}),i.children(y+"[data-y="+(b.y+1)+"]").css({top:(b.y+1)*a,left:b.x*n}),i.children(y+"[data-x="+(b.x-1)+"]").css({top:b.y*a,left:(b.x-1)*n}),i.children(y+"[data-x="+(b.x+1)+"]").css({top:b.y*a,left:(b.x+1)*n}),i.css("transform","translate3d("+e+"px, "+o+"px, 0px"),S(!1),setTimeout((function(){M(0,0,!1),i.addClass("ogx_grid_swiper_anim")}),0)},this.setMap=function(e,t){f.map=e,void 0!==t&&(f.start=t),U(),F(),H()},this.setMapCell=function(e,t){f.map[e.y]||(f.map[e.y]=[]),f.map[e.y][e.x]=t},this.getMapCell=function(e){return e.y>0&&f.map.length<e.y&&e.x>0&&f.map[e.y].length<e.x&&f.map[e.y][e.x]},this.getCells=function(){var e,t,n,a,o=[];return i.children(y).each((function(i,r){e=$(r),t={x:Number(e.attr("data-x")),y:Number(e.attr("data-y"))},n=P(t),a={x:t.x-b.x,y:t.y-b.y},o.push({abs:t,rel:n,offset:a,element:r})})),o},this.getCellContent=function(e){return i.children(y+"[data-x="+e.x+"][data-y="+e.y+"]").children(y+"_content:first")[0]},this.getCurrentCell=function(){return w},this.renderCellContent=function(e){R([e])},this.setTopCell=function(e){this.setOffsetCell({x:0,y:-1},e)},this.setBottomCell=function(e){this.setOffsetCell({x:0,y:1},e)},this.setLeftCell=function(e){this.setOffsetCell({x:-1,y:0},e)},this.setRightCell=function(e){this.setOffsetCell({x:1,y:0},e)},this.setOffsetCell=function(e,t){var i={x:e.x+b.x,y:e.y+b.y};this.setMapCell(i,t)},this.getOffsetCell=function(e){var t={x:e.x+b.x,y:e.y+b.y};return this.getMapCell(t)},this.getOffsetCellContent=function(e){var t={x:e.x+b.x,y:e.y+b.y};return this.getCellContent(t)},this.swipeRight=function(){M(-n)},this.swipeLeft=function(){M(n)},this.swipeUp=function(){M(0,-a)},this.swipeDown=function(){M(0,a)},OGX.Data.merge(f,g),(t=$(f.el)).addClass("ogx_grid_swiper"),t.attr("data-ogx-id",G),n=t.width(),a=t.height(),U(),F(),H()},OGX.GridSwiper.NAME="GridSwiper",OGX.GridSwiper.SWIPE_LEFT="GridSwiperSwipeLeft",OGX.GridSwiper.SWIPE_RIGHT="GridSwiperSwipeRight",OGX.GridSwiper.SWIPE_UP="GridSwiperSwipeUp",OGX.GridSwiper.SWIPE_DOWN="GridSwiperSwipeDown",OGX.GridSwiper.SWIPE_START="GridSwiperSwipeStart",OGX.GridSwiper.SWIPE_END="GridSwiperSwipeEnd",require("GroupedList","Uxi","Bind","Touch"),OGX.GroupedList=function(e){construct(this,"GroupedList");var t,i,n,a,o,r=this,s=e,l={group_by:"name",group_mode:null,group_param:null,group_order:null,order:null,list:new OGX.List,key:null,swipe:!1,reorder:!1,display:!1,mode:OGX.DynamicList.SELECT_MODE_HIT,scope:["public"]},d=[];function c(e){e?t.on(r.touch.down,".ogx_grouped_list_item",u):t.off(r.touch.down,".ogx_grouped_list_item",u)}function u(){t.find(".ogx_grouped_list_selected_item").removeClass("ogx_grouped_list_selected_item"),$(this).addClass("ogx_grouped_list_selected_item");var e=s.list[Number($(this).data("id"))];t.trigger(OGX.GroupedList.SELECT,e)}function h(e){var t=s.group_order.indexOf(e);if(-1===t)return t;for(var i=t,n=0;n<t;n++)-1===d.indexOf(s.group_order[n])&&i--;return i}function _(e,t){for(var n,a=0;a<i.nodes.length;a++)if(n=i.nodes[a].val().find(e,t,1))return{list:i.nodes[a],item:n};return!1}function f(){var e=!1,t=!1;if(s.list&&(e=s.list,o&&(e=a),e.length&&(t=n,n=e.group(s.group_by,s.group_mode,s.group_param))),e&&e.length){if(JSON.stringify(t)!==JSON.stringify(n)){r.find(OGX.NestList.NAME,r.id+"_nests","remove");var l=function(){var e='.ogx_grouped_list[data-ogx-id="'+r.id+'"]',t={};t[e+":NestList"]={id:r.id+"_nests",list:[],"node:OML":[]};var i,a=[],o=OGX.Data.clone(s.group_order);for(var l in n)i=s.group_order?s.group_order.indexOf(l):a.length,d.push(l),t[e+":NestList"].list.push({title:l}),a[i]={"default:DynamicList":{list:n[l],key:s.key,mode:s.mode,display:s.display,swipe:s.swipe,reorder:s.reorder,order:s.order}};for(var c=0;c<a.length;c++)void 0===a[c]&&(a.splice(c,1),o.splice(c,1),c--);return t[e+":NestList"]["node:OML"]=a,t[e+":NestList"].order=o,t}();OGX.OML.render(r,l),i=r.find(OGX.NestList.NAME,r.id+"_nests")}}else n=!1,r.el.empty()}this._NAME_=OGX.GroupedList.NAME,this.el=null,this.enable=function(){c(!0)},this.disable=function(){c(!1)},this.bindFilter=function(e,t,i){s.list.removeFilter(e),void 0!==i&&s.list.addFilter(e,t,i),s.list.getFilters()&&(a=s.list.filter(),o=!0),setTimeout(f,0)},this.bindValue=function(){return this.getSelection()},this.destroy=function(){this.clearBinds()},this.scope=function(e){return void 0!==e?(s.scope=e,i.scope(e),!0):s.scope},this.val=function(e){if(void 0===e)return s.list;e.hasOwnProperty("insert")||(e=new OGX.List(e));var t=s.list.getFilters();"{}"!==JSON.stringify(t)&&(o=!0,e.setFilters(t),a=e.filter()),s.list=e,setTimeout(f,0)},this.nests=function(){return i||!1},this.filter=function(){return a=s.list.filter(),o=!0,setTimeout(f,0),!0},this.unfilter=function(){return o=!1,setTimeout(f,0),!0},this.addFilter=function(e,t,i){return s.list.addFilter(e,t,i)},this.removeFilter=function(e,t,i){return s.list.removeFilter(e,t,i)},this.resetFilters=function(){return s.list.resetFilters()},this.getFilters=function(){return s.list.getFilters()},this.addGroup=function(e,t,n){var a={title:e,scope:s.scope},o={};void 0===t&&(t=[]),o["default:DynamicList"]={list:t,key:s.key,mode:s.mode,display:s.display,swipe:s.swipe,reorder:s.reorder},i.addNest(a,o,n),s.group_order.insert(e,n),s.list=s.list.concat(t),d.push(e)},this.removeGroup=function(e){return!!this.getGroupList(e)&&(i.removeNest(e),s.list.findDelete(s.group_by,e),d.splice(d.indexOf(e),1),!0)},this.addToGroup=function(e,t){var n=this.getGroupList(e);n&&(n.insert(t),s.list.push(t),setTimeout((function(){i.updateNestHeight(e)}),0))},this.removeFromGroup=function(e,t,n){2===arguments.length&&(n=t,t=s.key);var a=this.getGroupList(e);a&&(a.findDelete(t,n,1),s.list.findDelete(t,n,1),a.val().length?setTimeout((function(){i.updateNestHeight(e)}),0):this.removeGroup(e))},this.updateGroupItem=function(e,t,i,n){this.getGroupList(e).findUpdate(t,i,n,!1,1),s.list.findUpdate(t,i,n,1)},this.replaceGroupItem=function(e,t,i,n){this.getGroupList(e).findReplace(t,i,n),s.list.findReplace(t,i,n,1)},this.getGroupList=function(e){var t=h(e);return-1!==t&&t<i.nodes.length&&i.nodes[t]},this.hasGroup=function(e){return-1!==d.indexOf(e)},this.addItem=function(e){var t=e[s.group_by];if(this.hasGroup(t))this.addToGroup(t,e);else{var n=-1;-1!==s.group_order.indexOf(t)&&(n=h(t)),-1!==n?this.addGroup(t,[e],n):this.addGroup(t,[e])}setTimeout((function(){i.updateNestHeight(t)}),0)},this.removeItem=function(e,t){s.key&&1===arguments.length&&(t=e,e=s.key);var n=s.list.find(e,t,1);if(n){var a=n[s.group_by];return this.removeFromGroup(a,e,t),setTimeout((function(){i.updateNestHeight(a)}),0),!0}return!1},this.replaceItem=function(e,t,n){s.key&&2===arguments.length&&(t=e,e=s.key);var a=_(e,t);if(a){var o=null;return a.item[s.group_by]!==n[s.group_by]?(o=a.item[s.group_by],a.list.findDelete(e,t,1),s.list.findDelete(e,t,1),-1===s.list.unique("status").indexOf(o)&&(this.removeGroup(o),o=!1),this.addItem(n),setTimeout((function(){o&&i.updateNestHeight(a.item[s.group_by]),i.updateNestHeight(n[s.group_by])}),0)):a.list.findReplace(e,t,n),!0}return!1},this.updateItem=function(e,t,i,n){if(s.key){var a=arguments.length;void 0!==n&&a--,2===a&&(i=t,t=e,e=s.key)}var o=_(e,t);if(o){if(i.hasOwnProperty(s.group_by)&&o.item[s.group_by]!==i[s.group_by]){o.list.findDelete(e,t,1);var r=s.list.findUpdate(e,t,1);r=OGX.Data.merge(r,i,!0,!1,n),this.addItem(r)}else o.list.findUpdate(e,t,i,n,1);return!0}return!1},this.render=function(){return setTimeout(f,0),!0},this.refresh=function(){var e=t.find(".ogx_grouped_list_selected_item:first");if(e.length>0){var i=e.data("id");e.html(OGX.Templater.templatize(s.template,s.list[i]))}},OGX.Data.merge(s,l),s.list.hasOwnProperty("insert")||(s.list=new OGX.List(s.list)),s.group_order&&!s.group_order.hasOwnProperty("insert")&&(s.group_order=new OGX.List(s.group_order)),s.display&&s.display.hasOwnProperty("css")&&("object"!=typeof s.display.css&&s.display.css?s.display.css+=" ogx_grouped_list_item":s.display.hasOwnProperty("add")?s.display.add="ogx_grouped_list_item "+s.display.add:s.display.add="ogx_grouped_list_item"),n=!1,r.el=t=$(s.el),t.addClass("ogx_grouped_list"),f()},OGX.GroupedList.NAME="GroupedList",OGX.GroupedList.SELECT="GroupedListSelect",OGX.GroupedList.BIND=OGX.GroupedList.SELECT,require("Html","Uxi"),OGX.Html=function(e){construct(this,"Html"),this._NAME_=OGX.Html.NAME,void 0!==e&&e&&(this.el=$(e.el),e.scroll?setTimeout((function(){OGX.HtmlRender(e)}),0):OGX.HtmlRender(e))},OGX.HtmlRender=function(e){var t=$(e.el),i=new OGX.Display(e);data=!1,e.data&&Object.keys(e.data).length&&(data=e.data),t.html(i.html(data)),e.css&&t.addClass(i.css(data)),e.hasOwnProperty("id")&&e.id&&"#"===e.id.substr(0,1)&&t.attr("id",e.id.substr(1))},OGX.Html.NAME="Html",require("Iceberg","Uxi","Touch"),OGX.Iceberg=function(e){construct(this,"Iceberg");var t,i,n,a,o=this,r={left:0,right:0,top:0,bottom:0,min:50,drag:!0,flatten:!1,"node:OML":{}},s=e,l=!1,d="normal",c="main",u={left:null,main:null,right:null,top:null,bottom:null},h=[0,0,0],_=0,f=0,g=0,p=0;function m(e){for(var t in u)u[t]&&u[t].instance&&(e===t?u[t].instance.focus():u[t].instance.blur())}function v(){l.hasClass("ogx_iceberg_anim")||(l.off("transitionend"),h=b(l))}function y(e){var t=0;return e.dirY&&e.distY>e.distX&&(t=1),t}function x(e){s.drag&&e.dist&&((n=y(e))||-1===["main","left","right"].indexOf(c)?-1!==["main","top","bottom"].indexOf(c)&&e.dirY&&e.distY&&(i=h[1]+e.distY*e.dirY)<=p&&i>=g&&l.css({transform:"translate3d(0, "+i+"px, 0)"}):e.dirX&&e.distX&&(t=h[0]+e.distX*e.dirX)<=f&&t>=_&&l.css({transform:"translate3d("+t+"px, 0, 0)"}))}function O(e){if(t=0,i=0,n=y(e),e.swipe&&e.dist){var o;switch(e.swipe=!1,c){case"main":-1===e.dirX&&s.right&&!n?(t=-u.right.outerWidth(),o="right",e.swipe=!0):1===e.dirX&&s.left&&!n?(t=u.left.outerWidth(),o="left",e.swipe=!0):1===e.dirY&&s.top&&n?(i=u.top.outerHeight(),o="top",e.swipe=!0):-1===e.dirY&&s.bottom&&n&&(i=-u.bottom.outerHeight(),o="bottom",e.swipe=!0);break;case"left":-1!==e.dirX||n||(t=0,o="main",e.swipe=!0);break;case"right":1!==e.dirX||n||(t=0,o="main",e.swipe=!0);break;case"top":-1===e.dirY&&n&&(i=0,o="main",e.swipe=!0);break;case"bottom":1===e.dirY&&n&&(i=0,o="main",e.swipe=!0)}a=n?1===e.dirY?OGX.Iceberg.SWIPE_DOWN:OGX.Iceberg.SWIPE_UP:1===e.dirX?OGX.Iceberg.SWIPE_RIGHT:OGX.Iceberg.SWIPE_LEFT,e.swipe&&e.dist&&(l.addClass("ogx_iceberg_anim"),l.on("transitionend",(function(){l.off("transitionend"),l.removeClass("ogx_iceberg_anim"),h=b(l),m(c=o),l.trigger(a,c)})),l.css({transform:"translate3d("+t+"px, "+i+"px, 0)"}))}else if(e.dist){switch(t=0,i=0,c){case"left":t=u.left.outerWidth();break;case"right":t=-u.right.outerWidth();break;case"top":i=u.top.outerHeight();break;case"bottom":i=-u.bottom.outerHeight()}l.addClass("ogx_iceberg_anim"),l.on("transitionend",(function(){l.off("transitionend"),l.removeClass("ogx_iceberg_anim"),h=b(l),l.trigger(OGX.Iceberg.RESTORE,c)})),l.css({transform:"translate3d("+t+"px, "+i+"px, 0)"})}}function b(e){var t=e[0].style.transform;if(t=t.match(/translate3d\(([0-9px%,\.\- ]+)\)/)){t=t[1].split(",");for(var i=0;i<t.length;i++)t[i]=Number(t[i].split("px")[0]);return t}return[0,0,0]}function w(){var e;for(var t in u)u[t]&&((e=u[t].children(":first")).length&&e[0].hasAttribute("data-ogx-id")?u[t].instance=o.nodes.find("id",String(e.data("ogx-id")),1):u[t].instance=!1)}this._NAME_=OGX.Iceberg.NAME,this.el=null,this.show=function(e,t){if(void 0===e&&(e=!1),"normal"===d)for(var i in u)if(u[i]&&u[i].instance&&u[i].instance.id===t){if(!e)return this.val(i),!0;if(u[i].instance._NAME_===u[i].instance.NAME)return this.val(i),!0}return!1},this.val=function(e){if(void 0===e)return c;if(t=0,i=0,"normal"===d){switch(e){case"left":t=u.left.outerWidth();break;case"top":i=u.top.outerHeight();break;case"main":t=0;break;case"right":t=u.left.outerWidth();break;case"bottom":i=-u.bottom.outerHeight()}u[c].instance&&u[c].instance.blur(),u[c=e].instance&&u[c].instance.focus(),l.css({transform:"translate3d("+t+"px, "+i+"px, 0)"})}},this.enable=function(){"flattened"!==d&&(this.touch.swipe.enable(),setTimeout((function(){m(c)}),0))},this.disable=function(){this.touch.swipe.disable()},this.resize=function(){u.left&&(f=u.left.outerWidth()),u.right&&(_=-u.right.outerWidth()),u.top&&(p=u.top.outerHeight()),u.bottom&&(g=-u.bottom.outerHeight()),s.flatten&&("flattened"!==d&&this.el.outerWidth()>=s.flatten?(d="flattened",h=b(l),l.addClass("ogx_iceberg_views_flattened").css("transform","translate3d(0px, 0px, 0px)"),l.children(".ogx_iceberg_view").addClass("ogx_iceberg_view_flattened"),this.disable()):"flattened"===d&&this.el.width()<s.flatten&&(d="normal",l.children(".ogx_iceberg_view").removeClass("ogx_iceberg_view_flattened"),l.removeClass("ogx_iceberg_views_flattened").css("transform","translate3d("+h[0]+"px, 0px, 0px)"),this.enable()))},OGX.Data.merge(s,r),width=Math.round($(s.el).innerWidth()),height=$(s.el).innerHeight(),o.el=$(s.el),o.el.addClass("ogx_iceberg"),function(){var e,t,i='<div class="ogx_iceberg_views ogx_hw">',n={},a='.ogx_iceberg[data-ogx-id="'+o.id+'"] > .ogx_iceberg_views > .ogx_iceberg_view[data-ogx-panel-id="';for(var r in s["node:OML"])for(var d in s["node:OML"][r])0===d.indexOf("left")&&(i+='<div class="ogx_iceberg_view_left ogx_view ogx_iceberg_view" data-ogx-panel-id="left" style="width:'+(isNaN(s.left)?s.left:s.left+"px")+';"></div>',n.left=a+'left"]',u.left=!0),0===d.indexOf("top")&&(i+='<div class="ogx_iceberg_view_top ogx_view ogx_iceberg_view" data-ogx-panel-id="top" style="height:'+(isNaN(s.top)?s.top:s.top+"px")+';"></div>',n.top=a+'top"]',u.top=!0),0===d.indexOf("main")&&(i+='<div class="ogx_iceberg_view_main ogx_view ogx_iceberg_view" data-ogx-panel-id="main"></div>',n.main=a+'main"]'),0===d.indexOf("right")&&(i+='<div class="ogx_iceberg_view_right ogx_view ogx_iceberg_view" data-ogx-panel-id="right" style="width:'+(isNaN(s.right)?s.right:s.right+"px")+';"></div>',n.right=a+'right"]',u.right=!0),0===d.indexOf("bottom")&&(i+='<div class="ogx_iceberg_view_bottom ogx_view ogx_iceberg_view" data-ogx-panel-id="bottom" style="height:'+(isNaN(s.bottom)?s.bottom:s.bottom+"px")+';"></div>',n.bottom=a+'bottom"]',u.bottom=!0);for(o.el.html(i),r=0;r<s["node:OML"].length;r++)for(var d in s["node:OML"][r])e=d.split(":")[0],t=d.replace(e,n[e]),s["node:OML"][r][t]=s["node:OML"][r][d],delete s["node:OML"][r][d];l=o.el.children(".ogx_iceberg_views:first"),u.left&&(u.left=l.children(".ogx_iceberg_view_left:first"),f=u.left.outerWidth()),u.top&&(u.top=l.children(".ogx_iceberg_view_top:first"),p=u.top.outerHeight()),u.main=l.children(".ogx_iceberg_view_main:first"),u.right&&(u.right=l.children(".ogx_iceberg_view_right:first"),_=-u.right.outerWidth()),u.bottom&&(u.bottom=l.children(".ogx_iceberg_view_bottom:first"),g=-u.bottom.outerHeight())}(),setTimeout(w,0),o.touch.swipe.set({x:!0,y:!0,min_x:s.min,min_y:s.min,cb_down:v,cb_swipe:x,cb_up:O}),o.resize()},OGX.Iceberg.NAME="Iceberg",OGX.Iceberg.SHOW="icebergShow",OGX.Iceberg.SWIPE_UP="icebergSwipeUp",OGX.Iceberg.SWIPE_DOWN="icebergSwipeDown",OGX.Iceberg.SWIPE_LEFT="icebergSwipeLeft",OGX.Iceberg.SWIPE_RIGHT="icebergSwipeRight",OGX.Iceberg.RESTORE="icebergRestore",OGX.Loading=function(e){"use strict";var t=this,i=!1,n={display:{css:"ogx_loading",html:" ",anim:OGX.Overlay.FADE}};e.hasOwnProperty("loading")&&e.loading&&setTimeout((function(){t.addLoading()}),0),this.hasLoading=function(){return!!i},this.addLoading=function(e){i||(i=!0,void 0===e&&(e={}),OGX.Data.merge(e,n),this.addOverlay(e))},this.removeLoading=function(e){i&&(this.removeOverlay(e),i=!1)}},OGX.Media=function(){"use strict";var e=!1,t={},i=0;function n(e,t,i){var n=$(e).parent().innerWidth(),a=$(e).parent().innerHeight(),o=function(e,t){var i={};return e.width/e.height>t.width/t.height?(i.width=t.width,i.height=Math.round(e.height*(t.width/e.width))):(i.width=Math.round(e.width*(t.height/e.height)),i.height=t.height),i}({width:t,height:i},{width:n,height:a}),r=(n-o.width)/2,s=(a-o.height)/2;$(e).css("left",r+"px"),$(e).css("top",s+"px"),$(e).prop("width",o.width),$(e).prop("height",o.height)}function a(e){var t=$(e);t&&(t.find(".ogx_video").each((function(e,t){!function(e,t,i){var n=t/i,a=$(e).parent().innerWidth(),o=$(e).parent().innerHeight(),r=a,s=Math.ceil(r/n);s<o&&(r=(s=o)*n),$(e).prop("width",r),$(e).prop("height",s)}(t,parseInt($(t).data("width"),10),parseInt($(t).data("height"),10))})),t.find(".ogx_video_resp").each((function(e,t){!function(e,t,i){var n=t/i,a=$(e).parent().innerWidth(),o=$(e).parent().innerHeight(),r=a,s=Math.ceil(r/n);s<o&&(r=(s=o)*n),$(e).prop("width",r),$(e).prop("height",s)}(t,parseInt($(t).data("width"),10),parseInt($(t).data("height"),10))})),t.find(".ogx_video_poster").each((function(e,t){!function(e,t,i){var n=t/i,a=$(e).parent().innerWidth(),o=$(e).parent().innerHeight(),r=a,s=Math.ceil(r/n),l=0,d=0;s<o&&(s=o,r=Math.ceil(s*n)),r>a?l=(r-a)/2*-1:r<a&&(l=(a-r)/2*-1),s>o?d=(s-o)/2*-1:s<o&&(d=(o-s)/2*-1),$(e).css("left",l+"px"),$(e).css("top",d+"px"),$(e).prop("width",r),$(e).prop("height",s)}(t,parseInt($(t).data("width"),10),parseInt($(t).data("height"),10))})),t.find(".ogx_image_contain").each((function(e,t){n(t,parseInt($(t).data("width"),10),parseInt($(t).data("height"),10))})),t.find(".ogx_image_cover").each((function(e,t){!function(e,t,i){var n=$(e).parent().innerWidth(),a=n/(t/i),o=($(e).parent().innerHeight()-a)/2;o>0&&(o=0),$(e).parent().css("overflow","hidden"),$(e).prop("width",n),$(e).prop("height",a),$(e).css("top",o+"px")}(t,parseInt($(t).data("width"),10),parseInt($(t).data("height"),10))})),t.find(".ogx_image_fit").each((function(e,t){!function(e,t,i){var n=t/i,a=$(e).parent().innerWidth(),o=a,r=Math.ceil(o/n),s=0;o>a?s=(o-a)/2*-1:o<a&&(s=(a-o)/2*-1),$(e).css("left",s+"px"),$(e).prop("width",o),$(e).prop("height",r)}(t,parseInt($(t).data("width"),10),parseInt($(t).data("height"),10))})),t.find(".ogx_image_scale").each((function(e,t){!function(e,t,i){var n=t/i,a=$(e).parent().innerWidth(),o=Math.ceil(a/n);$(e).prop("width",a),$(e).prop("height",o)}(t,parseInt($(t).data("width"),10),parseInt($(t).data("height"),10))})),t.find(".ogx_image_resp").each((function(e,t){!function(e,t,i){var n=t/i,a=$(e).parent().innerWidth();a>t&&(a=t);var o=Math.ceil(a/n);$(e).prop("width",a),$(e).prop("height",o)}(t,parseInt($(t).data("width"),10),parseInt($(t).data("height"),10))})))}function o(e){e?$(window).on("resize",r):$(window).off("resize",r)}function r(){for(var e in t)a(t[e].selector)}function s(e){e.find(".ogx_video, .ogx_video_resp, .ogx_video_poster").each((function(e,t){$(t).attr("data-width",$(t).attr("width")),$(t).attr("data-height",$(t).attr("height")),$(t).parent().css("overflow","hidden")})),e.find(".ogx_image_cover, .ogx_image_contain, .ogx_image_fit, .ogx_image_scale, .ogx_image_resp").each((function(e,t){$(t).css("position","relative"),$(t).attr("data-width",$(t).attr("width")),$(t).attr("data-height",$(t).attr("height"))})),setTimeout(a,200)}this.resize=function(e){void 0!==e?a(e):r()},this.bind=function(n,r){return!t.hasOwnProperty(n)&&(t[n]={observer:null,element:r},t[n].observer=(l=r,(d=new(window.MutationObserver||window.WebKitMutationObserver)((function(e,t){e.forEach((function(e){s($(l))})),a(l)}))).observe(document.querySelector(l),{childList:!0,subtree:!0}),d),t[n].selector=r,i++,e||(e=!0,o(!0)),s($(r)),a(r),!0);var l,d},this.unbind=function(n){return!(!t.hasOwnProperty(n)||!t[n].observer)&&(t[n].observer.disconnect(),delete t[n],!--i&&e&&(e=!1,o(!1)),!0)}},OGX.Media=new OGX.Media,require("NestList","Uxi","Bind"),OGX.NestList=function(e){construct(this,"NestList");var t,i,n=this,a={scope:["public"],template:'<div class="ogx_nest_list_item {{$dsp}}" data-ogx-nest-id="{{$id}}"><div class="ogx_nest_list_item_head {{$css}}"><span class="ogx_nest_list_item_title">{{$title}}</span><span class="ogx_nest_list_item_icon"></span></div><div class="ogx_nest_list_item_body"><div class="ogx_nest_list_item_content">{{$body}}</div></div></div>',list:new OGX.List,item_default:!1,map:{title:"title",scope:"scope",id:"id"},order:!1,timeout:200},o={title:"",scope:[],open:!0},r={id:0,title:!1,scope:[],height:0,y:0,hidden:!1,open:!0,selector:!1},s=e,l=!1,d=0,c=0,u=1,h={y:0,h:0,way:1},_=!1,f=new OGX.List;function g(e){e?t.on("click",".ogx_nest_list_item_head",p):t.off("click",".ogx_nest_list_item_head",p)}function p(e){l||(l=!0,m($(this)))}function m(e){var i=e.parent(0).data("ogx-nest-id"),n=!1;e.hasClass("ogx_nest_list_item_head_closed")?(h.way=1,e.addClass("ogx_nest_list_item_head_open").removeClass("ogx_nest_list_item_head_closed"),f.findUpdate("id",i,{open:!0},!1,1),n=!0):(h.way=0,e.removeClass("ogx_nest_list_item_head_open").addClass("ogx_nest_list_item_head_closed"),f.findUpdate("id",i,{open:!1},!1,1));var a=f.find("id",i,1);n?(!function(e){var t=v(e);if(t)return t.focus(),!0}(a),t.trigger(OGX.NestList.OPEN,a)):(!function(e){var t=v(e);if(t)return t.blur(),!0}(a),t.trigger(OGX.NestList.CLOSE,a)),setTimeout(x,0)}function v(e){var t=$(e.selector).find(".ogx_uxi:first");if(t.length){var i=String(t.data("ogx-id")),a=n.nodes.find("id",i,1);if(a)return a}return!1}function y(e){if(e.hasOwnProperty("scope"))for(var t=0;t<e.scope.length;t++)if(-1!==s.scope.indexOf(e.scope[t]))return!0;return!1}function x(){var e;!function(){var e=0;c=0,h.y=0,h.h=0;for(var i=0;i<f.length;i++)f[i].y=e,f[i].hidden||(d||(d=t.children(".ogx_nest_list_item:eq("+i+")").children(".ogx_nest_list_item_head").outerHeight(!0)),c+=d,h.y=e,f[i].open&&(h.y+=f[i].height,e+=f[i].height,c+=f[i].height),h.h=f[i].height);c-=h.h}();for(var i=t.children(".ogx_nest_list_mask:first"),n=0;n<f.length;n++)(e=t.children('.ogx_nest_list_item[data-ogx-nest-id="'+f[n].id+'"]')).removeClass("ogx_nest_list_item_noanim"),e.css("transform","translateY("+f[n].y+"px)");var a="height:"+Math.ceil(c+h.h)+"px !important;";i.on("transitionend",(function(){i.off("transitionend"),h.way||t.css("cssText",a),l=!1})),h.way&&t.css("cssText",a),setTimeout((function(){i.css({transform:"translateY("+h.y+"px)"})}),0)}function O(e,i){OGX.Data.merge(e,o);var a=OGX.Data.merge(r,e,!0,!0);e.hasOwnProperty(s.map.id)?a.id=e[s.map.id]:(a.id=u,u++);var l,d,c=((d={css:"",dsp:"ogx_nest_list_prep",id:(l=a).id})[s.map.title]=l[s.map.title],l.open?d.css="ogx_nest_list_item_head_open":d.css="ogx_nest_list_item_head_closed",OGX.Templater.templatize(s.template,d));return void 0!==i&&i<s.list.length-1?t.children(".ogx_nest_list_item:eq("+i+")").before(c):t.children(".ogx_nest_list_mask:first").before(c),a.selector='.ogx_nest_list[data-ogx-id="'+n.id+'"] > .ogx_nest_list_item[data-ogx-nest-id="'+a.id+'"] > .ogx_nest_list_item_body > .ogx_nest_list_item_content',setTimeout((function(){b(a);var e=$('.ogx_nest_list[data-ogx-id="'+n.id+'"] > .ogx_nest_list_item[data-ogx-nest-id="'+a.id+'"]');a.hidden&&e.addClass("ogx_nest_list_item_hidden"),e.removeClass("ogx_nest_list_prep")}),s.timeout),a}function b(e){var t=$(e.selector).outerHeight(!0);e.height=t}function w(){var e=s.list;_&&(e=i),t.empty(),f.clear();var n;t.html('<div class="ogx_nest_list_mask"></div>');for(var a=0;a<e.length;a++)n=O(e[a]),f.push(n),s["node:OML"][a]=OGX.OML.replaceNodeName(s["node:OML"][a],n.selector);setTimeout(x,s.timeout)}function G(){for(var e=[],t=0;t<s.list.length;t++)e[s.order.indexOf(s.list[t][s.map.title])]=s.list[t];return s.list=new OGX.List(e)}function X(){s.list.hasOwnProperty("insert")||(s.list=new OGX.List(s.list));for(var e=0;e<s.list.length;e++)s.item_default?OGX.Data.merge(s.list[e],s.item_default):OGX.Data.merge(s.list[e],o),s.order&&G()}this.el=null,this._NAME_=OGX.NestList.NAME,this.enable=function(){g(!0)},this.disable=function(){g(!1)},this.show=function(e,t){var i=this.find(e,t);i&&m(i.el.parents(".ogx_nest_list_item:first").children(".ogx_nest_list_item_head:first"))},this.bindFilter=function(e,t,n){s.list.removeFilter(e),void 0!==n&&s.list.addFilter(e,t,n),s.list.getFilters()&&(i=s.list.filter(),_=!0),setTimeout(w,0)},this.scope=function(e){return void 0!==e?(s.scope=e,function(){for(var e,i=0;i<f.length;i++)(e=t.children(f[i].selector)).addClass("ogx_nest_list_item_noanim"),y(f[i])?(f[i].hidden=!1,e.removeClass("ogx_nest_list_item_hidden")):(f[i].hidden=!0,e.addClass("ogx_nest_list_item_hidden"));setTimeout(x,0)}(),!0):s.scope},this.val=function(e){if(void 0===e)return s.list;s.list=e,X(),setTimeout(w,0)},this.addNest=function(e,t,i){var n=O(e,i);if(f.insert(n,i),t=OGX.OML.replaceNodeName(t,n.selector),OGX.OML.render(this,t),void 0!==i){var a=this.nodes.pop();this.nodes.insert(a,i)}},this.removeNest=function(e){var t=f.findIndex(s.map.title,e);t&&(this.nodes[t.index].kill(),this.nodes.splice(t.index,1),$('.ogx_nest_list[data-ogx-id="'+n.id+'"] > .ogx_nest_list_item[data-ogx-nest-id="'+f[t.index].id+'"]').remove(),f.splice(t.index,1),setTimeout(x,0))},this.updateNestHeight=function(e){var t=f.find(s.map.title,e,1);setTimeout((function(){b(t),x()}),0)},OGX.Data.merge(s,a),X(),s.template=s.template.replace("{{$title}}","{{$"+s.map.title+"}}"),n.el=t=$(s.el),t.addClass("ogx_nest_list"),s.list.length&&w()},OGX.NestList.NAME="NestList",OGX.NestList.OPEN="NestListOpen",OGX.NestList.CLOSE="NestListClose",OGX.NestList.READY="NestListReady",OGX.Net=function(e){"use strict";var t=1,i=OGX.Data.merge(e,{file_default:{file:!1,path:!1},extensions:[{ext:"json",path:"/json",type:"json"},{ext:"js",path:"/js",type:"text"},{ext:"html",path:"/html",type:"text"},{ext:"oml",path:"/oml",type:"json"},{ext:"ose",path:"/ose",type:"text"},{ext:"mp3",path:"/snd",type:"mp3"},{ext:"wav",path:"/snd"},{ext:"ogg",path:"/snd"},{ext:"png",path:"/img"},{ext:"jpg",path:"/img"},{ext:"gif",path:"/img"},{ext:"svg",path:"/img"}],ios:!1},!1,!0);function n(e,t,i){switch(e.ext){case"json":case"txt":case"oml":case"ose":case"html":case"snd":"app.json"!==e.file&&OGX.Cache.add(e)}void 0!==t?setTimeout((function(){t(e.data,i)}),0):$(document).trigger(OGX.Net.LOAD_SUCCESS,e)}i.extensions.hasOwnProperty("insert")||(i.extensions=new OGX.List(i.extensions)),this.preload=function(e,t,i){var n={loaded:0,total:0,files:new OGX.List};for(var a in e)for(var o=0;o<e[a].length;o++)n.total++,this.load(a+"/"+e[a][o],r);function r(e,a){n.loaded++,n.files.insert(e),n.loaded===n.total&&setTimeout((function(){t(n.files,i)}),0)}},this.load=function(e,a,o){var r,s={file:null,path:null};-1!==e.indexOf("/")?(r=e.split("/"),s.file=r.pop(),s.path=r.join("/")):(s.path="",s.file=e),OGX.Data.merge(s,i.file_default);var l=function(e){var t;if(t=/([a-z0-9\_\-]+\.)?([a-z0-9\_\-]+)\.([a-z0-9]{3,4})/gi.exec(e))return t.shift(),t;return!1}(s.file);if(l)switch(s.ext=l[2],s.id=l[1],s.ext){case"json":case"txt":case"oml":case"ose":case"html":s.type=i.extensions.find("ext",s.ext,1).type,function(e,t,i){a=e.path+"/"+e.file,"/"===a.substr(0,1)&&(a=a.substr(1)),$.ajax({dataType:e.type,url:a}).done((function(a){e.data=a,n(e,t,i)}));var a}(s,a,o);break;case"mp3":case"ogg":case"wav":!function(e,t,a){var o;r=e.path+"/"+e.file,"/"===r.substr(0,1)&&(r=r.substr(1)),o=new Audio(r),e.data=o,e.ext="snd",i.ios?n(e,t,a):o.oncanplaythrough=function(){n(e,t,a)};var r}(s,a,o);break;case"png":case"gif":case"jpg":case"svg":!function(e,t,i){var a=new Image;!function(){a.onload=function(){e.data=a,n(e,t,i)};var o=e.path+"/"+e.file;"/"===o.substr(0,1)&&(o=o.substr(1)),a.src=o}()}(s,a,o);break;case"ttf":case"eot":case"woff":case"woff2":!function(e,i,a){r='<div class="ogx_font_loader" style="font-family:'+e.file.split(".")[0]+';" data-ogx-id="font-loader-'+t+'"><b>ogx</b> <i>font</i> init</div>',$("body").append(r),n(e,i,a),o=t,setTimeout((function(){$('.ogx_font_loader[data-ogx-id="font-loader-'+o+'"]').remove()}),150),t++;var o,r}(s,a,o)}}},OGX.Net.LOAD_SUCCESS="NET_LOAD_SUCCESS",OGX.OSE=function(){"use strict";var charcode,to="__thread_object",lo="__local_object",ro="__route_object",oo="__object";function convertToJS(e,t,i,n,a){var o,r,s,l,d,c=0,u="";if(e=(e=e.replace(/^[ \n\r]*{{|}}[\r\n ]*$/g,"")).replace(/(\/\*+((?!\*+\/)[\S\s])*\*+\/)/g,""),(r=/(screen ?([<>=!+]+ ?\d+) ?\? ?([\S\s]+) ?\: ?([\S\s]+);?)/gi.exec(e))&&(l=(l=(l="var a;"+r[0]).replace("screen","screen.width")).replace(r[3],'a="'+r[3].trim()+'"'),l="null"!==r[4]?l.replace(r[4],'a="'+r[4].trim()+'"'):l.replace(r[4],"a=false;"),l+=";if(a){return a;}",d=new Function(l),e=e.replace(r[0],d())),(r=/(scope ([\S ]+) ?\? ?([\S ]+)\: ?([\S ]+);?)/gi.exec(e))&&(l=r[0],e="null"===(l=(s=OGX.Scope.check(r[2].split(" ")))?r[3]:r[4])?e.replace(r[0],""):e.replace(r[0],l)),(r=/(uxi *(?:#|\$|&|@)*([a-z0-9_\-]+)):(([a-z0-9]+))/gi.exec(e))&&(s='OGX.Object.get({_NAME_:{eq:"'+r[3]+'"}, id:{eq:"'+r[2]+'"}}, null, 1);')===(e=e.replace(r[0],s)))return"return "+e;if((r=/mongogx ([a-z0-9_\-]+)\.([a-z0-9_\-]+)\.([a-z]+)\(([\S ]+)\)/gi.exec(e))&&(s="mongogx.setDatabase('"+r[1]+"');",s+="mongogx.setCollection('"+r[2]+"');",(s+="return mongogx."+r[3]+"("+r[4]+")[0];")===(e=e.replace(r[0],s))))return s;if(isSingleVar(e))return"return "+replaceVars(e,t,i,n,a)+";";for(e+="\r\n";o=/[\S ]+(\r\n|\r)/gi.exec(e);){if(l=replaceLoop(l=o[0].replace(/(\r\n|\r)/gi,"").trim()),charcode++,l=replaceVars(l,t,i,n,a),/^(app|OGX)\.\S+;?/g.test(l))return"return "+l+";";if(e=e.replace(o[0],""),u+=l+"\n",++c>100)return}return u="var __echo=[];\n"+u+'\nif(!__echo.length){return;}else{return __echo.join("");}'}function runJS(e,t,i,n,a){var o;try{o=new Function(oo,to,ro,lo,e)(t,i,n,a)}catch(e){return}if(o)return o}function isSingleVar(e){return/^[ ]*\S+( \S+)?[ ]*$/g.test(e)}function getTrueVal(__string,__object,__thread_object,__route_object,__local_object){var e=!1;try{e=eval(__string)}catch(e){}return!e||e&&e instanceof HTMLElement?'"'+__string+'"':__string}function replaceLoop(e){var t,i,n,a;return(t=/loop (\S+) ?(as (\S+) ?(\S+ )?)?{/gi.exec(e))&&(i="__"+String.fromCharCode(charcode).toLowerCase()+"__",n=(n=t[0]).replace(t[0],"for(var "+i+" in JSON.parse(JSON.stringify("+t[1]+"))){"),t[2]&&(a=t[4]?"&"+t[3]+"="+i+"; &"+t[4]+"="+t[1]+"["+i+"]; ":"&"+t[3]+"="+t[1]+"["+i+"]; "),n+=a,e=e.replace(t[0],n)),e}function replaceVars(e,t,i,n,a){for(var o,r,s,l=0;r=/((&|#|@|\$)([a-z0-9\-_]+))(\.[a-z0-9\-_\.\[\]\$]+|\.\$|\.)?(;)?/gi.exec(e);){switch(s=!1,r[2]){case"&":s=to+"."+r[3];break;case"@":s=lo+"."+r[3];break;case"$":s=oo+"."+r[3];break;case"#":s=r[3]}if(o=r[0].replace(r[1],s),e=e.replace(r[0],o),++l>200)return e}for(;r=/([a-z_\-]+)\((\$|@|&)\)/gi.exec(e);){switch(r[2]){case"&":s=to;break;case"@":s=lo;break;case"$":s=oo}o=r[1]+"("+s+")",e=e.replace(r[0],o)}for(;/(json|ose|template|oml|crumb|echo) (\S+)/g.test(e);){if((r=/crumb (\S+)?/gi.exec(e))&&(o="__route_object."+r[1],e=e.replace(r[0],o)),(r=/json (\S+)(;)?/gi.exec(e))&&(e=e.replace(r[0],"app.getJSON("+getTrueVal(r[1],t,i,n,a)+")")),(r=/^template (\S+)[ ;]?/gi.exec(e))&&(e=e.replace(r[0],"OGX.Templater.templatize(OGX.Templater.getTemplate("+getTrueVal(r[1],t,i,n,a)+"), "+r[2]+", "+to+","+ro+","+lo+")")),(r=/^ose (\S+)(;)?/gi.exec(e))&&(r[1]=getTrueVal(r[1],t,i,n,a),script=that.get(r[1]),script&&(e=exp.replace(r[0],script.replace(/({{|}})/g,"")))),(r=/^oml (\S+)(;)?/gi.exec(e))&&(e=e.replace(r[0],"OGX.OML.get("+getTrueVal(r[1],t,i,n,a)+")")),r=/echo ('|")?(((?![;}\r\n]+|$)([\S\s]))*)(?:'|")?/gi.exec(e)){var d="+$1+",c="'";void 0!==r[1]&&(c="\\"+r[1]),d=c+d+c,r[2]=r[2].replace(/(__(?!;\n\r)[a-z0-9_\-\.]+)/gi,d),o="__echo.push("+c+r[2]+c+");",e=e.replace(r[0],o)}if(++l>200)return e}return e}this.get=function(e){return OGX.Cache.get("ose",e)},this.execScript=function(e,t,i,n){var a=this.get(e);return a&&this.exec(a,t,i,n),!1},this.exec=function(e,t,i,n,a){void 0===t&&(t={}),void 0===i&&(i={}),void 0===n&&(n={}),void 0===a&&(a={}),charcode=65;var o=runJS(convertToJS(e,t,i,n,a),t,i,n,a);return o||!1},this.loadExecScript=function(e,t,i,n,a){$.get(e,(function(e){OGX.OSE.exec(e,t,i,n,a)}))}},OGX.OSE=new OGX.OSE,OGX.OSE.SCRIPT_LOADED="OSE_SCRIPT_LOADED",OGX.OSE.SCRIPTS_LOADED="OSE_SCRIPTS_LOADED",OGX.Overlay=function(e){"use strict";var t=this,i=!1,n=!1,a={anim:OGX.Overlay.FADE,display:{css:"",html:" "},index:!1,close_on_click:!1},o=!1;function r(e){i&&(e?i.on("mousedown",s):i.off("mousedown",s))}function s(){r(!1),t.removeOverlay()}e.hasOwnProperty("overlay")&&e.overlay&&setTimeout((function(){t.addOverlay(e.overlay)}),0),this.hasOverlay=function(){return!!i},this.addOverlay=function(e){if("object"!=typeof e&&(e={}),OGX.Data.merge(e,a),e.display.hasOwnProperty("_NAME_")||(e.display=new OGX.Display(e.display)),o=e,!this.hasOverlay()){var t=this.el;o.hasOwnProperty("el")&&(t=$(o.el));var n="z-index:"+(o.zindex?o.zindex:this.topIndex(t))+";",s='<div class="ogx_overlay '+o.display.css()+'" style="'+n+'">'+o.display.html()+"</div>";if(t.prepend(s),(i=t.children(".ogx_overlay:first")).off("transitionend"),o.anim)switch(o.anim){case OGX.Overlay.FADE:setTimeout((function(){i&&i.removeClass("ogx_overlay_fade_out").addClass("ogx_overlay_fade_in")}),50)}else i.css("opacity",1)}e.close_on_click&&r(!0)},this.removeOverlay=function(e){if(r(!1),void 0===e&&(e=!1,o&&o.anim&&(e=o.anim)),i)if(e)switch(e){case OGX.Overlay.FADE:i.removeClass("ogx_overlay_fade_in").addClass("ogx_overlay_fade_out"),i.css("opacity")>0?i.on("transitionend",(function(){i&&(i.off("transitionend"),i.remove(),i=!1)})):i&&(i.removeClass("ogx_overlay_fade_in").removeClass("ogx_overlay_fade_out"),i.off("transitionend"),i.remove(),i=!1)}else i.remove(),i=!1},this.addGroupOverlay=function(){n||(this.el.prepend('<div class="ogx_group_overlay" style="z-index:'+(this.topIndex()+1e3)+'"></div>'),n=!0)},this.removeGroupOverlay=function(){n&&(this.el.children(".ogx_group_overlay:first").remove(),n=!1)}},OGX.Overlay.FADE="fade",OGX.Overlay.REMOVE="OverlayRemove",OGX.Placeholder=function(){},OGX.Placeholder.prototype.placeholders=function(e,t){if(void 0!==e&&void 0!==t){var i;e.hasOwnProperty("node:OML")||(e["node:OML"]=[]);for(var n=0;n<e["node:OML"].length;n++)for(var a in e["node:OML"][n])if(0===a.indexOf("default")){i=a.split(":")[1],e["node:OML"][n][t[n]+":"+i]=e["node:OML"][n][a],delete e["node:OML"][n][a];break}return e}return!1},require("Point","Uxi"),OGX.Point=function(e){construct(this,"Point");var t,i=this,n=OGX.Data.merge(e,{live:[],mode:0}),a=new OGX.List,o=0;function r(){var e=function(){var e=i.el.width();if(e&&e!==o&&(o=e),o)for(var t=0;t<i.points.length;t++)if(o>=i.points[t].min&&o<i.points[t].max)return{id:t,oml:i.points[t].oml};return!1}();return!(!e||e.id===i.point)&&(i.point=e.id,!0)}this.points=[],this.point=null,this.el=$(e.el),this._NAME_=OGX.Point.NAME,this.construct=function(e,t){},this.resize=function(){r()&&(!function(e){for(var t,o=0;o<n.live.length;o++)(t=i.find(!1,n.live[o]))&&(t.sleep(),e&&a.push(t),t.parent.nodes.findDelete("id",t.id,1))}(n.live.length&&!a.length),this.nodes.length&&this.clear(),OGX.OML.render(this,this.points[this.point].oml,n.data,n.route_data,a),this.el.trigger(OGX.Point.CHANGE,{min:this.points[this.point].min,max:this.points[this.point].max}))},this.oml=function(){return this.point||r(),this.points[this.point].oml},t=!0,n.el||(n.el=n.parent.el,t=!1),i.el=$(n.el),i.el.addClass("ogx_point"),t&&i.el.addClass("ogx_point_uxi"),function(){var e,t=i.id;for(var a in n.mode&&(t=n.parent.id),n)if(/^\d+\-\d+$/gi.test(a)){e=a.split("-");var o=JSON.parse(JSON.stringify(n[a]));for(var r in o)0===r.indexOf("default:")&&(o['.ogx_point[data-ogx-id="'+t+'"]:'+r.split(":")[1]]=o[r],delete o[r]);i.points.push({min:parseInt(e[0],10),max:parseInt(e[1],10),oml:o})}}(),r()},OGX.Point.NAME="Point",OGX.Point.CHANGE="PointChange",require("Popup","Uxi","Placeholder","Touch","Resize","Overlay"),OGX.Popup=function(e){construct(this,"Popup");var t,i,n=this,a={el:!1,width:"80%",height:"80%",html:!1,template:!1,title:!1,css:"",icon:!1,icons:!1,view:!1,drag:!1,resize:!1,center:!0,show:!1,group:!1,data:{},buttons:[],buttons_enabled:!0,anim:OGX.Popup.FADE,anim_param:{scale:.7},overlay:!1,zindex:!1,chromeos:!1,parent:null},o={label:"",callback:null,params:null,enabled:!0},r=e,s=null,l=null,d=null,c="ogx_popup",u=[],h=[],_={w:0,h:0},f=!1,g=!1;function p(){g=!0,m()}function m(){r.anim&&n.el.removeClass(c+"_"+r.anim);var e=X();u[0]="translate3d("+e.x+"px, "+e.y+"px, 0px)",n.el.css({transform:u.join(" ")}),n.resizeNodes()}function v(){n.blurNodes(),n.front()}function O(){n.focusNodes()}function b(){s.addClass(c+"_drag"),n.front()}function w(){if(s.removeClass(c+"_drag"),f){for(var e=0;e<h.length;e++)h[e].removeGroupOverlay();h=[],app.groupPopups(n,f)}}function G(e){if(n.parent&&(h=n.parent.nodes.get({_NAME_:{eq:"Popup"},group:{eq:n.group}},{z:-1})).length){t=n.el.position(),f=!1;for(var a=0;a<h.length;a++)n.id!==h[a].id&&h[a].group===n.group&&(i=h[a].el.position(),_.w=h[a].el.width(),_.h=h[a].el.height(),t.left>i.left&&t.left<i.left+_.w&&t.top>i.top&&t.top<i.top+_.h&&(f||(f=h[a],h[a].addGroupOverlay())),f||h[a].removeGroupOverlay())}}function X(){var e=d.width(),t=d.height();e>screen.width&&(e=screen.width),t>screen.height&&(t=screen.height);var i=r.width,n=r.height;if(g||(i=OGX.Data.getBestSize(e,i),n=OGX.Data.getBestSize(t,n)),r.center)x=Math.round(e/2-i/2),y=Math.round(t/2-n/2),r.drag&&(r.center=!1);else{var a=s.position();x=a.left,y=a.top,x>e&&(x=e-x),x<-i&&(x=0),y>t&&(y=t-n),y<0&&(y=0)}return{x:x,y:y}}function E(e,t,i,a,o){if(void 0!==t&&!0!==t||(t=!!r.anim&&r.anim),e?(n.front(),n.el.trigger(OGX.Popup.SHOW,n)):n.el.trigger(OGX.Popup.HIDE,n),t){var l={};switch(t){case OGX.Popup.SCALE:u[1]=e?"scale(1,1)":"scale("+r.anim_param.scale+", "+r.anim_param.scale+")",l.transform=u.join(" ");break;case OGX.Popup.FADE:l.opacity=e?1:0}e&&(s.css("display","flex"),l.visibility="visible"),setTimeout((function(){s.css(l)}),50),s.on("transitionend",(function(){s.off("transitionend"),e?n.resizeNodes():s.css({display:"none",visibility:"hidden"}),void 0!==i&&i&&i(a),void 0!==o&&o&&o(n.id)}))}else e?s.css({opacity:e,display:"flex",visibility:"visible"}):s.css({display:"none",visibility:"hidden"}),void 0!==i&&i&&i(a),void 0!==o&&o&&o(n.id)}function T(e){e?s.on(n.touch.down,"."+c+"_button",C):s.off(n.touch.down,"."+c+"_button",C)}function C(e){e.preventDefault(),e.stopImmediatePropagation();var t=$(this);if(!t.hasClass(c+"_button_disabled")){var i=t.index();s.trigger(OGX.Popup.CLICK_BUTTON,{index:i,value:r.buttons[i].label}),r.buttons[i].hasOwnProperty("callback")&&r.buttons[i].callback&&(r.buttons[i].hasOwnProperty("params")?r.buttons[i].callback.apply(null,[r.buttons[i].params]):r.buttons[i].callback())}}function D(){for(var e,t="",i=0;i<r.buttons.length;i++)r.buttons.length>0&&(e=r.buttons[i].enabled?"":c+"_button_disabled",t+='<span class="'+c+"_button "+e+'">'+r.buttons[i].label+"</span>");return t}function M(e,t){void 0===t&&(t=!0),r.buttons=new OGX.List(e);for(var i=0;i<e.length;i++)r.buttons[i]=OGX.Data.merge(r.buttons[i],o);if(t){var n=D();l.html(n)}}function S(e){e?n.el.on(n.touch.down,"."+c+"_icons_icon",(function(e){var t,i=$(this).index(),n=r.icons[i];"object"==typeof n&&n.hasOwnProperty("callback")&&(n.hasOwnProperty("params")&&(t=n.params),n.callback.call(null,t))})):n.el.off(n.touch.down,"."+c+"_icons_icon")}function L(){for(var e="",t=0;t<r.icons.length;t++)"string"==typeof r.icons[t]?e+='<div class="'+c+'_icons_icon" style="background-image:url(\''+r.icons[t]+"')\"></div>":e+='<div class="'+c+'_icons_icon" style="background-image:url(\''+r.icons[t].icon+"')\"></div>";return e}this.anim=null,this.el=null,this.floating=!0,this._NAME_=OGX.Popup.NAME,this.group=r.group,this.z=0,this.construct=function(){r.show&&this.show()},this.enable=function(){this.touch.enable(),this.enableResize(),r.icons&&r.icons.length&&S(!0),r.buttons&&r.buttons.length&&r.buttons_enabled&&T(!0)},this.disable=function(){this.touch.disable(),this.disableResize(),r.icons&&r.icons.length&&S(!1),r.buttons&&r.buttons.length&&r.buttons_enabled&&T(!1)},this.show=function(e,t,i){E(1,e,t,i),this.focus(1)},this.hide=function(e,t,i,n){E(0,e,t,i,n),this.blur(1)},this.buttons=function(e){if(void 0===e)return r.buttons;M(e)},this.enableButton=function(e){r.buttons[e].enabled=!0,l.children("."+c+"_button:eq("+e+")").removeClass(c+"_button_disabled"),r.buttons_enabled||(r.buttons_enabled=!0)},this.disableButton=function(e){r.buttons[e].enabled=!1,l.children("."+c+"_button:eq("+e+")").addClass(c+"_button_disabled")},this.enableButtons=function(){if(r.buttons.length)for(var e=0;e<r.buttons.length;e++)this.enableButton(e);r.buttons_enabled=!0},this.disableButtons=function(){if(r.buttons.length)for(var e=0;e<r.buttons.length;e++)this.disableButton(e);r.buttons_enabled=!1},this.center=function(){var e=X();u[0]="translate3d("+e.x+"px, "+e.y+"px, 0px)",n.el.css({transform:u.join(" ")})},this.move=function(e,t){null===e&&(e=n.el.position().left),null===t&&(t=n.el.position().top),u[0]="translate3d("+e+"px, "+t+"px, 0px)",n.el.css({transform:u.join(" ")})},this.front=function(){this.z=r.parent.topIndex(),this.el.css("z-index",this.z)},this.icon=function(e){if(void 0===e)return r.icon;r.icon=e,this.el.children("."+c+"_head:first").children("."+c+"_icon:first").css("background-image","url("+e+")")},this.title=function(e){if(void 0===e)return r.title;r.title=e,this.el.find("."+c+"_title:first").html(e)},this.resize=function(){m()},this.icons=function(e){if(void 0===e)return r.icons;r.icons&&r.icons.length&&S(!1),r.icons=e,this.el.find("."+c+"_icons:first").html(L()),S(!0)},function(){if(OGX.Data.merge(r,app.getDefaults("popups")),OGX.Data.merge(r,a),M(r.buttons,!1),(s=$(r.el)).addClass(c),d=s.parent(),n.anim=r.anim,n.centered=r.center,function(){r.index?n.z=r.index:n.z=r.parent.topIndex();var e=X(),t=r.width,i=r.height;-1===String(t).indexOf("%")&&(t+="px"),-1===String(i).indexOf("%")&&(i+="px");var a="";(r.icon||r.title||r.icons||r.drag)&&(a+='<div class="'+c+'_head">',r.icon&&(a+='<div class="'+c+'_icon" style="background-image:url(\''+r.icon+"')\"></div>"),r.title&&(a+='<div class="'+c+'_title">'+r.title+"</div>"),a+='<div class="'+c+'_icons">',r.icons&&(a+=L()),a+="</div></div>");var o,d=1;if(u=["translate3d("+e.x+"px, "+e.y+"px, 0)"],r.anim)switch(r.anim){case OGX.Popup.FADE:d=0,o=c+"_fade";break;case OGX.Popup.SCALE:o=c+"_scale",u[1]="scale("+r.anim_param.scale+", "+r.anim_param.scale+")"}a+='<div class="'+c+"_body ogx_view "+r.css+'">',r.html?a+=r.html:r.template&&(a+=OGX.Templater.templatize(OGX.Templater.getTemplate(r.template),r.data)),a+="</div>",r.buttons&&r.buttons.length&&(a+='<div class="'+c+'_buttons">',a+=D(),a+="</div>"),s.html(a),s.css({width:t,height:i,opacity:d,transform:u.join(" "),"z-index":n.z}),r.anim&&s.addClass(o),n.el=s,l=s.children("."+c+"_buttons:first")}(),r.drag){var e={x:!0,y:!0,cb_down:b,cb_up:w,target:"."+c+"_head:first"};r.group&&(e.cb_drag=G),n.touch.drag.set(e)}if(r.resize&&n.setResize({top:!1,cb_resize:p,cb_down:v,cb_up:O}),r.hasOwnProperty("html")&&r.html)r["node:OML"]=[{"default:Html":{html:r.html}}];else if(r.hasOwnProperty("view")&&r.view){var t={};t["default:Views."+r.view.id]=r,r["node:OML"].push(t)}n.placeholders(r,["."+c+'[data-ogx-id="'+r.id+'"] > .'+c+"_body"]),r.overlay&&n.addOverlay()}()},OGX.Popup.NAME="Popup",OGX.Popup.FADE="fade",OGX.Popup.SCALE="scale",OGX.Popup.HIDE="PopupHide",OGX.Popup.SHOW="PopupShow",OGX.Popup.GROUP="PopupGroup",OGX.Popup.UNGROUP="PopupUngroup",OGX.Popup.CLICK_BUTTON="PopupClickButton",OGX.Popup.FLOAT=!0,OGX.Resize=function(e){"use strict";var t,i,n,a,o,r,s,l,d=this,c=e,u={enabled:!0,top:!0,left:!0,right:!0,bottom:!0,min_width:100,min_height:100,max_width:0,max_height:0,border:10,cb_up:!1,cb_down:!1,cb_resize:!1},h=!1,_="mousedown",f="mouseup",g="mousemove",p=(c=!1,!1),m=!1,v={w:0,h:0};function y(e){c&&(e?d.el.on(_,x):d.el.off(_,x))}function x(e){e.stopImmediatePropagation();var u=E(e);n=u.pageX,a=u.pageY;var h=d.el.position();t=h.left,i=h.top;var _=d.el.offset(),f=n-_.left,g=a-_.top;v.w=d.el.width(),v.h=d.el.height(),o=0,r=0,s=0,l=0,c.top&&g<c.border&&(l=-1),c.bottom&&g>d.el.height()-c.border&&(l=1),c.left&&f<c.border&&(s=-1),c.right&&f>d.el.width()-c.border&&(s=1),p=-1!==window.getComputedStyle(d.el[0],"width"),m=-1!==window.getComputedStyle(d.el[0],"height"),(s||l)&&(e.preventDefault(),d.hasOwnProperty("dragable")&&d.dragable&&d.touch.drag.disable(),O(!0),w(!0),c.cb_down&&c.cb_down())}function O(e){e?h||(h=setInterval(b,5)):h&&(clearInterval(h),h=!1)}function b(){if(-1===s||-1===l){var e=t,n=i;o&&s&&(e+=o),r&&l&&(n+=r),o&&-1===s&&r&&1===l&&(n=i),d.el.css("transform","translate3d("+e+"px, "+n+"px, 0)")}s&&v.w+o*s>c.min_width&&(p?d.el.css("width",100*(v.w+o*s)/d.el.parent().width()+"%"):d.el.width(v.w+o*s)),l&&v.h+r*l>c.min_height&&(m?d.el.css("height",100*(v.h+r*l)/d.el.parent().height()+"%"):d.el.height(v.h+r*l)),(o||r)&&(c.cb_resize?c.cb_resize():d.el.trigger(OGX.Resize.RESIZING))}function w(e){e?($("body").on(g,G),$("body").on(f,X)):($("body").off(g,G),$("body").off(f,X))}function G(e){e.preventDefault(),e.stopImmediatePropagation(),e=E(e),o=e.pageX-n,r=e.pageY-a}function X(e){O(!1),w(!1),e=E(e),o=e.pageX-n,r=e.pageY-a,c.cb_up&&c.cb_up(),d.hasOwnProperty("dragable")&&d.dragable&&(y(!1),d.touch.drag.enable(),setTimeout((function(){y(!0)}),0))}function E(e){return e.hasOwnProperty("originalEvent")&&void 0!==e.originalEvent.changedTouches?e.originalEvent.changedTouches[0]:e}this.resizable=!0,this.setResize=function(e){OGX.Data.merge(e,u,!1),c=e},this.enableResize=function(){y(!0)},this.disableResize=function(){y(!1)},OGX.Data.merge(c,u,!1),void 0===window.ontouchstart||c.chromeos||(_="touchstart",g="touchmove",f="touchend")},OGX.Resize.RESIZING="resizeResizing",require("Roulette","Uxi","Bind","Touch"),OGX.Roulette=function(e){construct(this,"Roulette");var t,i,n,a,o,r,s,l=this,d=e,c={force_coef:10,time_coef:.1,min_force_pitch:2,value:null,name:!1,required:!1,display:!1,key:"value",mode:OGX.Roulette.MODE_REWIND,icon:!1,list:new OGX.List},u={template:!1,html:'<span class="ogx_roulette_block_label">{{$label}}</span>',css:!1},h="object",_=0,f=0,g="ogx_roulette";function p(e,t){void 0===t&&(t=!0),l.el.children('input[name="'+d.name+'"]').val(e),t&&l.el.children('input[name="'+d.name+'"]').trigger("change")}function m(e){e?t.on(l.touch.down,"."+g+"_icon",(function(e){e.preventDefault(),e.stopImmediatePropagation(),l.next(!0)})):t.off(l.touch.down,"."+g+"_icon")}function v(e){e?t.on("change","input[type=hidden]",(function(e){l.loopval(0,OGX.Data.stringToVal(e.target.value),!1)})):t.off("change","input[type=hidden]")}function y(e){return f+e>d.list.length-1?d.list[0]:f+e<0?d.list[d.list.length-1]:d.list[f+e]}function x(e){a=e.y,w(!0)}function O(e){var t;e.dirY!==o?(t=0,a=e.pt1.y):(t=e.pt1.y-a,a=e.pt1.y),o=e.dirY,i.css({transition:"none",transform:"translate3D(0px, "+(T(i)+t)+"px, 0px)"})}function b(e){w(!1),trans=T(i);var t=Math.round(trans/n)*n,a=Math.round(t/n%d.list.length);if(a=a<=0?Math.abs(a):d.list.length-a,f!==a){switch(f=a,h){case"string":d.value=d.list[f];break;case"object":d.value=d.list[f][d.key]}l.el.children('input[name="'+d.name+'"]').val(d.value),l.el.children('input[name="'+d.name+'"]').trigger("change"),l.el.trigger(OGX.Roulette.CHANGE,d.value)}i.css({transition:"all 0.2s ease-out",transform:"translate3D(0px, "+t+"px, 0px)"})}function w(e){e?r=setInterval(G,10):clearInterval(r)}function G(){var e,t,a;(e=Math.floor((i.position().top+n*o)/(n*d.list.length)*-1))!==_&&(0===i.children("."+g+'_stripe[data-id="'+e+'"]').length&&((t=s.clone()).css("top",e*(n*d.list.length)+"px"),t.attr("data-id",e),i.append(t)),i.children("."+g+"_stripe").each((function(e,t){a=i.position().top+$(t).position().top,(Math.ceil(a+n*d.list.length)<-n||a>n)&&$(t).remove()})),_=e)}function X(){w(!1),i.off("transitionend",X)}function E(){var e="",a="";d.icon&&(a+='<div class="'+g+'_container">'),a+='<div class="'+g+'_stripes">';for(var o=0;o<2;o++){a+='<div class="'+g+'_stripe" style="top:'+o*(d.list.length*n)+'px;" data-id="'+o+'">';for(var r=0;r<d.list.length;r++){switch(h){case"string":e=OGX.Templater.templatize(d.display.html(),{label:d.list[r]});break;case"object":e=d.display.html(d.list[r])}a+='<div class="'+g+"_block "+d.display.css(d.list[r])+'" style="height:'+n+"px; line-height:"+n+'px;" data-ogx-id="'+r+'">'+e+"</div>"}a+="</div>"}if(a+="</div>",d.icon&&(a+='</div><div class="'+g+'_icon"></div>'),void 0===f&&(f=0),d.name){var l="";switch(d.required&&(l=" required"),h){case"string":a+='<input type="hidden" name="'+d.name+'" value="'+d.list[f]+'" '+l+">";break;case"object":a+='<input type="hidden" name="'+d.name+'" value="'+d.list[f][d.key]+'" '+l+">"}}t.html(a),i=t.children("."+g+"_stripes:first"),d.icon&&(i=t.children("."+g+"_container:first").children("."+g+"_stripes:first")),s=(s=i.children("."+g+"_stripe:last")).detach();var c=f*n*-1;i.css({transition:"none",transform:"translate3D(0px, "+c+"px, 0px)"})}function T(e){var t=0;return"none"!==e.css("transform")&&(t=Number(e.css("transform").split(",")[5].split(")")[0])),t}function C(e){switch(h){case"string":return{index:d.list.indexOf(e)};case"object":return d.list.findIndex(d.key,e)}}this._NAME_=OGX.Roulette.NAME,this.el=null,this.enable=function(){t.removeClass(g+"_disabled"),this.touch.swipe.enable(),d.icon&&m(!0),d.name&&v(!0)},this.disable=function(){t.addClass(g+"_disabled"),this.touch.swipe.disable(),d.icon&&m(!1),d.name&&v(!1),w(!1)},this.bindFilter=function(e,t,i){d.list.removeFilter(e),d.list.addFilter(e,t,i),d.list.filter(),setTimeout(E,0)},this.bindRender=function(e,t){},this.val=function(e,t){if(void 0!==e){var a=C(e).index;a>-1&&(!function(e,t){void 0===t&&(t=!0);i.off("transitionend",X),w(!1),o=-1;var a=T(i),r=Math.round(a/n)*n,s=a-r,l=Math.round(r/n%d.list.length);l=l<=0?Math.abs(l):d.list.length-l;var c=l-e;d.mode===OGX.Roulette.MODE_CLOSEST&&c>d.list.length/2&&(c=-1*(d.list.length-l+e));var u=a+c*n-s,h=20*Math.round(Math.abs(c*n)*d.time_coef);w(!0),i.on("transitionend",X),i.css({transition:"all "+h+"ms ease-out",transform:"translate3D(0px, "+u+"px, 0px)"}),f=e}(a),d.name&&p(e,!1))}else switch(h){case"string":return d.list[f];case"object":return d.list[f][d.key]}},this.item=function(){return d.list[f]},this.loopval=function(e,t,a){var o=f,r=C(t).index;r>-1&&(f=r);var s=o-r,l=d.time_coef*Math.abs(s+e*d.list.length);w(!0),i.css({transition:"all "+l+"s ease-out",transform:"translate3D(0px, "+(T(i)+(s*n-d.list.length*n*e))+"px, 0px)"}),i.on("transitionend",X),d.name&&p(t,a),void 0!==a&&a&&this.el.trigger(OGX.Roulette.CHANGE,val)},this.next=function(e){var t,i=y(1);switch(o=1,h){case"string":t=i;break;case"object":t=i[d.key]}this.val(t),void 0!==e&&e&&(this.el.trigger(OGX.Roulette.CHANGE,t),d.name&&this.el.children('input[name="'+d.name+'"]').trigger("input"))},this.prev=function(e){var t,i=y(-1);switch(h){case"string":t=i;break;case"object":t=i[d.key]}this.val(t),void 0!==e&&e&&(this.el.trigger(OGX.Roulette.CHANGE,t),d.name&&this.el.children('input[name="'+d.name+'"]').trigger("change"))},this.setData=function(e,t){e.hasOwnProperty("insert")||(e=new OGX.List(e)),d.value=t,d.list=e,1===d.list.length&&(d.list[1]=d.list[0]),f=void 0===t?0:C(t).index,setTimeout(E,0)},function(){if(OGX.Data.merge(d,c),d.list.length>0&&!d.list.hasOwnProperty("insert")&&(d.list=new OGX.List(d.list)),"string"==typeof d.list[0]&&(h="string"),1===d.list.length&&(d.list[1]=d.list[0]),d.display?d.display=new OGX.Display(d.display):d.display=new OGX.Display(u),(t=l.el=$(d.el)).addClass(g),t.width(),n=t.height(),d.list.length){var e=t.parent();e[0].hasAttribute("data-value")&&(d.value=OGX.Data.stringToVal(e.data("value")),e.removeAttr("data-value")),d.value||(d.value=d.list[0].value),f=C(d.value).index}}(),d.list.length&&E(),l.touch.swipe.set({x:!1,y:!0,cb_down:x,cb_swipe:O,cb_up:b,target:'ogx_roulette[data-ogx-id="'+l.id+'"] .ogx_roulette_container:first'})},OGX.Roulette.NAME="Roulette",OGX.Roulette.CHANGE="RouletteChange",OGX.Roulette.MODE_REWIND="RouletteModeRewind",OGX.Roulette.MODE_CLOSEST="RouetteModeClosest",OGX.Roulette.BIND=OGX.Roulette.CHANGE,require("RouletteTree","Uxi"),OGX.RouletteTree=function(e){construct(this,"RouletteTree");var t,n,a=this,o=e,r={groups:!1,data:!1,value:!1,required:!1},s=!1;function l(e){e?t.on(OGX.Roulette.CHANGE,c):t.off(OGX.Roulette.CHANGE,c)}function d(){for(var e,t=0;t<s.length;t++)t>0&&(e=s[t-1].roulette.val()),0===t||t-1>=0&&null!==e&&String(e).length>0?s[t].roulette.focus():t>0&&g(s[t].roulette)}function c(e,a){e.stopImmediatePropagation();var o,r=$(e.target).data("ogx-id"),l=s.findIndex("id",String(r)),d=s[l.index].roulette.item().hasOwnProperty("head");if(n=l.index,l.index+1<s.length)for(i=l.index+1;i<s.length;i++)d?(s[i].roulette.val(""),s[i].roulette.blur()):(o=u(i-1,s[i-1].roulette.val()),s[i].roulette.setData(o,o[0].value),i===l.index+1?s[i].roulette.focus():s[i].roulette.blur());var c=h(n);t.trigger(OGX.RouletteTree.CHANGE,c),d&&!n&&(n=-1)}function u(e,t){for(var i=[],n=0;n<e+1;n++)i.push(s[n].roulette.val());return f(i)}function h(e){if(void 0===e&&(e=s.length),e<0)return!1;for(var t={},i=0;i<e+1;i++)t[o.groups[i]]=s[i].roulette.val();return t}function _(e){for(var t,i=[],a=0;a<o.groups.length;a++)e.hasOwnProperty(o.groups[a])&&(t=e[o.groups[a]],String(t).length&&(!isNaN(t)&&(t=String(t)),s[a].roulette.val(t),n=a,a>0&&s[a].roulette.setData(f(i),t),i.push(t)));setTimeout(d,0)}function f(e){for(var t=o.data,i=0;i<e.length;i++)e[i].length&&(t=t[e[i]]);var n=[{label:o.groups[e.length],value:""}];for(var a in t)n.push({label:a,value:a});return n}function g(e){setTimeout((function(){e.blur()}),0)}this._NAME_=OGX.RouletteTree.NAME,this.el=null,this.enable=function(){s&&(d(),l(!0))},this.disable=function(){s&&l(!1)},this.val=function(e){if(void 0===e)return n>-1?h(n):{};_(e)},o=OGX.Data.merge(o,r),a.el=t=$(o.el),t.addClass("ogx_roulette_tree"),function(){s=new OGX.List;var e,i,n=0;!function r(l,d){var c;if(!Array.isArray(l)&&"object"==typeof l){if(d>n){for(var u in n=d,t.append('<div class="ogx_roulette_tree_roulette" data-ogx-roulette="'+d+'"></div>'),i=o.groups[d-1],e=[{label:i,value:"",head:!0}],l)e.push({label:u,value:u});c=a.create(OGX.Roulette.NAME,{el:'.ogx_roulette_tree[data-ogx-id="'+a.id+'"] .ogx_roulette_tree_roulette[data-ogx-roulette="'+d+'"]',list:e,icon:o.icon,value:null,name:i,required:o.required}),n>1&&g(c),s.push({roulette:c,group:i,id:c.id})}if(d<o.groups.length)for(var u in l)r(l[u],d+1)}}(o.data,1)}(),n=-1,o.value&&setTimeout((function(){_(o.value)}),0),a.enable()},OGX.RouletteTree.NAME="RouletteTree",OGX.RouletteTree.CHANGE="RouletteTreeChange",OGX.RouletteTree.BIND=OGX.RouletteTree.CHANGE,OGX.Router=function(e){"use strict";var t=e,i=window.location.pathname.split("/").slice(-1)[0],n=!1,a=!1,o={history:!0,reload:!1};function r(e){e.preventDefault(),e.stopImmediatePropagation(),n||navigator.app.backHistory()}function s(e){if(n)return e.preventDefault(),e.stopImmediatePropagation(),!1;null!==e.originalEvent.state?app.goto(e.originalEvent.state.url,!1):-1!==window.location.href.indexOf("#")&&app.goto(window.location.href.split("#").pop(),{history:!1})}this.start=function(){$(document).on("backbutton",r),$(window).on("popstate",s)},this.stop=function(){$(document).off("backbutton",r),$(window).off("popstate",s)},this.lock=function(){n=!0},this.unlock=function(){n=!1},this.isLocked=function(){return n},this.addToHist=function(e){var t={url:e};history.pushState(t,"title"+(new Date).getTime(),i+"#"+e)},this.goto=function(e,i,r){if(!n){void 0!==i&&i||(i={}),OGX.Data.merge(i,o);var s=function(e){var i,n,a,o,r,s=[];for(var l in t.routes){for(-1!==(r=l).indexOf(":OML")&&(r=r.replace(":OML","")),a=r;n=/(?!\/)([a-z0-9_\-]+)\:([^\/]+)/gi.exec(a);)a=a.replace(n[0],n[2]),s.push(n[1]);if((i=e.match("^"+a+"$"))&&i.length){i.shift(),-1!==l.indexOf(":OML")&&(t.routes[r]=OGX.Cache.get("oml",t.routes[l]),delete t.routes[l],l=r);var d=JSON.parse(JSON.stringify(t.routes[l]));o={};for(var c=0;c<i.length;c++)o[s[c]]=i[c];return{stage:e.split("/").shift(),route:d,data:o,pattern:l}}}return!1}(e);if(s){if(s.route.hasOwnProperty("scope")||(s.route.scope=["public"]),!OGX.Scope.check(s.route.scope))return t.errors[403]?setTimeout((function(){app.goto(t.errors[403],{history:!1})}),0):$(document).trigger(OGX.Router.FORBIDDEN,{url:e,scope:s.route.scope}),!1;delete s.route.scope;var l=OGX.Object.get({_NAME_:{eq:OGX.Stage.NAME},id:{eq:s.stage}},null,1);if(s.route.hasOwnProperty("origin:Route")){for(var d,c=!1,u=s.route["origin:Route"].split(","),h=0;h<u.length;h++)if("self"===u[h]){if(d=s.pattern.replace(/([a-z]+:)/,""),RegExp(d).test(l.url)){c=!0;break}}else if(0===l.url.indexOf(u[h])){c=!0;break}if(!c)return void app.goto(s.route["origin:Route"]);delete s.route["origin:Route"]}s.url=e,a=s.pattern;var _,f,g=app.getStage(),p=!0,m=!0;if(s.stage!==g.id&&(g=app.cfind(OGX.Stage.NAME,s.stage),m=!1),g.url===s.url)if(i.reload)for(var v in s.route)_=v.split(":")[0],(f=g.nodes.get({selector:{eq:_}},null,1))&&app.find(f._NAME_,f.id,"remove");else p=!1;else m&&(y=g,x=s.route,G=y.gather(),function e(t){var i,n=/(Fork|Data|Route)/gi;for(var a in t)-1!==a.indexOf(":")&&(O=a.split(":").shift(),b=a.split(":").pop(),n.test(b)?"Fork"===b&&e(OGX.Scope.match(t[a]).node):((i=G.get({selector:{eq:O}},null,1))&&(w=!0,y.find(i._NAME_,i.id,"remove"),G.unset({_NAME_:{eq:i._NAME_},id:{eq:i.id}}),$(O).empty()),w||$(O).empty()))}(x));m||(app.showStage(s.stage),g=app.getStage()),g.pattern=a,g.url=s.url;return s.route,p&&OGX.OML.render(g,s.route,r,s.data),p&&i.history&&this.addToHist(e),!0}return t.errors[404]?setTimeout((function(){app.goto(t.errors[404],{history:!1})}),0):$(document).trigger(OGX.Router.NOT_FOUND,{url:e}),!1}var y,x,O,b,w,G;return!1}},OGX.Router.BACK="RouterBack",OGX.Router.EXIT="ReouterExit",OGX.Router.FORBIDDEN="403",OGX.Router.NOT_FOUND="404",OGX.Scope=function(e){"use strict";var t=["public"],i=!1,n=e;this.getScope=function(){return t},this.setScope=function(e){return!n&&(t=e,!0)},this.setToken=function(e,n){var a=function(e){var t=JSON.parse(atob(e.split(".")[1]));if(t)return t;return!1}(e);return!(!a||a.iss!==n)&&(i=e,t=a.scope.split(" "),!0)},this.hasToken=function(){return!!i},this.check=function(e){for(var i=0;i<t.length;i++)if(-1!==e.indexOf(t[i]))return!0;return!1},this.match=function(e){var t,i,n=new OGX.List;for(var a in e){i=0,t=a.split(",");for(var o=0;o<t.length;o++)for(var r=0;r<a.length;r++)t[o]===a[r]&&i++;i&&n.push({node:e[a],t:i})}return!!n.length&&(n.order("t",-1),n[0])}},require("Scroller","Uxi","Touch"),OGX.Scroller=function(e){construct(this,"Scroller");var t,i,n,a,o,r,s,l,d,c,u,h=this,_=e,f={fade_speed:300,check_delay:100,css:!1,zindex:9999,observe:!0,auto_scroll:!1,scroll_callback:!1,trigger:!0},g=0,p="init",m=!1;function v(e){e?i.on(h.touch.down,y):i.off(h.touch.down,y)}function y(e){e=h.event(e),C(!1),b(!0),x(!0),v(!1),D("in"),E(!0)}function x(e){e?(c=setInterval(X,10),i.on(h.touch.move,O)):(clearInterval(c),i.off(h.touch.move,O))}function O(e){e=h.event(e)}function b(e){e?$(document).on(h.touch.up,w):$(document).off(h.touch.up,w)}function w(){x(!1),b(!1),v(!0),D("out")}function G(e){e?(window.addEventListener("resize",L),i.on("scroll",(function(e){e.stopImmediatePropagation(),X()})),void 0!==OGX.NestedList&&$(document).on(OGX.NestedList.OPENED+" "+OGX.NestedList.CLOSED,(function(){h.update()}))):(window.removeEventListener("resize",L),i.off("scroll"),void 0!==OGX.NestedList&&$(document).off(OGX.NestedList.OPENED+" "+OGX.NestedList.CLOSED))}function X(){var e,n=(e=i.scrollTop())/s,a=Math.round(o.position().top);o.css("top",n+"px"),_.trigger&&!m&&(h.el.trigger(OGX.Scroller.SCROLL,e),-1*e==i.outerHeight(!0)-t.outerHeight(!0)?a!==Math.round(n)&&h.el.trigger(OGX.Scroller.BOTTOM):0===e&&a!==Math.round(n)&&h.el.trigger(OGX.Scroller.TOP)),_.scroll_callback&&_.scroll_callback()}function E(e){e?(d&&E(!1),l=t.position().top,d=setInterval(T,_.check_delay-10)):d&&(clearInterval(d),d=null)}function T(){var e=t.position().top;D(e!==l?"in":"out"),l=e}function C(e){e?u=setInterval(X,_.check_delay):clearInterval(u)}function D(e){_.fade_speed;var t=o.css("opacity");o.removeClass("ogx_scroller_track_anim_fade_in"),o.removeClass("ogx_scroller_track_anim_fade_out"),o.hasClass("ogx_scroller_track_anim")||o.addClass("ogx_scroller_track_anim"),"in"===e?o.addClass("ogx_scroller_track_anim_fade_in"):o.addClass("ogx_scroller_track_anim_fade_out")}function M(e){e?h.observe(!0,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["class","src","width","height"]},S):h.observe(!1)}function S(){g!==t.height()&&(g=t.height(),L(),_.auto_scroll&&h.bottom())}function L(){if(a=i.innerHeight(),n=t.height(),s=n/a,n>a){var e=Math.round(a/s);o.css("height",e+"px"),r.css("display","block")}else r.css("display","none");"init"===p&&(p=OGX.Scroller.READY,h.el.trigger(OGX.Scroller.READY))}this._NAME_=OGX.Scroller.NAME,this.el=null,this.enable=function(){L(),G(!0),_.observe&&setTimeout((function(){M(!0)}),0),v(!0)},this.disable=function(){G(!1),_.observe&&M(!1),b(!1),x(!1),v(!1),E(!1),C(!1),o.removeClass("ogx_scroller_track_anim_fade_in"),o.removeClass("ogx_scroller_track_anim_fade_out")},this.resize=function(){L()},this.destroy=function(){h.el.removeClass("ogx_scroller_outer"),t.remove(),r.remove()},this.top=function(){n>a&&(i[0].scrollTop=0,L())},this.bottom=function(){n>a&&(i.scrollTop(n),L())},this.mute=function(){m=!0},this.vocal=function(){m=!1},this.container=function(){return t},this.inner=function(){return t[0]},this.outer=function(){return i[0]},this.state=function(){return p},OGX.Data.merge(_,f),function(){h.el=$(_.el),h.el.addClass("ogx_scroller_outer ogx_hw");var e=(i=h.el).html();i.html('<div class="ogx_scroller_inner ogx_hw"></div>'),(t=i.children(".ogx_scroller_inner:first")).html(e);var n="ogx_scroller_track ogx_hw";_.css&&(n+=" "+_.css);var a="<div class="+n+'" style="z-index:'+_.zindex+';"><div class="ogx_scroller_track_button"></div></div>';i.parent().append(a),r=i.parent().find(".ogx_scroller_track:first"),o=r.find(".ogx_scroller_track_button:first")}(),L()},OGX.Scroller.NAME="Scroller",OGX.Scroller.READY="ScrollerReady",OGX.Scroller.TOP="ScrollerTop",OGX.Scroller.BOTTOM="ScrollerBottom",OGX.Scroller.SCROLL="ScrollerScroll",require("StackedTree","Uxi","Touch"),OGX.StackedTree=function(e){construct(this,"StackedTree");var t,i,n,a,o=this,r={scope:["public"],speed:200,list:[],display:{html:"{{$label}}"},displays:!1,chromeos:!1},s=e,l=[],d=[0],c=0,u=!1,h="ogx_stacked_tree";function _(e){e?(t.on(o.touch.down,"."+h+"_level_prev",f),t.on(OGX.DynamicList.SELECT,g)):(t.off(o.touch.down,"."+h+"_level_prev",f),t.off(OGX.DynamicList.SELECT,g))}function f(e){e.preventDefault(),e.stopImmediatePropagation(),y(--c,!0),d.pop(),o.el.trigger(OGX.StackedTree.BACK)}function g(e,t){u=t;var i=l[c].findIndex("__id__",t.__id__);t.hasOwnProperty("items")&&t.items.length&&function(e){if(!e.hasOwnProperty("scope"))return!0;for(var t=0;t<s.scope.length;t++)if(-1!==e.scope.indexOf(s.scope[t]))return!0;return!1}(t)?(d.push(i),v(++c,t.items),o.el.trigger(OGX.StackedTree.ENTER,t),setTimeout((function(){y(c)}),0)):o.el.trigger(OGX.StackedTree.SELECT,t)}function p(e){e?$(window).on("resize",m):$(window).off("resize",m)}function m(){i.removeClass(h+"_anim"),n=i.width(),i.css("transform","translateX("+c*Math.round(n/d.length)*-1+"px)")}function v(e,t){i.removeClass(h+"_anim").css("width",100*(e+1)+"%"),n=i.width();var r,d='<div class="'+h+'_level" data-level="'+e+'">';e>0&&(r=(r=a.css(u)).replace(h+"_door",""),d+='<div class="'+h+"_item ogx_stacked_tree_level_prev "+r+'">'+a.html(u)+"</div>"),d+='<div class="'+h+'_level_list"></div></div>',i.append(d);var c=i.children("."+h+'_level[data-level="'+e+'"]').children("."+h+"_level_list");i.children("."+h+"_level").css("flex-basis",Math.floor(100/(e+1)*100)/100+"%"),function(e,t,i){l[e]&&o.remove(l[e].id,OGX.DynamicList.NAME);var n=o.create("DynamicList",{el:t,mode:"hit",scroll:!0,display:s.display,displays:s.displays,list:i});l[e]=n}(e,c[0],t)}function y(e,t){i.addClass(h+"_anim"),void 0!==t&&t&&(_(!1),i.on("transitionend",(function(){i.off("transitionend"),i.removeClass(h+"_anim").css("width",100*(e+1)+"%"),o.remove(l[e+1].id,OGX.DynamicList.NAME),l.splice(e+1,1),i.children("."+h+'_level[data-level="'+(e+1)+'"]').remove(),i.children("."+h+"_level").css("flex-basis",Math.floor(100/(e+1)*100)/100+"%"),n=i.width(),u=!1,_(!0)}))),n=i.width(),i.css("transform","translateX("+e*Math.round(n/d.length)*-1+"px)")}this._NAME_=OGX.StackedTree.NAME,this.el=null,this.enable=function(){this.touch.enable(),_(!0),p(!0)},this.disable=function(){this.touch.disable(),_(!1),p(!1)},this.resize=function(){m()},this.destroy=function(){},this.setTree=function(e){if(e.length){var t=e.slice();return s.list={items:t},!0}return!1},this.setScope=function(e){s.scope=e,d=[0],c=0,u=!1},function(){s=OGX.Data.merge(s,r,!1,!0);var e=(a=new OGX.Display(s)).val();if(e=function(e){if(e.display&&"object"==typeof e.display&&!e.display.hasOwnProperty("bind")&&(e.display=i(e.display)),e.displays)for(var t in e.displays)e.displays[t]=i(e.displays[t]);function i(e){var t=['{{return typeof($items) !== "undefined" && $items.length > 0}}',{add:"ogx_stacked_tree_door"}];if(e.hasOwnProperty("css"))if("object"==typeof e.css)e.css.hasOwnProperty("add")&&e.css.add?e.css.add+=" ogx_stacked_tree_item":e.css.add="ogx_stacked_tree_item",e.css.hasOwnProperty("conditions")?e.css.conditions.push(t):e.css.conditions=[t];else{var i="";e.css&&(i=e.css),i+=" ogx_stacked_tree_item",e.css={add:i,conditions:[t]}}else e.css={add:"ogx_stacked_tree_item",conditions:[t]};return e}return e}(e),a.val(e),s.display=e.display,s.displays=e.displays,o.el=t=$(s.el),t.addClass(h),s.list.length){var i=s.list.slice();s.list={items:i}}}(),t.html('<div class="'+h+'_container" style="width:100%"></div>'),i=t.children("."+h+"_container:first"),s.list.items.length&&v(d[0],s.list.items)},OGX.StackedTree.NAME="StackedTree",OGX.StackedTree.BACK="StackedTreeBack",OGX.StackedTree.ENTER="StackedTreeEnter",OGX.StackedTree.SELECT="StackedTreeSelect",require("Stage","Uxi","Touch"),OGX.Stage=function(e){construct(this,"Stage");var t=this,i=e;function n(e){e?t.el.on(t.touch.down,".ogx_stage_exit",(function(){app.theater.show()})):t.el.off(t.touch.down,".ogx_stage_exit")}this.el=null,this.id=i.id,this.anim=i.anim,this.theater=!1,this.home=null,this.url=null,this.route=null,this._NAME_=OGX.Stage.NAME,this.__destroy=function(){i.closeable&&n(!1)},function(){i.hasOwnProperty("theater")&&(t.theater=i.theater),t.home=i.home;var e=new OGX.Display(i),a="block";i.hasOwnProperty("use")&&i.use||(a="none");var o="";i.closeable&&(o='<div class="ogx_stage_exit"></div>'),o+=e.html(),t.el=container=$(i.el),container.html(o),container.addClass("ogx_stage").css("display",a),i.closeable&&n(!0)}()},OGX.Stage.NAME="Stage",OGX.Stage.SWAP="swap",OGX.Stage.FLIP="flip",require("Switch","Uxi","Bind","Touch"),OGX.Switch=function(e){construct(this,"Switch");var t,i=this,n=e,a={el:"document",bind:!1,labels:!0,data:[{label:"OFF",value:!1},{label:"ON",value:!0}],value:!0,name:"ogx_switch_check"},o="ogx_switch";function r(){n.value===n.data[0].value?n.value=n.data[1].value:n.value=n.data[0].value,setTimeout(s,0)}function s(){var e=t.find("."+o+"_dot:first"),i=t.find("."+o+"_label:first"),a=t.find("."+o+"_label:last");n.value===n.data[0].value?(e.removeClass(o+"_dot_right").addClass(o+"_dot_left"),i.removeClass(o+"_label_off").addClass(o+"_label_on").addClass(o+"_selected"),a.removeClass(o+"_label_on").addClass(o+"_label_off").removeClass(o+"_selected")):(e.removeClass(o+"_dot_left").addClass(o+"_dot_right"),a.removeClass(o+"_label_off").addClass(o+"_label_on").addClass(o+"_selected"),i.removeClass(o+"_label_on").addClass(o+"_label_off").removeClass(o+"_selected")),t.find("."+o+"_val:first").attr("value",n.value)}function l(e){e?t.on(i.touch.down,d):t.off(i.touch.down,d)}function d(e){e.preventDefault(),e.stopImmediatePropagation(),r(),c(!1),t.trigger(OGX.Switch.CHANGE,n.value),t.children("."+o+"_val:first").trigger("change"),c(!0)}function c(e){e?t.on("change","input[type=hidden]",(function(e){n.value=OGX.Data.stringToVal(e.target.value),s()})):t.off("change","input[type=hidden]")}this._NAME_=OGX.Switch.NAME,this.el=null,this.enable=function(){l(!0),c(!0),t.removeClass(o+"_disabled")},this.disable=function(){l(!1),c(!1),t.addClass(o+"_disabled")},this.bindRender=function(e,t){},this.val=function(e){return void 0!==e&&n.value!==e&&r(),n.value},this.toggle=function(){r()},function(){n||(n={}),OGX.Data.merge(n,a),i.el=t=$(n.el),t.addClass(o+"_disabled");var e=t.parent();e[0].hasAttribute("data-value")&&(n.value=OGX.Data.stringToVal(e.data("value")),e.removeAttr("data-value"))}(),function(){var e="";n.labels&&(e+='<span class="'+o+'_label_on ogx_switch_label">'+n.data[0].label+"</span>");var i="";n.value===n.data[1].value&&(i=o+"_dot_right"),e+='<div class="'+o+'_track"><div class="'+o+'_track_bg"></div><div class="'+o+"_dot "+i+'"></div></div>',n.labels&&(e+='<span class="'+o+'_label_off ogx_switch_label">'+n.data[1].label+"</span>"),e+='<input class="'+o+'_val" type="hidden" name="'+n.name+'" value="'+n.value+'"></div>',t.html(e),t.addClass(o)}(),setTimeout(s,0)},OGX.Switch.NAME="Switch",OGX.Switch.CHANGE="SwitchChange",OGX.Switch.BIND=OGX.Switch.CHANGE,require("Tabs","Uxi","Touch"),OGX.Tabs=function(e){construct(this,"Tabs");var t,i=this,n=e,a={editable:!0,detachable:!1,detach_min:20,reorder:!0,icons:!1,index:0,list:new OGX.List,display:{html:"",css:""}},o=!1,r=0,s=!1,l=!1,d=!1,c=!1,u=!1,h={x:0,y:0},_="ogx_tabs";function f(){for(var e,i,a='<div class="'+_+'_container">',s=0;s<n.list.length;s++)i=n.display.css(n.list[s]),s===r&&(i+=" ogx_tabs_tab_active"),a+='<div class="'+_+"_tab "+i+'">',e=!1,"string"==typeof n.list[s]?e=n.list[s]:n.list[s].hasOwnProperty("label")&&(e=n.list[s].label),e&&(a+='<span class="'+_+'_tab_label">'+e+"</span>"),n.editable&&(a+='<span class="'+_+'_tab_close"><span></span></span>'),a+="</div>",i="";a+="</div>",n.editable&&(a+='<div class="'+_+'_tab_add"><span></span></div>',t.addClass(_+"_editable")),t.html(a),o=t.children("."+_+"_container:first").children("."+_+"_tab:eq("+r+")")}function g(e){s||(u=!1,l=$(e),d={from:l.index()},t.children("."+_+"_container:first").children("."+_+"_tab_active:first").removeClass(_+"_tab_active"),h.x=l.position().left,h.y=l.position().top,(s={el:$(e).clone(),x:h.x,y:l.position().top}).w=l.width(),s.el.width(s.w),l.addClass(_+"_tab_active").addClass(_+"_frozen"),o=l,s.el.addClass(_+"_tab_active").addClass(_+"_float").css("transform","translate3d("+h.x+"px, "+s.y+"px, 0px)"),t.children("."+_+"_container:first").prepend(s.el),c=setInterval(m,5))}function p(e,a){if(s)if(u=a,Math.abs(a.x)>Math.abs(a.y)){var o=s.x+a.x;s.el.css("transform","translate3d("+o+"px, "+s.y+"px, 0px)")}else{var r=s.y+a.y;if(s.el.css("transform","translate3d("+s.x+"px, "+r+"px, 0px)"),Math.abs(a.y)>4){d.to=l.index(),v();var c=n.list[d.from];"object"==typeof c&&(c=c.label);var h={label:c,index:d.to};i.removeTabAt(d.to),t.trigger(OGX.Tabs.REMOVE,h)}}}function m(){var e,i,n;s&&u&&(idx=l.index(),Math.abs(u.x)>Math.abs(u.y)&&t.children("."+_+"_container:first").children("."+_+"_tab").each((function(t,a){(e=$(a)).hasClass(_+"_tab_active")||(i=e.position(),n=e.width(),idx!==t&&(s.x+u.x>i.left+n/2&&s.x+u.x<i.left+n?(l.detach(),e.after(l)):s.x+u.x>i.left&&s.x+u.x<i.left+n/2&&(l.detach(),e.before(l))))})))}function v(){if(s&&(clearInterval(c),c=!1,u=!1,s.el.remove(),s=!1,l.removeClass(_+"_frozen"),d.to=l.index(),d.to!==d.from)){var e=n.list.splice(d.from,1);n.list.insert(e[0],d.to),r=d.to,i.el.trigger(OGX.Tabs.REORDER,d)}}function y(e){e?(t.on("click","."+_+"_tab",(function(){o&&o.removeClass(_+"_tab_active"),$(this).addClass(_+"_tab_active"),o=$(this),r!==o.index()&&(r=o.index(),t.trigger(OGX.Tabs.SELECT,n.list[o.index()]))})),n.editable&&t.on("click","."+_+"_tab_close",(function(e){return e.preventDefault(),e.stopImmediatePropagation(),t.trigger(OGX.Tabs.CLOSE,{index:r,tab:n.list[r]}),i.removeCurrentTab(),updateContainerWidth(),!1}))):(t.off("click","."+_+"_tab"),n.editable&&(t.off("click","."+_+"_tab_add"),t.off("click","."+_+"_tab_close")))}this._NAME_=OGX.Tabs.NAME,this.el=null,this.enable=function(){y(!0),n.reorder&&this.touch.hold.enable()},this.disable=function(){y(!1),n.reorder&&this.touch.hold.disable()},this.val=function(e){if(void 0===e)return o;var t;"string"==typeof e?t=n.list.indexOf(e):e.hasOwnProperty("label")&&(t=(t=n.list.findIndex("label",e.label)).index),this.selectIndex(t)},this.set=function(e){if(void 0===e)return n.list;e.hasOwnProperty("insert")||(e=new OGX.List(e)),n.list=e,setTimeout(f,0)},this.selectIndex=function(e){e!==r&&this.selectTabAt(e)},this.index=function(){return o?r:-1},this.addTab=function(e){n.icons&&(e.hasOwnProperty("icon")||(e.icon=n.icon_default)),n.list.push(e),r=n.list.length-1,setTimeout((function(){var e,i,n;f(),e=t.width(),i=t.children("."+_+"_container:first"),(n=i.width())>e&&i.css("transform","translateX("+-1*(n-e)+"px)")}),0)},this.addTabAt=function(e,t){n.icons&&(e.hasOwnProperty("icon")||(e.icon=n.icon_default)),n.list.insert(e,t),r=t,setTimeout(f,0)},this.removeCurrentTab=function(){o&&this.removeTabAt(r)},this.removeTabAt=function(e){return!!n.list.delete(e)&&(t.children("."+_+"_container:first").children("."+_+"_tab:eq("+e+")").remove(),o=null,function(){r>0?r--:r=0;i.selectTabAt(r)}(),!0)},this.selectTabAt=function(e){return o&&(o.removeClass(_+"_tab_active"),o=null),(o=t.children("."+_+"_container:first").children("."+_+"_tab:eq("+e+")")).addClass(_+"_tab_active"),r=e,!0},this.selectTab=function(e){o&&o.removeClass(_+"_tab_active");var t=n.list.findIndex("label",e);this.selectTabAt(t.index)},n||(n={}),OGX.Data.merge(n,a),n.list.hasOwnProperty("insert")||(n.list=new OGX.List(n.list)),n.display.hasOwnProperty("_NAME_")||(n.display=new OGX.Display(n.display)),i.el=t=$(n.el),t.addClass(_),r=n.index,setTimeout(f,0),n.reorder&&i.touch.hold.set({target:".ogx_tabs_tab",cb_hold:g,cb_move:p,cb_up:v})},OGX.Tabs.NAME="Tabs",OGX.Tabs.SELECT="TabsSelect",OGX.Tabs.CLOSE="TabsClose",OGX.Tabs.REORDER="TabsReoroder",OGX.Tabs.ADD="TabsAdded",OGX.Tabs.REMOVE="TabsRemoved",require("Tags","Uxi","Touch"),OGX.Tags=function(e){construct(this,"Tags");var t,i,n=this,a=e,o={remove:!0,add:!0,name:!1,tags:[],current_tags:[],tags_ascii:[],mode:OGX.Tags.MODE_STRING,keycode:13,placeholder:"keywords",restrict:!1,strict:!1,max:0,display_max:0,display_more:!1,click_more:!1,more_word:"other"},r={org:[],rem:[]};function s(){var e;e=1===a.max&&a.current_tags.length?JSON.stringify(a.current_tags[0]):JSON.stringify(a.current_tags),t.find("input[type=hidden]").val(e),t.find("input[type=hidden]").trigger("change")}function l(e){var i=!1;switch(a.mode){case OGX.Tags.MODE_STRING:case OGX.Tags.MODE_ASCII:-1===a.current_tags.indexOf(e)&&(a.current_tags.push(e),i=!0);break;case OGX.Tags.MODE_OBJECT:var n=a.current_tags.find("label",e,1);n||((n=a.tags.find("label",e,1))?a.current_tags.push(n):a.current_tags.push({label:e}),i=!0)}if(i){var o="";!0===a.remove&&(o='<span class="ogx_tags_remove"></span>');var r='<span class="ogx_tags_tag"><span>'+e+"</span>"+o+"</span>";t.find(".ogx_tags_tags:first").append(r),s(),t.trigger(OGX.Tags.TAG_ADDED,e),t.trigger(OGX.Tags.CHANGE,[a.current_tags])}t.find(".ogx_tags_input:first").focus()}function d(e){var i=!1;switch(a.mode){case OGX.Tags.MODE_STRING:case OGX.Tags.MODE_ASCII:var n=a.current_tags.indexOf(e);n>-1&&(i=a.current_tags.splice(n,1));break;case OGX.Tags.MODE_OBJECT:i=a.current_tags.findDelete("label",e)}return i&&t.find(".ogx_tags_tags:first").find(".ogx_tags_tag").each((function(t,i){if($(i).find("span:first").text()===e)return $(i).remove(),void s()})),i}function c(e,i){if(e){t.find(".ogx_tags_container:first").length>0&&(c(!1),v(!1));for(var n='<div class="ogx_tags_container">',o=!1,r=0;r<i.length;r++)if("object"==typeof i[r]&&i[r].hasOwnProperty("__m__"))o=i[r].__m__;else switch(a.mode){case OGX.Tags.MODE_STRING:case OGX.Tags.MODE_ASCII:n+='<span class="ogx_tags_tag ogx_tags_container_tag">'+i[r]+"</span>";break;case OGX.Tags.MODE_OBJECT:n+='<span class="ogx_tags_tag ogx_tags_container_tag">'+i[r].label+"</span>"}o&&(n+='<span class="ogx_tags_tag ogx_tags_more">+'+o+" "+a.more_word+"</span>"),n+="</div>",t.append(n),v(!0)}else t.find(".ogx_tags_container").remove(),v(!1)}function u(e){for(var i="",n="",o=0;o<e.length;o++)switch(n=!0===a.remove?'<span class="ogx_tags_remove"></span>':"",a.mode){case OGX.Tags.MODE_STRING:case OGX.Tags.MODE_ASCII:i+='<span class="ogx_tags_tag"><span>'+e[o]+"</span>"+n+"</span>";break;case OGX.Tags.MODE_OBJECT:i+='<span class="ogx_tags_tag"><span>'+e[o].label+"</span>"+n+"</span>"}return a.current_tags=e,t.find(".ogx_tags_tags:first").html(i),s(),!0}function h(e){return e=OGX.Data.clone(e),r={org:OGX.Data.clone(e),rem:[]},Array.isArray(e)&&a.display_max&&e.length>a.display_max&&(r.rem=e.slice(a.display_max),e=e.slice(0,a.display_max)),a.display_more&&r.rem.length&&e.push({__m__:r.rem.length}),new OGX.List(e)}function _(e){e?i.on("keyup",(function(e){var t=$(this).val();if(t.length>=3)if(!a.strict&&e.which===a.keycode&&a.add)l(t),i.val(""),c(!1);else{var n;switch(a.mode){case OGX.Tags.MODE_STRING:n=function(e){for(var t,i=[],n=0;n<a.tags.length;n++)if(t=!1,0===a.tags[n].toLowerCase().indexOf(e.toLowerCase())&&-1===a.current_tags.indexOf(a.tags[n])){if(a.display_max){if(!(i.length+1<=a.display_max))return i;t=!0}else t=!0;t&&i.push(a.tags[n])}return h(i)}(t);break;case OGX.Tags.MODE_OBJECT:n=function(e){var t=new RegExp(e,"gi"),i=a.tags.find("label",t);if(i&&i.length)for(var n=0;n<a.current_tags.length;n++)i.findDelete("label",a.current_tags[n].label);return i&&i.length?h(i):[]}(t);break;case OGX.Tags.MODE_ASCII:n=function(e){var t,i=function(e){for(var t="",i=0;i<e.length;i++)t+=e.toLowerCase().charCodeAt(i).toString();return t}(e.substr(0,3)),n=[];if(a.tags_ascii[i])for(var o=0;o<a.tags_ascii[i].length;o++)if(t=!1,-1!==a.tags_ascii[i][o].toLowerCase().indexOf(e.toLowerCase())&&-1===a.current_tags.indexOf(a.tags[o])){if(a.display_max){if(!(n.length+1<=a.display_max))return n;t=!0}else t=!0;t&&n.push(a.tags_ascii[i][o])}return n&&n.length?h(n):[]}(t)}n.length>0?c(!0,n):c(!1)}else c(!1)})):i.off("keyup")}function f(e){e?t.on(n.touch.down,".ogx_tags_tag",g):t.off(n.touch.down,".ogx_tags_tag",g)}function g(e){var t=$(this).text();switch(a.mode){case OGX.Tags.MODE_OBJECT:t=a.current_tags.get({label:{eq:t}},null,1)}n.el.trigger(OGX.Tags.SELECT,t)}function p(e){e?t.on(n.touch.down,".ogx_tags_more",m):t.off(n.touch.down,".ogx_tags_more",m)}function m(e){e.preventDefault(),e.stopImmediatePropagation(),r.rem.length&&($(this).remove(),c(!0,r.org))}function v(e){e?t.on(n.touch.down,".ogx_tags_container_tag",y):t.off(n.touch.down,".ogx_tags_container_tag",y)}function y(e){l($(this).text()),i.val(""),c(!1),a.max&&a.current_tags.length===a.max&&(_(!1),i.css("display","none"))}function x(e){e?t.on(n.touch.down,".ogx_tags_remove",O):t.off(n.touch.down,".ogx_tags_remove",O)}function O(e){e.preventDefault(),e.stopImmediatePropagation();var n=d($(this).parent("span:first").find("span:first").text());t.trigger(OGX.Tags.TAG_REMOVED,n),t.trigger(OGX.Tags.CHANGE,[a.current_tags]),a.max&&a.current_tags.length<a.max&&(_(!0),i.css("display","block")),i.focus()}this._NAME_=OGX.Tags.NAME,this.el=null,this.enable=function(){a.remove&&(_(!0),v(!0),x(!0)),a.display_more&&a.click_more&&p(!0),f(!0),t.find(".ogx_tags_input:first").prop("placeholder",a.placeholder),t.find(".ogx_tags_input:first").prop("disabled",!1)},this.disable=function(){a.remove&&(_(!1),v(!1),x(!1)),a.display_more&&a.click_more&&p(!1),f(!1),t.find(".ogx_tags_input:first").prop("placeholder",""),t.find(".ogx_tags_input:first").prop("disabled",!0)},this.destroy=function(){a.restrict&&OGX.Form.unrestrictField(t.find(".ogx_tags_input:first")[0])},this.tags=function(e){return void 0!==e?(e.hasOwnProperty("insert")||(e=new OGX.List(e)),a.tags=e,!0):a.tags},this.val=function(e){return c(!1),v(!1),void 0!==e?(e.hasOwnProperty("insert")||(e=new OGX.List(e)),a.current_tags=e,a.max&&a.current_tags.length>=a.max&&t.find(".ogx_tags_input:first").css("display","none"),u(a.current_tags)):a.current_tags},this.clear=function(){a.max&&a.current_tags.length===a.max&&t.find(".ogx_tags_input:first").css("display","block"),a.current_tags=new OGX.List,t.find(".ogx_tags_tags:first").empty()},this.renderTags=function(e){return u(h(e))},this.addTag=function(e){return l(e)},this.removeTag=function(e){return d(e)},function(){for(var e in a||(a={}),o)a.hasOwnProperty(e)||(a[e]=o[e]);a.tags.hasOwnProperty("insert")||(a.tags=new OGX.List(a.tags)),a.current_tags.hasOwnProperty("insert")||(a.current_tags=new OGX.List(a.current_tags)),n.el=t=$(a.el),t.addClass("ogx_tags")}(),function(){var e='<span class="ogx_tags_tags"></span>';if(a.add&&(e+='<input type="text" class="ogx_tags_input" placeholder="'+a.placeholder+'">'),a.name&&(e+='<input type="hidden" name="'+a.name+'">'),t.html(e),i=t.find(".ogx_tags_input:first"),a.restrict){var n={multiline:!1,max:30};"object"==typeof a.restrict&&(n=a.restrict),n.el=i[0],OGX.Form.restrictField(n)}}(),a.current_tags.length>0&&(u(a.current_tags),s())},OGX.Tags.prototype.tagDataset=function(e,t,i){"use strict";void 0===i&&(i=!1);for(var n,a=[],o=0;o<e.length;o++)for(var r=0;r<t.length;r++)if(e[o].hasOwnProperty(t[r])){n=e[o][t[r]].split(" ");for(var s=0;s<n.length;s++)i&&-1!==i.indexOf(n[s])||-1===a.indexOf(n[s])&&a.push(n[s])}return a},OGX.Tags.prototype.tagDatatree=function(e,t){"use strict";!function(e,t){var i=[];if(function e(n){if(n.hasOwnProperty("items"))for(var a=0;a<n.items.length;a++){for(var o in n.items[a])t.indexOf(o)>-1&&-1===i.indexOf(n.items[a][o])&&i.push(n.items[a][o]);return e(n.items[a]),!0}}(e));}(e,t)},OGX.Tags.NAME="Tags",OGX.Tags.CHANGE="TagsChange",OGX.Tags.SELECT="TagsSelect",OGX.Tags.TAG_ADDED="TagsTagAdded",OGX.Tags.TAG_REMOVED="TagsTagRemoved",OGX.Tags.MODE_STRING="string",OGX.Tags.MODE_OBJECT="object",OGX.Tags.MODE_ASCII="ascii",OGX.Tags.BIND=OGX.Tags.CHANGE,OGX.Templater=function(){"use strict";var e,t=this;this.templatize=function(t,i,n,a,o){var r,s;for(e={},void 0===o&&(o={}),OGX.Data.merge(e,o);r=/{{[^{]+(({[^{]+)+)?}}/gi.exec(t);)(s=OGX.OSE.exec(r[0],i,n,a,e))||(s=""),t=t.replace(r[0],s);return t},this.getTemplate=function(e){return function(e){var i;for(;i=/{{ ?template (\S+) ?}}/gi.exec(e);)e=e.replace(i[0],t.getTemplate(i[1]));return e}(OGX.Cache.get("html",e))}},OGX.Templater=new OGX.Templater,require("Theater","Uxi","Touch"),OGX.Theater=function(e){construct(this,"Theater");var t,i,n,a=this,o=e,r={anim:!1,display:!0,icon_size:50,timeout:30},s={template:!1,html:'<span class="ogx_theater_stage_icon" style="background-image:url(\'{{$icon}}\')"></span><span class="ogx_theater_stage_label">{{$label}}</span>'},l='<div class="list"></div>',d=!0;function c(e){e?($(document).on("backbutton",u),$(window).on("popstate",u),list.el.on(OGX.DynamicList.SELECT,(function(e,t){!function(e){a.el.trigger(OGX.Theater.HIDE);var t=app.find(OGX.Stage.NAME,e);t.wake(),t.resizeNodes();var n,r=list.el.find('.ogx_theater_stage[data-ogx-id="'+t.id+'"]').position();a.observe(!0,{childList:!0},(function(){a.observe(!1),(n=i.children(".ogx_theater_trans:first")).on("transitionend",(function(){n.off("transitionend"),a.hide(),n.remove(),t.url?(app.showStage(t.id,!1),app.router.addToHist(t.url)):app.goto(t.id+"/"+t.home)})),n.removeClass("ogx_theater_trans_hide"),setTimeout((function(){n.addClass("ogx_theater_trans_grow").css({opacity:1,width:"100%",height:"100%",transform:"translate3d(0px, 0px, 0px)"})}),o.timeout)}),i),i.append('<div class="ogx_theater_trans ogx_theater_trans_hide" style="width:'+o.icon_size+"px; height:"+o.icon_size+"px; transform:translate3d("+r.left+"px,"+r.top+'px, 0px);" data-ogx-id="'+t.id+'"><div class="icon" style="background-image:url(\'/img/'+t.theater.icon+"')\"></div></div>")}(t.id)}))):($(document).off("backbutton",u),$(window).off("popstate",u),list.el.off(OGX.DynamicList.SELECT))}function u(){a.hide()}function h(){t.prepend(l);for(var e,i=[],r=0;r<n.length;r++)e={id:n[r].id,name:"",icon:""},"object"==typeof n[r].theater&&n[r].theater.hasOwnProperty("icon")&&(e.icon="./img/"+n[r].theater.icon,e.label=n[r].theater.label),i.push(e);$(".ogx_theater > .list").on(OGX.DynamicList.RENDER,(function(e){$(".ogx_theater > .list").off(OGX.DynamicList.RENDER),setTimeout((function(){l=$(".ogx_theater:first").detach()}),0)})),list=a.create("DynamicList",{el:".ogx_theater > .list",display:{html:o.display.html,css:"ogx_theater_stage"},key:"id",scroll:!0,mode:"hit",list:i,trigger:!0})}function _(){var e=app.gather(OGX.Stage.NAME);n=[];for(var t=0;t<e.length;t++)e[t].theater&&n.push(e[t])}this._NAME_=OGX.Theater.NAME,this.update=function(){_()},this.show=function(){d&&(i.prepend(l),function(){a.el.trigger(OGX.Theater.SHOW);var e,n=app.getStage();a.observe(!0,{childList:!0},(function(t){a.observe(!1),n.sleep(),e=i.children(".ogx_theater_trans:first");var r=list.el.find('.ogx_theater_stage[data-ogx-id="'+n.id+'"]').position();e.removeClass("ogx_theater_trans_hide"),setTimeout((function(){e.on("transitionend",(function(){e.off("transitionend"),setTimeout((function(){e.remove()}),0)})),e.addClass("ogx_theater_trans_show").addClass("ogx_theater_trans_shrink").css({opacity:0,width:o.icon_size+"px",height:o.icon_size+"px",transform:"translate3d("+r.left+"px, "+r.top+"px, 0px)"})}),o.timeout)}),i),i.append('<div class="ogx_theater_trans ogx_theater_trans_hide" data-ogx-id="'+n.id+'"><div class="icon" style="background-image:url(\'/img/'+n.theater.icon+"')\"></div></div>"),t.css("visibility","visible")}(),this.focusNodes(),c(!0),d=!1)},this.hide=function(){d||(this.blurNodes(),l=t.detach(),c(!1),d=!0)},this.tile=function(e,t){void 0===t&&(t="x")},OGX.Data.merge(o,r),o.display&&("object"!=typeof o.display&&(o.display={}),OGX.Data.merge(o.display,s),o.display.template&&(o.display.html=OGX.Templater.getTemplate(o.display.template))),a.el=t=$(o.el),t.addClass("ogx_theater").css("visibility","hidden"),i=$("body"),_(),$(document).on(OGX.App.READY,h)},OGX.Theater.NAME="Theater",OGX.Theater.ZOOM="TheaterZoom",OGX.Theater.SHOW="TheaterShow",OGX.Theater.HIDE="TheaterHide",OGX.Touch=function(e){"use strict";var t=this;this.touch=!1,this.touch||this.initTouch(e.chromeos),this.touch.swipe=new OGX.Touches.Swipe(this),this.touch.hold=new OGX.Touches.Hold(this),this.touch.drag=new OGX.Touches.Drag(this),this.touch.enable=function(){t.touch.swipe.enable(),t.touch.hold.enable(),t.touch.drag.enable()},this.touch.disable=function(){t.touch.swipe.disable(),t.touch.hold.disable(),t.touch.drag.disable()}},OGX.Touch.prototype.initTouch=function(e){void 0===e&&(e=!1),this.touch={hold:{}},this.touch.click="click",this.touch.down="mousedown",this.touch.up="mouseup",this.touch.move="mousemove",void 0===window.ontouchstart||e||(this.touch.down="touchstart",this.touch.up="touchend",this.touch.move="touchmove")},OGX.Touch.prototype.touchable=function(){return void 0!==window.ontouchstart},OGX.Touch.prototype.event=function(e){return e.hasOwnProperty("originalEvent")&&void 0!==e.originalEvent.changedTouches?e.originalEvent.changedTouches[0]:e},OGX.Touches={},OGX.Touches.Swipe=function(e){"use strict";var t,i=e,n={speed:10,x:!0,y:!1,min_x:100,min_y:100,cb_down:!1,cb_swipe:!1,cb_up:!1,target:!1},a=!1,o={x:0,y:0},r={x:0,y:0},s=0,l=0,d=0,c=0,u=0,h=!1,_=!1,f=!1;function g(e){f||(f=!0,e=i.event(e),o.x=e.pageX,o.y=e.pageY,d=c=0,s=l=u=0,p(!0),a.cb_down&&a.cb_down(o))}function p(e){e?(m(!0),h=setInterval(O,a.speed)):(m(!1),h&&(clearInterval(h),h=!1))}function m(e){e?t.on(i.touch.move,x):t.off(i.touch.move,x)}function v(e){e?($("body").on(i.touch.up,y),t.on(i.touch.down,g)):($("body").off(i.touch.up,y),t.off(i.touch.down,g))}function y(e,t){_&&(void 0===t&&(t=!1),p(!1),f&&a.cb_up&&a.cb_up({pt0:o,pt1:r,distX:d,distY:c,dist:u,dirX:s,dirY:l,swipe:t}),f=!1)}function x(e){e=i.event(e),r.x=e.pageX,r.y=e.pageY,s=r.x>o.x?1:-1,l=r.y>o.y?1:-1,d=Math.abs(r.x-o.x),c=Math.abs(r.y-o.y),u=Math.sqrt(Math.abs(Math.pow(r.x-o.x,2)-Math.pow(r.y-o.y,2)))}function O(){a.cb_swipe&&(a.x&&a.min_x&&d>=a.min_x||a.y&&a.min_y&&c>=a.min_y?y(0,!0):a.cb_swipe({pt0:o,pt1:r,dirX:s,dirY:l,distX:d,distY:c,dist:u}))}this.set=function(e){a||(a=OGX.Data.clone(n)),OGX.Data.merge(a,e,!0),t=i.el,a.target},this.enable=function(){!_&&a&&(_=!0,v(!0))},this.disable=function(){_&&a&&(_=!1,v(!1),p(!1))}},OGX.Touches.Hold=function(e){"use strict";var t={cb_hold:!1,cb_up:!1,cb_move:!1,time:1e3,el:this.el,target:!1},i=!1,n=!1,a=!1,o=!1,r=!1,s=!1,l=e,d={x:0,y:0},c={x:0,y:0},u=!1;function h(e){e=l.event(e),u=e.target.offsetParent,o||(o=!0,n=(new Date).getTime(),d.x=l.el.offset().left+e.pageX,d.y=l.el.offset().top+e.pageY,$("body").on(l.touch.move,_),a=setInterval(f,1))}function _(e){e=l.event(e),c.x=l.el.offset().left+e.pageX,c.y=l.el.offset().top+e.pageY,!r&&Math.abs(d.x-c.x)>5||Math.abs(d.y-c.y)>5?(clearInterval(a),a=!1):i.cb_move&&i.cb_move(c,{x:c.x-d.x,y:c.y-d.y})}function f(){o&&(new Date).getTime()-n>i.time&&(r||(r=!0,i.cb_hold?i.cb_hold(u):l.el.trigger(OGX.Touch.HOLD_START)))}function g(){r=!1,o=!1,$("body").off(l.touch.move,_),clearInterval(a),a=!1,i.cb_up?i.cb_up():l.el.trigger(OGX.Touch.HOLD_END)}this.set=function(e){i=e,OGX.Data.merge(i,t)},this.enable=function(){!s&&i&&(s=!0,l.el.on(l.touch.down,i.target,h),$("body").on(l.touch.up,g))},this.disable=function(){s&&i&&(s=!1,(o||a)&&(r=!1,o=!1,clearInterval(a),a=!1),l.el.off(l.touch.down,i.target,h),$("body").off(l.touch.up,g),$("body").off(l.touch.move,_))}},OGX.Touches.Drag=function(e){"use strict";var t,i,n,a,o,r,s=!1,l={x:!0,y:!0,min:10,limit_x:null,limit_y:null,target:!1,cb_down:!1,cb_drag:!1,cb_up:!1,border:10},d=e,c=!1,u=!1;function h(e){var t=[];t=s.target?[d.touch.down,s.target,_]:[d.touch.down,_],e?d.el.on.apply(d.el,t):d.el.off.apply(d.el,t)}function _(l){l=e.event(l),n=l.pageX,a=l.pageY;var c=d.el.position();t=c.left,i=c.top;var u=d.el.offset(),h=n-u.left,_=a-u.top;if(s.border){if(h<s.border||h>d.el.width()-s.border)return;if(_<s.border||_>d.el.height()-s.border)return}o=0,r=0,f(!0),g(!0),s.cb_down&&s.cb_down()}function f(e){e?c||(c=setInterval(v,10)):c&&(clearInterval(c),c=null)}function g(e){e?($("body").on(d.touch.move,m),$("body").on(d.touch.up,p)):($("body").off(d.touch.move,m),$("body").off(d.touch.up,p))}function p(t){f(!1),g(!1),t=e.event(t),s.x&&(o=t.pageX-n),s.y&&(r=t.pageY-a),s.cb_up&&s.cb_up({distX:o,distY:r})}function m(t){t=e.event(t);var i,l=!1;s.x&&(i=t.pageX-n,null!==s.limit_x?i>=s.limit_x.min&&i<=s.limit_x.max&&(s.min?Math.abs(i)>s.min&&(o=i,l=!0):(o=i,l=!0)):s.min?Math.abs(i)>s.min&&(o=i,l=!0):o=i),s.y&&(i=t.pageY-a,null!==s.limit_y?i>=s.limit_y.min&&i<=s.limit_y.max&&(s.min?Math.abs(i)>s.min&&(r=i,l=!0):(r=i,l=!0)):r=i),l&&s.cb_drag&&s.cb_drag({distX:o,distY:r})}function v(){d.el.css({transform:"translate3d("+(t+o)+"px, "+(i+r)+"px, 0px)"})}this.dragable=!0,this.set=function(e){s=e,OGX.Data.merge(s,l)},this.enable=function(){!u&&s&&(u=!0,h(!0))},this.disable=function(){u&&s&&(u=!1,h(!1),g(!1),f(!1))}},OGX.Touch.HOLD_START="TouchHoldStart",OGX.Touch.HOLD_END="TouchHoldEnd",require("Tree","Uxi","Touch"),OGX.Tree=function(e){construct(this,"Tree");var t,i,n,a,o,r,s,l,d=this,c=e,u={show_root:!0,root_label:"root",editable:!1,sort:{enabled:!0,property:"label",way:1},toggle:!0,drag_after:1e3,icon_size:30,scope:["public"],chromeos:!1,types:{root:{mode:"folder",icons:{open:"folder_open",close:"folder_closed",empty:null}},file:{mode:"file",icon:"file"},folder:{mode:"folder",icons:{open:"folder_open",close:"folder_closed",empty:null}}},data:{id:0,type:"root",label:c.root_label,state:"closed",items:[]},template:'<div class="ogx_tree_item" data-id="{{$_id_}}"><span class="ogx_tree_item_arrow {{$arrow_style}} {{$arrow_display}}"><span style="width:{{$arrow_size}}; height:{{$arrow_size}}"></span></span><span class="ogx_tree_item_icon {{$icon}}" style="width:{{$size}}px; height:{{$size}}px;"></span><div class="ogx_tree_item_label">{{$label}}</div><div class="ogx_tree_item_container {{$container_display}}"></div></div>'};function h(){var e={icon:X({type:"root",state:"open"}),size:c.icon_size,_id_:c.data._id_,label:c.root_label,container_display:"",arrow_display:"",arrow_style:"ogx_tree_item_arrow_open",arrow_size:Math.round(c.icon_size/2)+"px"};t.html(OGX.Templater.templatize(c.template,e)),c.data.element=t.children(".ogx_tree_item:first")}function _(){h(),f(c.data,c.data.element)}function f(e,t){if(e.hasOwnProperty("items")){var i,n;i=c.sort.enabled?function(e,t,i){return e.sort(function(e,t){return function(i,n){return i[e]<n[e]?-1*t:i[e]>n[e]?t:0}}(t,i)),e}(e.items,c.sort.property,c.sort.way):e.items;for(var a=0;a<i.length;a++)n={icon:null,size:c.icon_size,_id_:e.items[a]._id_,label:e.items[a].label,container_display:"",arrow_display:"",arrow_style:"",arrow_size:Math.round(c.icon_size/2)+"px"},e.items[a].hasOwnProperty("state")||(e.items[a].state="close"),"folder"===E(e.items[a])?(e.items[a].items.length||(e.items[a].state="close",n.arrow_style="ogx_tree_item_arrow_disabled"),"open"===e.items[a].state?n.arrow_style="ogx_tree_item_arrow_open":(n.arrow_style+=" ogx_tree_item_arrow_close",n.container_display="ogx_tree_item_container_hidden"),n.icon=X(e.items[a])):(n.arrow_display="ogx_tree_item_arrow_hidden",n.icon=X(e.items[a])),t.children(".ogx_tree_item_container:last").append(OGX.Templater.templatize(c.template,n)),e.items[a].element=t.children(".ogx_tree_item_container:last").children(".ogx_tree_item:last"),f(e.items[a],e.items[a].element)}}function g(e){var t=JSON.parse(JSON.stringify(e));return delete t._id_,delete t.element,t}function p(e){"folder"===E(e)&&(e.items.length||(e.state="close",e.element.children(".ogx_tree_item_arrow:first").addClass("ogx_tree_item_arrow_disabled")),"open"===e.state?(e.element.children(".ogx_tree_item_arrow:first").removeClass("ogx_tree_item_arrow_close").removeClass("ogx_tree_item_arrow_disabled").addClass("ogx_tree_item_arrow_open"),e.element.children(".ogx_tree_item_container:first").css("display","block")):(e.element.children(".ogx_tree_item_arrow:first").removeClass("ogx_tree_item_arrow_open").addClass("ogx_tree_item_arrow_close"),e.element.children(".ogx_tree_item_container:first").css("display","none")),e.element.children(".ogx_tree_item_icon:first").attr("class","ogx_tree_item_icon "+X(e)))}function m(){if(s){var e=O(s);e&&(e.children(".ogx_tree_item_icon:first").removeClass("ogx_tree_selected_item"),s=null)}}function v(e){return G((function(t,i,n,a){return t._id_===e&&(n.items.splice(a,1),n.items.length||(n.state="close"),p(n),!0)}))}function y(e,t){return G((function(i){return i._id_===t&&(i.items.push(e),i.state="open",p(i),!0)}))}function x(e){return G((function(t,i){return t._id_===e&&t}))}function O(e){var t=x(e);return!!t&&t.element}function b(e){var t=function(e){return G((function(t,i){return e===i+"/"+t.label&&t}))}(e);return!!t&&t.element}function w(){l=1,G((function(e){return e._id_=l++,e.hasOwnProperty("type")||(e.hasOwnProperty("items")?e.type="folder":e.type="file"),!1}))}function G(e,t){var i;if(void 0===t&&(t=c.data),i=function t(n,a,o,r){if(i=e(n,a,o,r))return i;if(n.hasOwnProperty("items")&&n.items.length)for(var s=0;s<n.items.length;s++)if(i=t(n.items[s],a+"/"+n.label,n,s))return i;return!1}(t,""))return i}function X(e){return!!c.types.hasOwnProperty(e.type)&&(c.types[e.type].hasOwnProperty("icons")?"close"===e.state&&!e.items.length&&c.types[e.type].icons.hasOwnProperty("empty")?c.types[e.type].icons.empty:c.types[e.type].icons[e.state]:c.types[e.type].icon)}function E(e){return!!c.types.hasOwnProperty(e.type)&&c.types[e.type].mode}function T(e){var i,n;n=g(x(i=e.data("id"))),c.toggle?e.children(".ogx_tree_item_icon:first").hasClass("ogx_tree_selected_item")?(m(),t.trigger(OGX.Tree.UNSELECT,n)):(m(),e.children(".ogx_tree_item_icon:first").addClass("ogx_tree_selected_item"),s=i,t.trigger(OGX.Tree.SELECT,n)):(m(),e.children(".ogx_tree_item_icon:first").addClass("ogx_tree_selected_item"),t.trigger(OGX.Tree.SELECT,n))}function C(e){e?(c.editable?(t.on(d.touch.down,".ogx_tree_item > .ogx_tree_item_icon",(function(e){e.preventDefault(),T($(this).parent(0)),1!==$(this).parent(0).data("id")&&function(){o&&clearInterval(o);r=(new Date).getTime(),o=setInterval(D,50)}()})),$(document).on(d.touch.up,(function(){S(),n&&(M(!1),function(){var e=n.offset().left,o=n.offset().top,r=(s=e,l=o,G((function(e,t){return d=e.element.offset(),c=e.element.children(".ogx_tree_item_icon:first"),s>=d.left&&s<=d.left+c.width()&&l>=d.top&&l<=d.top+c.height()&&e})));var s,l,d,c;!r||r&&(r._id_===i._id_||"folder"!==E(r))?(a.css("opacity",1),n.remove(),n=null,i=null):(h=r,v((u=i)._id_),y(u,h._id_),h.element.children(".ogx_tree_item_container:first").empty(),h.state="open",f(h,h.element),p(h),a.remove(),n.remove(),n=null,t.trigger(OGX.Tree.DROP,i),i=null);var u,h}())}))):t.on("click",".ogx_tree_item > .ogx_tree_item_icon",(function(e){e.preventDefault(),T($(this).parent(0))})),t.on(d.touch.down,".ogx_tree_item_arrow",(function(e){if(e.preventDefault(),S(),$(this).parent(0).children(".ogx_tree_item_container:first").children().length>0){var i=x($(this).parent(0).data("id"));"open"===i.state?(i.state="close",t.trigger(OGX.Tree.CLOSE,i)):(i.state="open",t.trigger(OGX.Tree.OPEN,i)),p(i)}}))):(c.editable?t.off(d.touch.down,".ogx_tree_item > .ogx_tree_item_icon"):t.off("click",".ogx_tree_item > .ogx_tree_item_icon"),t.off(d.touch.down,".ogx_tree_item_arrow"))}function D(){var e;(new Date).getTime()-r>=c.drag_after&&(s&&(i=x(s))&&(e=i.element,a=e,(n=e.clone()).children(".ogx_tree_item_arrow:first").css("display","none"),e.css("opacity",.3),n.addClass("ogx_tree_item_drag"),n.css({top:e.offset().top,left:e.offset().left}),t.prepend(n),M(!0),t.trigger(OGX.Tree.DRAG,i)),S())}function M(e){e?$(document).on(d.touch.move,(function(e){e=function(e){if(e.hasOwnProperty("originalEvent")&&void 0!==e.originalEvent.changedTouches)return e.originalEvent.changedTouches[0];return e}(e),n.css({top:e.pageY+"px",left:e.pageX+"px"})})):$(document).off(d.touch.move)}function S(){o&&(clearInterval(o),o=null)}this._NAME_=OGX.Tree.NAME,this.el=null,this.enable=function(){C(!0)},this.disable=function(){C(!1)},this.setIconSize=function(e){c.icon_size=e,t.find(".ogx_tree_item_icon").each((function(t,i){$(i).css({width:e+"px",height:e+"px"})})),$(".ogx_tree_item_arrow span").css({width:Math.round(c.icon_size/2)+"px",height:Math.round(c.icon_size/2)+"px"})},this.addItem=function(e){if(s){var t=x(s);return"folder"===E(t)&&(e._id_=++l,y(e,s),t.element.children(".ogx_tree_item_container:first").empty(),t.state="open",f(t,t.element),t.element.children(".ogx_tree_item_container:first").css("display","block")),!0}return!1},this.selectItemByPropVal=function(e,t){var i,n,a=function(e,t){return G((function(i,n){return!(!i.data.hasOwnProperty(e)||i.data[e]!==t)&&n+"/"+i.label}))}(e,t);return!!a&&(m(),i=a._id_,(n=O(i))&&(s=i,n.children(".ogx_tree_item_icon:first").addClass("ogx_tree_selected_item")),!0)},this.selectItemByPath=function(e){var t=b(e);return!!t&&(m(),t.addClass("ogx_tree_selected_item"),s=t.data("id"),!0)},this.updateSelectedItemDataProperty=function(e,t){return!!s&&(x(s).data[e]=t,!0)},this.updateSelectedItemData=function(e){return!!s&&(x(s).data=e,!0)},this.updateSelectedItemLabel=function(e){if(s){var t=x(s);return t.label=e,O(t._id_).children(".ogx_tree_item_label:first").html(e),!0}return!1},this.deleteItemByPath=function(e){var t=b(e);return!!t&&v(t.data("id"))},this.deleteSelectedItem=function(){return function(){if(s)return G((function(e,t,i,n){if(e._id_===s)return e.element.remove(),i.items.splice(n,1),p(i),!0}));return!1}()},this.getSelectedItem=function(){return function(){if(s)return x(s);return!1}()},this.getTree=function(){var e=G(g,JSON.parse(JSON.stringify(c.data)));if(e)return e},this.setData=function(e){e.hasOwnProperty("types")&&this.setTypes(e.types),e.hasOwnProperty("tree")&&this.setTree(e.tree)},this.setTypes=function(e){c.types=e},this.setTree=function(e){c.data=e,c.data.hasOwnProperty("state")||(c.data.state="open"),w(),_()},this.newTree=function(){l=1,c.data={_id_:l,type:"root",state:"open",label:c.root_label,element:null,items:[]},h()},this.filterTree=function(e){!function(e){var t=[];(function i(n,a,o,r){if(-1!==(a+n.label).indexOf(e)&&t.push(a+"/"+n.label),n.hasOwnProperty("items")&&n.items.length)for(var s=0;s<n.items.length;s++)i(n.items[s],a+"/"+n.label,n,s)})(c.data,"")}(e)},function(){if(OGX.Data.merge(c,u),d.el=t=$(c.el),t.addClass("ogx_tree"),t.attr("data-ogx-id",d.id),Array.isArray(c.data)){var e=JSON.stringify(c.data);c.data={type:"root",label:c.root_label,items:JSON.parse(e)}}}(),w(),c.data&&_()},OGX.Tree.NAME="Tree",OGX.Tree.SELECT="TreeSelect",OGX.Tree.UNSELECT="TreeUnselect",OGX.Tree.OPEN="TreeOpen",OGX.Tree.CLOSE="TreeClose",OGX.Tree.DRAG="TreeDrag",OGX.Tree.DROP="TreeDrop",require("TreedList","Uxi"),OGX.TreedList=function(e){construct(this,"TreedList");var t=this,i={renderer:"Tree",list:new OGX.List,types:null,display:null,displays:null,group_by:null,group_mode:null,group_param:null},n=e,a=null,o=null;function r(){var e;switch(s(n.list),n.renderer){case OGX.Tree.NAME:r={el:n.el,data:void 0},n.types&&(r.types=n.types),r.tree=(function e(t,i){if(Array.isArray(t)){for(var n=0;n<t.length;n++)t[n].type="file";i.items=t}else for(var a in t)i.items.push({type:"folder",label:a,state:"open",items:[]}),e(t[a],i.items[i.items.length-1])}(a,e={type:"root",label:"root",state:"open",items:[]}),e),o=t.create(n.renderer,r);break;case OGX.StackedTree.NAME:(r=function(){var e={display:!1,displays:!1};n.display&&n.display.hasOwnProperty("bind")?(e.display=OGX.Data.clone(n.display),e.displays=OGX.Data.clone(n.displays)):(e.display={bind:"__type"},e.displays={__default:OGX.Data.clone(n.display)},"object"==typeof e.displays.__default.css?e.displays.__default.css.hasOwnProperty("add")?e.displays.__default.css.add+=" ogx_stacked_tree_item":e.displays.__default.css.add="ogx_stacked_tree_item":e.displays.__default.css={add:e.displays.__default.css+" ogx_stacked_tree_item"});for(var t=0;t<n.group_by.length;t++)grp=n.group_by[t],e.displays[grp]={html:"{{$label}}",css:"ogx_stacked_tree_item"};return e}()).el=n.el;var i=function(){var e={data:[]};return function e(t,i,a,o){var r;if(Array.isArray(t)){for(var s=0;s<t.length;s++)t[s].hasOwnProperty("scope")||(t[s].scope=["public"]);i.items=t}else for(var l in t)r={label:l,__type:n.group_by[o],scope:["public"],items:[]},a?(i.data.push(r),e(t[l],i.data[i.data.length-1],!1,o+1)):(i.items.push(r),e(t[l],i.items[i.items.length-1],!1,o+1))}(a,e,!0,0),e}();r.list=i.data,n.hasOwnProperty("id")&&(r.id=n.id+"_stacked"),o=t.create(n.renderer,r);break;case OGX.RouletteTree.NAME:var r;(r=OGX.Data.clone(n)).hasOwnProperty("id")&&(r.id=r.id+"_roultree"),r.data=a;for(var l=[],d=0;d<n.group_by.length;d++)l.push(n.group_by[d].split(".").pop());r.groups=l,o=t.create(n.renderer,r)}}function s(e,t,i,o){n.list=e,void 0!==t&&(n.group_by=t),void 0!==i&&(n.group_mode=i),void 0!==o&&(n.group_param=o),a=n.list.group(n.group_by,n.group_mode,n.group_param)}this._NAME_=OGX.TreedList.NAME,this.el=null,this.val=function(e,t,i,n){return void 0!==e?(s(e),a):a},this.getRenderer=function(){return o},this.getTree=function(){return a},n&&void 0!==n||(n={}),OGX.Data.merge(n,i),n.list.hasOwnProperty("insert")||(n.list=new OGX.List(n.list)),$(n.el).addClass("ogx_treedlist"),r()},OGX.TreedList.NAME="TreedList",require("Uxi","Overlay","Loading"),OGX.Uxi=function(e){construct(this,"Uxi"),this.sleeping=!1,this.blured=!0,this.floating=!1,this.scroll=!1,this.enabled=!1,this.always_on=!1,this.nodes=new OGX.List,this.points={},this.observer=!1,this.parent=null,this.floats=null,config_default={id:(new Date).getTime()+""+Math.round(1e3*Math.random()),enabled:!0,always_on:!1,scroll:!1,el:!1};var t=!1;void 0===e&&(e={}),OGX.Data.merge(e,config_default),this.id=e.id,this.enabled=e.enabled,this.always_on=e.always_on,this.scroll=e.scroll,this.selector=e.el;var i="#"===this.id.substr(0,1);if(i&&(this.id=this.id.substr(1)),e.el){var n=$(e.el),a="ogx_uxi";!this.enabled&&(a+=" ogx_uxi_disabled");var o='<div class="'+a+'" data-ogx-id="'+this.id+'"';i&&(o+=' id="'+this.id+'"'),o+="></div>",e.scroll?(t=this.create("Scroller",{id:this.id+"_scroller",el:e.el}),e.el=t.inner(),(n=$(e.el)).addClass(a).attr("data-ogx-id",this.id),i&&n.attr("id",this.id),setTimeout((function(){t.resize()}),0)):(n.append(o),e.el='.ogx_uxi[data-ogx-id="'+this.id+'"]')}},OGX.Uxi.prototype.enable=function(){},OGX.Uxi.prototype.disable=function(){},OGX.Uxi.prototype.ux=function(){},OGX.Uxi.prototype.construct=function(){},OGX.Uxi.prototype.destroy=function(){},OGX.Uxi.prototype.resize=function(){},OGX.Uxi.prototype.show=function(){this.el&&this.el.removeClass("ogx_uxi_hide")},OGX.Uxi.prototype.hide=function(){this.el&&this.el.addClass("ogx_uxi_hide")},OGX.Uxi.prototype.observe=function(e,t,i,n){var a=this,o=this.el;if(void 0!==n&&(o=n),e){if(!this.observer)return void 0===t&&(t={childList:!0,subtree:!0}),this.observer=new MutationObserver((function(e,t){e.forEach((function(e){void 0!==i?i(e):a.el.trigger(OGX.View.CHANGED,e)}))})),this.observer.observe(o[0],t),!0}else if(this.observer)return this.observer.disconnect(),this.observer=null,!0;return!1},OGX.Uxi.prototype.sleep=function(){this.sleeping||(this.blur(),this.sleeping=!0,this.scroll?(this.__parent=this.el.parent(".ogx_scroller_outer:first").parent(0),this.el=this.__parent.children(".ogx_scroller_outer:first").detach()):(this.__parent=this.el.parent(0),this.el=this.el.detach()))},OGX.Uxi.prototype.wake=function(e){e=void 0===e?this.__parent:$(e),this.sleeping&&(this.sleeping=!1,e.prepend(this.el),this.el=e.find('.ogx_uxi[data-ogx-id="'+this.id+'"]'),this.focus(),delete this.__parent)},OGX.Uxi.prototype.resizeNodes=function(){for(var e=this.gather(),t=0;t<e.length;t++)e[t].resize()},OGX.Uxi.prototype.kill=function(){OGX.Object.destroy(this)},OGX.Uxi.prototype.reveal=function(){var e=this.path();if(e){for(var t=0;t<e.length;t++)t>0&&e[t]._NAME_===OGX.Carousel.NAME&&e[t-1]._NAME_===OGX.Container.NAME||(e[t].floating?e[t].show():e[t].show(this._NAME_,this.id));return!0}},OGX.Uxi.prototype.focus=function(e){if(void 0===e&&(e=1),this.blured)switch(this.blured=!1,this.enabled&&(this.ux(!0),this.enable()),e){case 1:this.focusNodes();break;case 2:this.focusTree()}},OGX.Uxi.prototype.focusTree=function(){for(var e=this.gather(),t=0;t<e.length;t++)"function"==typeof e[t].focus&&e[t].focus(0)},OGX.Uxi.prototype.focusNodes=function(){for(var e=0;e<this.nodes.length;e++)"function"==typeof this.nodes[e].focus&&this.nodes[e].focus(1)},OGX.Uxi.prototype.blur=function(e){if(void 0===e&&(e=1),!this.always_on&&!this.blured)switch(this.blured=!0,this.ux(!1),this.disable(),e){case 1:this.blurNodes();break;case 2:this.blurTree()}},OGX.Uxi.prototype.blurTree=function(){for(var e=this.gather(),t=0;t<e.length;t++)"function"==typeof e[t].blur&&e[t].blur(0)},OGX.Uxi.prototype.blurNodes=function(){for(var e=0;e<this.nodes.length;e++)"function"==typeof this.nodes[e].blur&&this.nodes[e].blur(1)},OGX.Uxi.prototype.path=function(){for(var e=new OGX.List,t=this;t&&t.hasOwnProperty("parent");)e.insert(t,0),t=t.parent;return e.shift(),e},OGX.Uxi.prototype.gather=function(e){var t=[],i={_NAME_:{eq:""}};return void 0!==e&&(i=Array.isArray(e)?{_NAME_:{regex:new RegExp(e.join("|"))}}:{_NAME_:{regex:new RegExp(e)}}),function e(n){if(void 0!==n&&void 0!==n.nodes&&n.nodes.length){var a=n.nodes.get(i);a&&(t=t.concat(a));for(var o=0;o<n.nodes.length;o++)void 0!==n.nodes[o]&&void 0!==n.nodes[o].nodes&&n.nodes[o].nodes.length&&(a=e(n.nodes[o]))&&a.length&&(t=t.concat(a[0]))}}(this),new OGX.List(t)},OGX.Uxi.prototype.cfind=function(e,t,i){var n;n=t instanceof RegExp?{id:{regex:t}}:{id:{eq:t}},e&&(n._NAME_={eq:e}),void 0===i&&(i=1);var a=OGX.Object.get(n,null,i);return(1===i||!!a.length)&&a},OGX.Uxi.prototype.find=function(e,t,i){var n;return void 0===i&&(i=!1),n=t instanceof RegExp?{id:{regex:t}}:{id:{eq:t}},e&&(n._NAME_={eq:e}),function e(a){var o;if(void 0!==a.nodes&&a.nodes.length){if(o=a.nodes.get(n,null,1)){if(i)switch(i){case"remove":return o.kill(),a.nodes.findDelete("id",t,1)}return o}for(var r=0;r<a.nodes.length;r++)if(o=e(a.nodes[r]))return o}return!1}(this)},OGX.Uxi.prototype.clear=function(){for(var e=this.gather(),t=0;t<e.length;t++)OGX.Object.destroy(e[t],!1);return this.nodes=new OGX.List,!0},OGX.Uxi.prototype.add=function(e){e.parent=this,this.nodes.insert(e)},OGX.Uxi.prototype.remove=function(e,t){return this.find(e,t,"remove")},OGX.Uxi.prototype.create=function(e,t){"undefined"==typeof __construct&&(__construct=!0);var i=Array.prototype.slice.call(arguments),n=[];t.hasOwnProperty("data")&&n.push(t.data),n=n.concat(i.splice(0,3)),void 0!==OGX[e]&&OGX[e].hasOwnProperty("FLOAT")&&OGX[e].FLOAT&&(t.parent=this,t.el=this.el[0]);var a=OGX.Object.create(e,t);return this.add(a),"function"==typeof a.construct&&a.construct.apply(a,n),t.hasOwnProperty("node:OML")&&OGX.OML.render(a,t["node:OML"]),a.focus(),a},OGX.Uxi.prototype.parse=function(e){e=OGX.OML.parse(e),OGX.OML.render(this,e)},OGX.Uxi.prototype.topIndex=function(){var e,t=0;return this.el.find("*").each((function(i,n){e=$(n).css("z-index"),e=Number(e),isNaN(e)||e>t&&(t=e)})),t+1},require("View","Uxi","Touch"),OGX.View=function(e){construct(this,"View");var t=this,i=!1,n=e;this.el=null,this._NAME_=OGX.View.NAME,this.enable=function(){n.observe&&this.observe(!0)},this.disable=function(){n.observe&&this.observe(!1)},this.container=function(){return i},this.render=function(e){void 0===e?n.hasOwnProperty("html")&&n.html&&i.html(n.html):i.html(e),i.trigger(OGX.View.RENDER)},function(){t.el=i=$(n.el);var a=new OGX.Display(e);n.html=a.html(e.data),i.addClass("ogx_view ogx_hw"),n.css&&i.addClass(n.css),t.render()}()},OGX.View.NAME="View",OGX.View.CHANGED="ViewChanged",OGX.View.RENDER="ViewRender",require("Window","Uxi","Placeholder","Touch","Resize"),OGX.Window=function(__config){construct(this,"Window");var that=this,container=!1,config_default={anim:!1,resize:!1,drag:!0,show:!1,width:"100%",height:"100%",min_width:100,min_height:100,max_width:0,max_height:0,head:OGX.Window.HEAD_BACK,icons:[],title:"",win_html:'<div class="ogx_window_head ogx_window_head_{{$head}} ogx_window_head_{{$side}}">$INNER</div><div class="ogx_window_body">{{$html}}</div>',win_inner:['<span class="ogx_window_main_{{$head}} ogx_window_main_icon"></span>','<span class="ogx_window_title">{{$title}}</span>','<span class="ogx_window_icons">{{loop $icons as icon { echo <span class="ogx_window_icon" style="background-image:url(&icon)"></span>; } }}</span>'],zindex:!1,close_on_click_out:!1,close_dist:100,parent:null},config=__config,pt={x:null,y:null},dir={x:0,y:0},showto=50,user_resized=!1,zd;function listenBackIcon(e){e?that.el.on(that.touch.down,".ogx_window_main_back",onBack):that.el.off(that.touch.down,".ogx_window_main_back",onBack)}function onBack(e){e.preventDefault(),e.stopImmediatePropagation(),that.el.trigger(OGX.Window.HIT_BACK,that.id),that.hide()}function listenIcons(e){e?that.el.on(that.touch.down,".ogx_window_icon",onIcon):that.el.off(that.touch.down,".ogx_window_icon",onIcon)}function onIcon(e){that.el.trigger(OGX.Window.HIT_ICON,{index:$(this).index(),id:config.id})}function onDrag(e){(e.distX*dir.x>config.close_dist||e.distY*dir.y>config.close_dist)&&that.hide()}function onRelease(e){e.distX*dir.x>config.close_dist||e.distY*dir.y>config.close_dist?that.hide():(e.distX||e.distY)&&(config.anim&&(that.el.addClass("ogx_window_anim_in"),that.el.on("transitionend",(function(){that.el.off("transitionend"),that.el.removeClass("ogx_window_anim_in")}))),that.el.css("transform","translate3d("+pt.x+"px, "+pt.y+"px, 0px)"))}function render(){var e=prepWindow();container.html(e),zd=config.zindex?config.zindex:config.parent.topIndex();var t=getLimitedSize();container.css({width:t.width,height:t.height,"z-index":zd})}function getLimitedSize(){var e,t,i,n=config.parent.el.width(),a=config.parent.el.height();user_resized?(n=config.width,a=config.height):(e=OGX.Data.getBestSize(n,config.width),t=OGX.Data.getBestSize(a,config.height));var o={width:e,height:t};return(config.min_width||config.max_width)&&(-1!==config.width.indexOf("%")?(n=config.parent.el.width(),i=Number(config.width.split("%")[0])*n/100,config.min_width&&i<config.min_width?o.width=config.min_width+"px":config.max_width&&i>config.max_width&&(o.width=config.max_width+"px")):(-1!==(i=config.width).indexOf("px")&&(i=Number(i.split("px")[0])),config.min_width&&i<config.min_width?o.width=config.min_width+"px":config.max_width&&i>config.max_width&&(o.width=config.max_width+"px"))),(config.min_height||config.max_height)&&(-1!==config.height.indexOf("%")?(a=config.parent.el.height(),i=Number(config.height.split("%")[0])*a/100,config.min_height&&i<config.min_height?o.height=config.min_height+"px":config.max_height&&i>config.max_height&&(o.height=config.max_height+"px")):(-1!==(i=config.height).indexOf("px")&&(i=Number(i.split("px")[0])),config.min_height&&i<config.min_height?o.height=config.min_height+"px":config.max_height&&i>config.max_height&&(o.height=config.max_height+"px"))),o}function listenBody(e){e?that.parent.el.on(that.touch.down,".ogx_overlay",onBody):that.parent.el.off(that.touch.down,".ogx_overlay",onBody)}function onBody(e){that.status===OGX.Window.OPEN&&(that.hide(),that.parent.removeOverlay(OGX.Overlay.Fade))}function animWindow(e,t,i,n){void 0===t&&(t=config.anim);var a={opac:1,tX:0,tY:0},o=container.parent().width(),r=container.parent().height(),s=that.el.outerWidth(),l=that.el.outerHeight(),d=that.el.find(".ogx_window_main_icon:first");switch(e&&(placeWindow(!0),d.removeClass("ogx_window_main_icon_left ogx_window_main_icon_right ogx_window_main_icon_top")),t){case OGX.Window.ANIM_NONE:break;case OGX.Window.ANIM_TOP:e?(a.tY=0,d.addClass("ogx_window_main_icon_top")):a.tY=-l-10;break;case OGX.Window.ANIM_BOTTOM:e?(a.tY=0,d.addClass("ogx_window_main_icon_bottom")):a.tY=r+10;break;case OGX.Window.ANIM_RIGHT:e?(a.tX=o-s,d.addClass("ogx_window_main_icon_right")):a.tX=o+10;break;case OGX.Window.ANIM_LEFT:e?(a.tX=0,d.addClass("ogx_window_main_icon_left")):a.tX=-s-10}var c=100;e?(pt.x=a.tX,pt.y=a.tY):c=0,setTimeout((function(){dir.x,that.el.on("transitionend",(function(){that.el.off("transitionend"),e?that.el.removeClass("ogx_window_anim_in").addClass("ogx_window_open"):that.el.removeClass("ogx_window_anim_out ogx_window_open"),void 0!==i&&i(n),e?(that.status=OGX.Window.OPEN,that.el.trigger(OGX.Window.OPEN,config.id)):(that.status=OGX.Window.CLOSED,that.el.trigger(OGX.Window.CLOSED,config.id))})),e?(that.status=OGX.Window.OPENING,that.el.trigger(OGX.Window.OPENING,config.id)):(that.status=OGX.Window.CLOSING,that.el.trigger(OGX.Window.CLOSING,config.id)),config.anim!==OGX.Window.ANIM_NONE&&(e?that.el.addClass("ogx_window_anim_in"):that.el.addClass("ogx_window_anim_out")),that.el.css({transform:"translate3d("+a.tX+"px, "+a.tY+"px, 0px)",opacity:a.opac,visibility:"visible"})}),c)}function placeWindow(e){var t=container.parent().width(),i=container.parent().height(),n=that.el.outerHeight(),a=that.el.outerWidth();that.el.removeClass("ogx_window_anim_in").removeClass("ogx_window_anim_out");var o={x:0,y:0};switch(config.anim){case OGX.Window.ANIM_TOP:o.y=e?-n:n,dir.y=-1;break;case OGX.Window.ANIM_BOTTOM:o.y=e?i:i-n,dir.y=1;break;case OGX.Window.ANIM_RIGHT:o.x=e?t:t-a,dir.x=1;break;case OGX.Window.ANIM_LEFT:e&&(o.x=-a),dir.x=-1}that.el.css({transform:"translate3d("+o.x+"px, "+o.y+"px, 0px)"})}function prepWindow(){var e=new OGX.Display(config),t={};t.head=config.head,t.title=config.title,t.icons=config.icons,t.html=e.html();var i=config.win_html,n="";switch(config.anim){case OGX.Window.ANIM_RIGHT:case OGX.Window.ANIM_TOP:case OGX.Window.ANIM_BOTTOM:n=config.win_inner,t.side="right";break;case OGX.Window.ANIM_LEFT:n=config.win_inner.reverse(),t.side="left"}return n=n.toString().replace(/>,</g,"><"),i=i.replace("$INNER",n),OGX.Templater.templatize(i,t)}function onResize(){user_resized=!0,that.resizeNodes()}function initPlaceholders(){that.placeholders(config,['.ogx_window[data-ogx-id="'+that.id+'"] > .ogx_window_body'])}function initDefaults(){OGX.Data.merge(config,app.getDefaults("windows")),OGX.Data.merge(config,config_default),-1!==config.head.indexOf(".")&&(config.head=eval(config.head)),-1!==config.anim.indexOf(".")&&(config.anim=eval(config.anim)),that.el=container=$(config.el),container.addClass("ogx_window"),that.dragable=config.drag,that.resizable=config.resize}function init(){if(initDefaults(),render(),initPlaceholders(),placeWindow(!0),config.drag){var e={},t={top:!1,bottom:!1,left:!1,right:!1,cb_resize:onResize};switch(t.min_width=config.min_width,t.min_height=config.min_width,t.max_width=config.max_width,t.max_height=config.max_height,e.cb_drag=onDrag,e.cb_up=onRelease,config.anim){case OGX.Window.ANIM_LEFT:e.x=!0,e.y=!1,e.limit_x={min:-300,max:0},t.right=!0;break;case OGX.Window.ANIM_RIGHT:e.x=!0,e.y=!1,e.limit_x={min:0,max:300},t.left=!0;break;case OGX.Window.ANIM_TOP:e.x=!1,e.y=!0,e.limit_y={min:-300,max:0},t.bottom=!0;break;case OGX.Window.ANIM_BOTTOM:e.x=!1,e.y=!0,e.limit_y={min:0,max:300},t.top=!0}that.touch.drag.set(e)}config.resize&&that.setResize(t),config.show&&that.show()}this.el=null,this._NAME_=OGX.Window.NAME,this.id=config.id,this.dragable=null,this.resizeable=null,this.floating=!0,this.status=OGX.Window.CLOSED,this.enable=function(){config.close_on_click_out&&listenBody(!0),config.head&&listenBackIcon(!0),config.icons&&listenIcons(!0),config.drag&&this.touch.enable(),config.resize&&this.enableResize()},this.disable=function(){config.close_on_click_out&&listenBody(!1),config.head&&listenBackIcon(!1),config.icons&&listenIcons(!1),config.drag&&this.touch.disable(),config.resize&&this.disableResize()},this.show=function(e,t,i){-1===[OGX.Window.OPEN,OGX.Window.OPENING].indexOf(this.status)&&(this.focus(1),this.front(),null==e&&(e=config.anim),setTimeout((function(){animWindow(!0,e,t,i)}),showto),showto&&(showto=0))},this.hide=function(e,t,i){-1===[OGX.Window.CLOSED,OGX.Window.CLOSING].indexOf(this.status)&&(this.blur(1),void 0!==e&&!0!==e||(e=config.anim),animWindow(!1,e,t,i))},this.resize=function(){var e=getLimitedSize();container.css({width:e.width,height:e.height}),this.place()},this.front=function(){zd=config.parent.topIndex(),this.el.css("z-index",zd)},this.place=function(){placeWindow(this.status===OGX.Window.CLOSED)},this.destroy=function(){config.drag&&this.touch.disable()},init()},OGX.Window.NAME="Window",OGX.Window.READY="WindowReady",OGX.Window.ANIM_LEFT="left",OGX.Window.ANIM_RIGHT="right",OGX.Window.ANIM_TOP="top",OGX.Window.ANIM_BOTTOM="bottom",OGX.Window.ANIM_NONE="none",OGX.Window.HEAD_BACK="back",OGX.Window.HEAD_CLOSE="close",OGX.Window.HEAD_NONE="none",OGX.Window.CLOSING="WindowClosing",OGX.Window.CLOSED="WindowClosed",OGX.Window.OPENING="WindowOpening",OGX.Window.OPEN="WindowOpen",OGX.Window.HIT_ICON="WindowHitIcon",OGX.Window.HIT_BACK="WindowHitBack",OGX.Window.FLOAT=!0;