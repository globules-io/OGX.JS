/* globules.io OGX.JS 1.2.2.17.debug */ 
if(void 0===OGX)var OGX={};if(OGX.Data={},OGX.Data.weld=function(t,r,i,e){void 0===i&&(i=!1),void 0===e&&(e=!1);var a=t;return e&&(a=JSON.parse(JSON.stringify(t))),function t(r,e){for(var a in e)!r.hasOwnProperty(a)||i?r[a]=e[a]:"object"==typeof e[a]&&t(r[a],e[a])}(a,r),a},OGX.Data.merge=function(t,r,e,a,i){for(var s in void 0===e&&(e=!1),void 0===a&&(a=!1),void 0===i&&(i=!1),a&&(t=JSON.parse(JSON.stringify(t))),r)e?i?t.hasOwnProperty(s)&&(t[s]=r[s]):t[s]=r[s]:t.hasOwnProperty(s)||i||(t[s]=r[s]);return t},OGX.Data.props=function(t,r){for(var e in r)if(!t.hasOwnProperty(r[e]))return!1;return!0},OGX.Data.clone=function(t){return JSON.parse(JSON.stringify(t))},OGX.Data.isOML=function(t){for(var r in t)if(-1!==r.indexOf(":"))return!0;return!1},OGX.Data.stringToVal=function(t){var r=-1;return"true"===t&&(r=!0),"false"===t&&(r=!1),-1!==r?r:t.match(/^([0-9]+(\.[0-9]+)?)$/g)?Number(t):t.match(/^(\[|{)/g)?JSON.parse(t):t},OGX.Data.pad=function(t,r,e,a){void 0===a&&(a="0"),void 0===e&&(e=-1);for(var i=String(t);i.length<r;)-1===e?i=a+i:i+=a;return i},OGX.Data.addDec=function(t){return parseFloat(Math.round(100*t)/100).toFixed(2)},OGX.Data.isInt=function(t){return Number(t)===t&&t%1==0},OGX.Data.isFloat=function(t){return Number(t)===t&&t%1!=0},void 0===OGX)var OGX={};OGX.Debug=function(){var i=1,s=[1,2,3],n=[null,{label:"Error",color:"#EE1111"},{label:"Warning",color:"#ffdb16"},{label:"Info",color:"#23b438"},{label:"Verbose",color:"#AAAAAA"},{label:"Detail",color:"#999999"}];this.log=function(t){var r=Array.prototype.slice.call(arguments);1===r.length&&(r[1]=r[0],r[0]=1);var e=!1;if("boolean"==typeof s){if(!s)return;e=!0}else Array.isArray(s)&&-1!==s.indexOf(t)&&(e=!0);r.shift();var a=r.join(" ");e&&(console.log.call(null,"%c ["+OGX.Data.pad(i,6,-1,"0")+"] "+OGX.Data.pad(n[t].label,8,1," ")+":","background:#222; color:"+n[t].color+"; padding:6px 3px 6px 3px;",a),i++)},this.level=function(){var t=Array.prototype.slice.call(arguments);if(!t.length)return s;s=1!==t.length||"boolean"!=typeof t[0]?t:t[0]},console.log("%c OGX.JSðŸ’žOML v1.1.0","background:#222; color:#DDD; padding:8px 3px 8px 3px;")},OGX.Debug=new OGX.Debug;var debug=OGX.Debug.log;if(void 0===OGX)var OGX={};if(OGX.List=function(){if("undefined"!=typeof moment){var filteringMode="and",filterCount=0,indexes=!1;1===arguments.length&&arguments[0]instanceof Array&&(arguments=arguments[0]);var array=Object.create(Array.prototype);for(var method in array=Array.apply(array,arguments)||array,OGX.List.prototype)OGX.List.prototype.hasOwnProperty(method)&&(array[method]=OGX.List.prototype[method]);return array.insert=function(t,r){return void 0===r?array.push(t):array.splice(r,0,t),indexes&&addToCache(t),!0},array.delete=function(t){var r=this,e=array.splice(t,1);if(e.length){if(indexes){var a=matchesCache(e[0]);a&&setTimeout(function(){r.rebuild(a)},0)}return e[0]}return!1},array.last=function(){if(this.length)return this[this.length-1]},array.findDelete=function(t,r,e){var a=0;void 0===e&&(e=0);for(var i=new OGX.List,s=0;s<this.length;s++)if(this[s][t]===r){if(i.push(this.splice(s,1)[0]),indexes){var n=matchesCache(i.last());n&&this.rebuild(n)}if(a++,0<e&&e===a)return 1===e?i[0]:i;s--}return i},array.findReplace=function(t,r,e,a){var i=0;void 0===a&&(a=0);for(var s=new OGX.List,n=0;n<this.length;n++)if(this[n][t]===r&&(s.push(this[n]),i++,this[n]=e,0<a&&a===i))return 1===a?s[0]:s;return!!s.length&&s},array.findUpdate=function(t,r,e,a,i){var s=0;void 0===a&&(a=!1),void 0===i&&(i=0);for(var n,o=new OGX.List,h=0;h<this.length;h++)if(this[h][t]===r){for(var f in n=!1,e)a?this[h].hasOwnProperty(f)&&(this[h][f]=e[f],n=!0,s++):(this[h][f]=e[f],n=!0,s++);if(n&&(o.push(this[h]),0<i&&i===s))return 1===i?o[0]:o}return!!o.length&&o},array.findIndex=function(t,r){var e=!1;r instanceof RegExp&&(e=!0);for(var a=0;a<this.length;a++)if(e){if(this[a][t].match(r))return{index:a}}else if(this[a][t]===r)return{index:a};return!1},array.find=function(t,r,e){var a=0,i=new OGX.List,s=!1;r instanceof RegExp&&(s=!0),void 0===e&&(e=0);for(var n=0;n<this.length;n++)if(s?this[n][t].match(r)&&(i.push(this[n]),a++):this[n][t]===r&&(i.push(this[n]),a++),0<e&&a===e)return 1===e?i[0]:i;return!!i.length&&i},array.swap=function(t,r){var e=this[t];this[t]=this[r],this[r]=e},array.cache=function(){indexes=indexes||{};var t=[],r=[];if(1<arguments.length){for(var e=0;e<arguments.length;e++)t.push(arguments[e]);t=t.join("|")}else t=arguments[0];indexes.hasOwnProperty(t)||(indexes[t]={});for(var a=0;a<this.length;a++){r=[];for(e=0;e<arguments.length;e++)r.push(this[a][arguments[e]]);r=r.join("|"),indexes[t].hasOwnProperty(r)||(indexes[t][r]=[]),indexes[t][r].push(this[a])}return!0},array.uncache=function(t){if(!indexes)return!1;var r=t;return 1<arguments.length&&(r=arguments.join("|")),!!indexes.hasOwnProperty(r)&&(delete indexes[r],!0)},array.rebuild=function(t){for(var r=0;r<t.length;r++)delete indexes[t[r]],this.cache(t[r])},array.read=function(t,r,e){var a,i,s=arguments;if(!indexes)return!1;if(!s.length)return indexes;if("object"==typeof t){for(var n in e=s[1],a=[],i=[],t)a.push(n),i.push(t[n]);a=a.join("|"),i=i.join("|")}else a=t,i=r;return void 0===e&&(e=0),!(!indexes.hasOwnProperty(a)||!indexes[a].hasOwnProperty(i))&&(e?1<e?indexes[a][i].splice(0,e):indexes[a][i][0]:indexes[a][i])},array.clear=function(){indexes=!1,filterCount=0,this.length=0},array.unique=function(t,r,e){void 0===r&&(r=!0),void 0===e?e=[t]:Array.isArray(e)||(e=[e]);for(var a,i=this.get(),s=[],n=new OGX.List,o=0;o<i.length;o++)if(-1===s.indexOf(i[o][t])&&(s.push(i[o][t]),r)){a={};for(var h=0;h<e.length;h++)a[e[h]]=i[o][t];n.push(a)}return r?n:s},array.order=function(t,r){array.sort(dynamicSort(t,r))},array.group=function(t,r,e){if(Array.isArray(t))return array.groupm(t,r,e);for(var a,i={},s=0;s<this.length;s++)(a=extract(this[s],t,r,e))&&(a=a.split(".").pop(),i.hasOwnProperty(a)||(i[a]=new OGX.List),i[a].push(this[s]));return i},array.groupm=function(h,f,l){return function t(r,e){var a=new OGX.List(r),i=f,s=l;void 0!==f&&Array.isArray(f)&&(i=f[e]),void 0!==l&&Array.isArray(l)&&(s=l[e]);var n=a.group(h[e],i,s);if(e+1<=h.length-1)for(var o in n)n[o]=t(n[o],e+1);return n}(this,0)},array.filters={},array.addFilter=function(t,r,e){this.filters.hasOwnProperty(t)||(this.filters[t]=[]);var a={};return a[r]=e,this.filters[t].push(a),filterCount++,!0},array.removeFilter=function(t){return!!this.filters.hasOwnProperty(t)&&(filterCount-=this.filters[t].length,delete this.filters[t],!0)},array.getFilters=function(){return this.filters},array.resetFilters=function(){this.filters={},filterCount=0},array.setFilters=function(t){for(var r in this.resetFilters(),t)for(var e=0;e<t[r].length;e++)for(var a in t[r][e])array.addFilter(r,a,t[r][e][a])},array.setFilteringMode=function(t){filterMode=t},array.get=function(t,r,e,a,i){void 0===r&&(r=!1),void 0===e&&(e=!1),"number"==typeof e&&(a=e,e=!1),void 0===a&&(a=0),void 0===i&&(i=!1);var s=this.getFilters();for(var n in this.resetFilters(),t)for(var o in t[n])this.addFilter(n,o,t[n][o]);var h=this.filter(a,i);if(this.resetFilters(),this.setFilters(s),i)return h;if(1===a)return!!h.length&&h[0];if(r)for(var n in r){h.order(n,r[n]);break}return e?h.group.apply(null,e):h},array.unset=function(t,r){void 0===r&&(r=0);var e=new OGX.List,a=this.get(t,null,null,r,!0);if(a)for(var i=0;i<a.length;i++)e.push(this.delete(a[i]-e.length));return 1===r&&e.length?e[0]:e},array.filter=function(__limit,__as_position){void 0===__limit&&(__limit=0),void 0===__as_position&&(__as_position=!1);for(var ar=[],positions=[],isDate,isString,isArray,isObject,hasFilters=!1,reg=/[0-9]{4}\-[0-9]{2}\-[0-9]{2}( [0-9]{2}\:[0-9]{2}\:[0-9]{2})?/g,isMatch=!1,matches=0,str,o,err,counter,total,i=0;i<this.length;i++)for(var a in isMatch=!0,matches=0,this.filters){err=!1,hasFilters=!0;try{o=null,str="this["+i+"]."+a,o=eval(str)}catch(t){err=!0}if(err||void 0===o)isMatch=!1;else{isDate=!1,isString=!1,isArray=Array.isArray(o),isObject=!isArray&&"object"==typeof o,isArray?"string"==typeof o[0]&&(isString=!0,o[0].match(reg)&&(isDate=!0)):"string"==typeof o&&(isString=!0,o.match(reg)&&(isDate=!0));for(var j=0;j<this.filters[a].length;j++)for(var b in this.filters[a][j]){if(String(this.filters[a][j][b]).length)if("function"===b)isMatch=this.filters[a][j][b](o),isMatch&&matches++;else switch(b){case"eq":isDate?moment(o).format("YYYY-MM-DD")!==moment(this.filters[a][j][b]).format("YYYY-MM-DD")?isMatch=!1:matches++:isString?o.toLowerCase()!==String(this.filters[a][j][b]).toLowerCase()?isMatch=!1:matches++:o!==this.filters[a][j][b]?isMatch=!1:matches++;break;case"eqjson":JSON.stringify(o)!==JSON.stringify(this.filters[a][j][b])?isMatch=!1:matches++;break;case"neq":isDate?moment(o).format("YYYY-MM-DD")===moment(this.filters[a][j][b]).format("YYYY-MM-DD")?isMatch=!1:matches++:isString?o.toLowerCase()===this.filters[a][j][b].toLowerCase()?isMatch=!1:matches++:o===this.filters[a][j][b]?isMatch=!1:matches++;break;case"in":if(isString&&Array.isArray(this.filters[a][j][b])){isMatch=!1;for(var k=0;k<this.filters[a][j][b].length;k++)if(-1!==o.indexOf(this.filters[a][j][b][k])){isMatch=!0;break}isMatch&&matches++}else if(isString)isArray?-1===o.indexOf(this.filters[a][j][b])?isMatch=!1:matches++:-1===o.toLowerCase().indexOf(this.filters[a][j][b].toLowerCase())?isMatch=!1:matches++;else if(isArray)-1===o.indexOf(this.filters[a][j][b])?isMatch=!1:matches++;else if(isObject){for(var p in counter=0,total=0,this.filters[a][j][b])total++,o.hasOwnProperty(p)&&-1!==String(o[p]).toLocaleLowerCase().indexOf(String(this.filters[a][j][b][p]).toLowerCase())&&counter++;isMatch=total===counter,isMatch&&matches++}break;case"nin":if(Array.isArray(this.filters[a][j][b])){for(var k=0;k<this.filters[a][j][b].length;k++)if(-1!==o.indexOf(this.filters[a][j][b][k])){isMatch=!1;break}isMatch&&matches++}else isString?-1!==o.toLowerCase().indexOf(this.filters[a][j][b].toLowerCase())?isMatch=!1:matches++:-1!==o.indexOf(this.filters[a][j][b])?isMatch=!1:matches++;break;case"gt":isDate?moment(o).unix()<=moment(this.filters[a][j][b]).unix()?isMatch=!1:matches++:o<=this.filters[a][j][b]?isMatch=!1:matches++;break;case"gte":isDate?moment(o).unix()<moment(this.filters[a][j][b]).unix()?isMatch=!1:matches++:o<this.filters[a][j][b]?isMatch=!1:matches++;break;case"lt":isDate?moment(o).unix()>=moment(this.filters[a][j][b]).unix()?isMatch=!1:matches++:o>=this.filters[a][j][b]?isMatch=!1:matches++;break;case"lte":isDate?moment(o).unix()>moment(this.filters[a][j][b]).unix()?isMatch=!1:matches++:o>this.filters[a][j][b]?isMatch=!1:matches++;break;case"btw":isDate?moment(this.filters[a][j][b][0]).unix()>moment(o).unix()||moment(this.filters[a][j][b][1]).unix()<moment(o).unix()?isMatch=!1:matches++:this.filters[a][j][b][0]>o||this.filters[a][j][b][1]<o?isMatch=!1:matches++;break;case"substr":o.toLowerCase().substr(this.filters[a][j][b][0],this.filters[a][j][b][1]).toLowerCase()!==this.filters[a][j][b][2].toLowerCase()?isMatch=!1:matches++;break;case"regex":o.toString().match(this.filters[a][j][b])?matches++:isMatch=!1}else matches++;if(!isMatch)break}}if("or"===filteringMode?isMatch&&(ar.push(this[i]),positions.push(i)):matches===filterCount&&(ar.push(this[i]),positions.push(i)),__limit&&ar.length===__limit)return __as_position?positions:OGX.List.apply(null,ar)}return __as_position?positions:hasFilters?OGX.List.apply(null,ar):array},array}function addToCache(t){var r;for(var e in indexes){if(-1!==e.indexOf("|")){e=e.split("|"),r=[];for(var a=0;a<e.length;a++)t.hasOwnProperty(e[a])&&r.push(t[e[a]]);r=r.join("|"),e=e.join("|")}else t.hasOwnProperty(e)&&(r=t[e]);indexes.hasOwnProperty(e)||(indexes[e]={}),indexes[e][r]=t}}function matchesCache(t){var r,e=[],a=[];for(var i in indexes){r=!0,e=-1!==i.indexOf("|")?i.split("|"):[i];for(var s=0;s<e.length;s++)if(!t.hasOwnProperty(e[s])){r=!1;break}r&&a.push(i)}return!!a.length&&a}function dynamicSort(e,a){return function(t,r){return t[e]<r[e]?-1*a:t[e]>r[e]?a:0}}function extract(__item,__by,__mode,__param){var data;try{data=eval("__item."+__by)}catch(t){}if(data)switch(__mode){case"substr":return data=data.substr(__param[0],__param[1]),data;case"numrange":return data=Number(data),data=Array.isArray(__param)?(data=Math.floor(data/__param[0]),"pre"===__param[2]?__param[1]+data*__param[0]+" - "+__param[1]+(data+1)*__param[0]:data*__param[0]+__param[1]+" - "+(data+1)*__param[0]+__param[1]):(data=Math.floor(data/__param),data*__param+" - "+(data+1)*__param),data;case"date":if(!Array.isArray(__param)){if("year"===__param)return data=data.substr(0,4),data;if("month"===__param)return data=data.substr(0,7),data;if("week"===__param)return data=data.substr(0,4)+" week "+moment(data).week(),data}return data=moment(data).unix(),data=Math.floor(data/(60*__param[0]*60*24)),data*=60*__param[0]*60*24,data=moment(1e3*data).format(__param[1])+" - "+moment(1e3*data+1e3*__param[0]*60*60*24).format(__param[1]),data;default:return data}return!1}console.log("Error: moment.js not found!")},void 0===OGX)var OGX={};OGX.Object=function(){"use strict";var n=new OGX.List,h=new OGX.List;function f(t){for(var r=t.split("."),e=OGX,a=0;a<r.length;a++)void 0!==e[r[a]]&&(e=e[r[a]]);return e}h.cache("_NAME_","id"),this.isRegistered=function(t,r){return typeof("undefined"!==this.register[t][r])},this.getExtend=function(t){var r=n.get({main:{eq:t}},null,1);return!!r&&r.extends},this.getExtends=function(t){var r=[],e=n.get({main:{eq:t}},null,1);if(e){var a;r=r.concat(e.extends);for(var i=0;i<e.extends.length;i++)(a=this.getExtends(e.extends[i]))&&(r=r.concat(a))}var s=[];for(i=0;i<r.length;i++)-1===s.indexOf(r[i])&&s.push(r[i]);return s},this.register=function(){var t=Array.prototype.slice.call(arguments),r=t.shift();n.push({main:r,extends:t})},this.create=function(t,r){void 0===r&&(r={});var e=this.getExtends(t),a=!1;if(e.length){var i=f(t);i.prototype=Object.create({});var s,n=[];n.push(i.prototype);for(var o=0;o<e.length;o++)void 0!==(s=f(e[o]))&&n.push(s.prototype);Object.assign.apply(null,n),a=new(i.prototype.constructor=i)(r)}else OGX.hasOwnProperty(t)&&(a=new OGX[t](r));return debug(5,"create",t,a.id),!!a&&(h.insert(a),a)},this.cache=function(t){h.insert(t)},this.get=function(t,r,e){return h.get(t,r,e)},this.destroy=function(t){debug(5,"object destroy uxi",t._NAME_,t.id),t.blur(),"function"==typeof t.destroy&&t.destroy(),"function"==typeof t.__destroy&&t.__destroy(),t.clear(),t.floating&&t.el.remove(),h.findDelete("id",t.id,1)}},"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(t){"use strict";if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var r=Object(t),e=1;e<arguments.length;e++){var a=arguments[e];if(null!=a)for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(r[i]=a[i])}return r},writable:!0,configurable:!0});if(void 0===OGX)var OGX={};function require(){OGX.Object.register.apply(null,arguments)}function construct(__that,__cls){var ext=OGX.Object.getExtend(__cls);for(var a in ext)eval("OGX."+ext[a]).call(__that,arguments.callee.caller.arguments[0])}OGX.Object=new OGX.Object;if(void 0===OGX)var OGX={};if(OGX.OML=function(){"use strict";var thread_object={},local_object={},binds;function createRecursive(e,t,m,w,G){binds=[];var n=(new Date).getTime();!function e(t,n){if(Array.isArray(t))for(var i=0;i<t.length;i++)e(t[i],n);else{var o,r,s,a,d,u,l,p,c,f,h,g,O,v;if(!G)for(p in t)-1!==p.indexOf(":Point")&&(t[p].el=p.split(":")[0],t[p].data=m,t[p].route_data=w,e((l=n.create("Point",t[p])).oml(),l),delete t[p]);for(p in t)if((O=/((?!:)[\S ]+):(\S+)/gi.exec(p))&&(o=O[1],void 0!==(r=s=O[2])&&-1===["Route","OML"].indexOf(r))){switch(0<s.indexOf(".")&&(s=s.substr(0,s.indexOf(".")-1)),u=t[p],v=!(a=d=!0),s){case"Fork":if("scope"===o){if(!(g=OGX.Scope.match(t[p])))return!1;e(g.node,n)}else(g=getForkChild(t[p]))&&e(g,c);d=a=!1;break;case"Html":u.el=o,u.html=t[p].html,(a=isRequired(u))||(u.template=!1);break;case"Template":u.template=r.split(".")[1],u.el=o,r="Html",a=isRequired(u);break;case"Ghost":u.el=o;break;case"Controller":u.id=o;break;case"Uxi":d=a=!1,v=u;break;default:-1!==[".","#"].indexOf(o.substr(0,1))?u.el=o:(u.id=o,u.el=n.el[0],u.parent=n)}d&&(u=runOseScripts(u,w)),f=c=!1,a?(G&&(h=G.find("id",u.id,1))&&(f=!0),l=f?(h.wake(u.el),h):OGX.Object.create(r,u),n.add(l),c=l):v?($(o).html(v.el.html()),v.el=$(o),n.add(v),OGX.Object.cache(v)):(c=n,"Html"===r&&OGX.HtmlRender(u)),c&&t[p].hasOwnProperty("node:OML")&&!v&&("string"==typeof t[p]["node:OML"]&&0===t[p]["node:OML"].indexOf("{{")&&(t[p]["node:OML"]=OGX.OSE.exec(t[p]["node:OML"])),e(t[p]["node:OML"],c)),a&&"function"==typeof l.construct&&(f||l.construct.apply(l,[m,w])),(a||f)&&(n.blured||l.focus()),convertBinds(l,t[p])}}}(t,e),binds.length&&execBinds(binds),OGX.OML.rendertime&&debug(3,"â± OML RENDER TIME "+((new Date).getTime()-n)+"ms ")}function execBinds(e){for(var t=0;t<e.length;t++)doBind(e[t])}function convertBinds(e,t){var n;for(var i in t)if(n=/^(\S*)\:Bind$/g.exec(i))if(Array.isArray(t[i]))for(var o=0;o<t[i].length;o++)t[i][o].property=n[1],binds.push({uxi:e,config:t[i][o]});else t[i].property=n[1],binds.push({uxi:e,config:t[i]})}function doBind(e){setTimeout(function(){runOseScripts(e.config),e.uxi.bind(e.config)},0)}function isRequired(e){return e.hasOwnProperty("instance")&&e.instance||e.hasOwnProperty("scroll")&&e.scroll}function getForkChild(__prop,__node){if(0===__prop.indexOf("#")&&(__prop=eval(__prop.substr(1))),__prop)for(var val in __node)if(-1!==__prop.indexOf(val))return __node[val];return!1}function runOseScripts(e,t){var n;for(var i in e)-1!==i.indexOf(":OSE")&&(e[n=i.split(":").shift()]=OGX.OSE.exec(e[i],{},thread_object,t,local_object),delete e[i],runOseScripts(e[n]));return e}this.rendertime=!0,this.get=function(e){return OGX.Cache.get("oml",e)},this.make=function(e,t,n){var i={};return i[e+":"+t]=n,i},this.parse=function(e){return"string"==typeof e&&("{"!==e.substr(0,1)&&(e="{"+e+"}"),e=JSON.parse(e)),e},this.replaceNodeName=function(e,t,n){var i={};for(var o in void 0===n&&(n="default"),e){i[o.replace(n,t)]=e[o];break}return e=i},this.replaceDataRecursive=function(e,r,s){function a(e){var t,n;for(var i in e)if(-1!==i.indexOf(":OSE"))t=i.split(":"),(n=u(e[i],r,s))&&(e[t[0]]=n,delete e[i],a(e[t[0]]));else if("node:OML"===i)if("string"==typeof e[i]&&0===e[i].indexOf("{{"))e[i]=OGX.OSE.exec(e[i]),d(e[i]);else if(Array.isArray(e[i]))for(var o=0;o<e[i].length;o++)d(e[i][o]);else d(e[i])}function d(e){var t;for(var n in e)-1!==n.indexOf("{{")&&(t=u(n,r,s))&&(e[t]=e[n],delete e[n],n=t),a(e[n])}function u(e,t,n){var i,o,r=/{{([\S ]+)}}/gi;thread_object[n]=t;for(var s=0;i=r.exec(e);){if(o=OGX.OSE.exec(i[0],{},thread_object),-1!==["string","number"].indexOf(typeof o))e=e.replace(i[0],o);else if(-1!==["boolean","object"].indexOf(typeof o))return o;if(r.lastIndex=0,100<++s)return}return e}d(e)},this.render=function(e,t,n,i,o){"string"==typeof n&&0===n.indexOf("{{")&&(n=OGX.OSE.exec(n,{},thread_object,i)),void 0===o&&(o=!1),createRecursive(e,t,n,i,o),e.blured||e.focusNodes()}},OGX.OML=new OGX.OML,void 0===OGX)var OGX={};OGX.Stages={},OGX.Views={},OGX.Controllers={},require("Core","Uxi","Touch"),OGX.Core=function(){construct(this,"Core");var u,x=this,t={scope:["public"],routing:{routes:{},options:{history:!0,bookmark:!0},errors:{403:!1,404:!1}},stages:{blured:!0,use:!1,closeable:!1,anim:!1},overlays:{delay:200,anim:"fade"},popups:{blured:!1,sleeping:!1},theater:!1,observe:!1,auto_exit:!1,chromeos:!1,rendertime:!1},l=!1,s=!1,n=!1,i=/(iPhone|iPod|iPad)/i.test(navigator.userAgent),o=matchMedia("(prefers-color-scheme: dark)").matches;function r(e,t){var n=e.join(" ");$("body").removeClass(n).addClass(t.join(" "))}function d(e){app.remove(OGX.Popup.NAME,e.id),e.cb&&e.cb(e.params)}function p(e){var t=e.matches;debug(3,"dark mode is",t)}function c(){if(l)for(var e=l.gather(""),t=0;t<e.length;t++)e[t]._NAME_!==OGX.Controller.NAME&&(-1===[OGX.Popup.NAME,OGX.Window.NAME].indexOf(e[t]._NAME_)?e[t].sleeping||(e[t].resize(),e[t].resizeNodes()):-1!==OGX.Popup.NAME.indexOf(e[t]._NAME_)?e[t].sleeping||(e[t].resize(),e[t].centered&&e[t].center(),e[t].resizeNodes()):-1!==OGX.Window.NAME.indexOf(e[t]._NAME_)&&(e[t].sleeping||(e[t].resize(),e[t].resizeNodes())))}function f(){debug(3,"preload done"),u.routing&&(x.router=new OGX.Router(u.routing),x.router.start()),function(){(function(){debug(5,"init stages");var e,t,n,i,o,r,s,a=!1;for(var d in u.vapps)t=(e=d.split(":"))[0],n=e[1],(o=OGX.Data.merge(u.vapps[d],u.stages,!1,!0)).id=t,!0===o.use&&(i=(a=t)+"/"+o.home),r=x.addStage(n,o),!0===o.use&&(l=r);a&&(s=u.bookmark&&-1!==window.location.href.indexOf("#")?window.location.href.split("#").pop():i,setTimeout(function(){x.goto(s)},0),setTimeout(function(){$(document).trigger(OGX.App.READY)},100))})(),r([""],OGX.Data.clone(u.scope)),u.theater&&function(){for(var e=app.gather(OGX.Stage.NAME),t=[],n=0;n<e.length;n++)e[n].theater&&t.push(e[n]);u.theater.stages=t,u.theater.el="body",x.theater=x.create("Theater",u.theater)}();debug(3,"app ready")}()}this._NAME_=OGX.App.NAME,this.router=!1,this.isWebView=function(){return n},this.isTouch=function(){return this.touch.touchable()},this.getURL=function(){return l.url},this.isDarkMode=function(){return o},this.toggleTheme=function(){var e="(prefers-color-scheme: ";o?($("head").children('link[data="dark"]').attr("media",e+"light)"),$("head").children('link[data="light"]').attr("media",e+"dark)")):($("head").children('link[data="dark"]').attr("media",e+"dark)"),$("head").children('link[data="light"]').attr("media",e+"light)")),o=!o},this.scope=function(e){return void 0!==e&&Array.isArray(e)?(r(OGX.Data.clone(u.scope),OGX.Data.clone(e)),OGX.Scope.scope=e,!0):OGX.Scope.scope},this.addStage=function(e,t){if(OGX.Data.merge(t,u.stages),void 0===t)return!1;if(!t.hasOwnProperty("id"))return!1;t.el="body";var n=OGX.Object.create(e,t);return this.add(n),t.hasOwnProperty("node:OML")&&OGX.OML.render(n,t["node:OML"]),setTimeout(function(){n.construct(t),t.use?(n.el.css("display","block"),n.focus(),s=n):n.sleep()},0),n},this.removeStage=function(e){var t=this.cfind("Stage",e);t&&(t.destroy(),t.kill(),this.find("Stage",e,"remove"))},this.useStage=function(e){if(!l||l.id!==e){var t=this.cfind("Stage",e);return!!t&&(debug(3,"app now using stage",e),l=t,!0)}},this.getStage=function(e){if(void 0===e)return l||s;var t=this.find("Stage",e);return t||!1},this.showStage=function(e,t){if(!l||l.id!==e){var n=this.cfind(OGX.Stage.NAME,e);if(n){if(debug(3,"app now showing stage",e,t),void 0===t&&(t=n.anim?n.anim:!!s.anim&&s.anim),t){var i=$(window).height();switch(t){case OGX.Stage.SWAP:s&&(n.wake(),s.el.on("transitionend",function(){s.el.off("transitionend"),s.el.css("top",-i+"px"),n.el.css("top","0px"),n.el.on("transitionend",function(){n.el.off("transitionend"),n.el.css("transform","scale(1)"),s.el.removeClass("ogx_stage_anim"),s.el.css({top:"0px",transform:"scale(1)"}),s.sleep(),x.el.trigger(OGX.Stage.SWAP,{old:s,new:n}),s=n})}),n.el.addClass("ogx_stage_anim"),s.el.addClass("ogx_stage_anim"),s.el.css("transform","scale(0.9)")),n.el.css("top",i+"px"),n.el.css("display","block"),n.el.css("transform","scale(0.9)"),n.el.addClass("ogx_stage_anim");break;case OGX.Stage.FLIP:s&&(n.wake(),s.el.on("transitionend",function(){s.el.off("transitionend"),s.el.removeClass("ogx_stage_anim"),s.el.css("transform","scaleX(1)"),s.sleep(),n.el.css("transform","scaleX(1)"),x.el.trigger(OGX.Stage.SWAP,{old:s,new:n}),s=n}),n.el.addClass("ogx_stage_anim"),n.el.css("transform","scaleX(0)"),s.el.addClass("ogx_stage_anim"),s.el.css("transform","scaleX(0)")),n.el.css("display","block")}}else s&&s.id!==n.id&&s.sleep(),n.sleeping&&n.wake(),n.el.css("display","block"),s=n;x.useStage(e)}}},this.getWindow=function(e){return this.cfind(OGX.Window.NAME,e)},this.getWindows=function(){return this.gather(OGX.Window.NAME)},this.windowExists=function(e){return!1!==this.cfind(OGX.Window.NAME,e)},this.addWindow=function(e,t){if(debug(4,"app adding window",e.id),e=OGX.Data.merge(e,u.windows),void 0===t){if(!s)return!1;t=s}var n;return!!t&&(e.el=t.el,e.parent=t,e.hasOwnProperty("node:OML")?(n=OGX.Object.create(OGX.Window.NAME,e),t.add(n),n.focus(),OGX.OML.render(n,e["node:OML"])):n=t.create(OGX.Window.NAME,e),n)},this.windowOpen=function(e){return this.cfind(OGX.Window.NAME,e).status===OGX.Window.OPEN},this.showWindow=function(e,t,n,i){debug(4,"app showing window",e),!0===t&&(t=u.anim);var o=this.cfind(OGX.Window.NAME,e);return!!o&&(o.sleeping&&attachWindow(e),o.blured&&o.focus(),o.show(t,n,i),!0)},this.hideWindow=function(e,t,n,i){debug(4,"app hiding window",e),!0===t&&(t=u.anim),"string"!=typeof e&&(e=this.findWindow(e).id),this.cfind(OGX.Window.NAME,e).hide(t,n,i)},this.swapWindows=function(e,t){var n,i,o,r;return debug(4,"app swapping window",e,t),!(!this.windowExists(e)||!this.windowExists(t))&&(n=this.getWindow(e),i=this.getWindow(t),o=n.el.css("z-index"),r=i.el.css("z-index"),n.el.css("z-index",r),i.el.css("z-index",o),!0)},this.sleepWindow=function(e){debug(4,"app sleep window",e),this.cfind(OGX.Window.NAME,e).sleep()},this.blurWindow=function(e){debug(4,"app blur window",e),this.cfind(OGX.Window.NAME,e).blur()},this.focusWindow=function(e){debug(4,"app focus window",e),this.cfind(OGX.Window.NAME,e).focus()},this.removeWindow=function(e){return debug(4,"app remove window",e),this.find(OGX.Window.NAME,e,"remove")},this.removeWindows=function(e){for(var t in e)this.removeWindow(t);return!0},this.removeAllWindows=function(e){void 0===e&&(e=[]);for(var t=this.gather(OGX.Window.NAME),n=0;n<t.length;n++)-1!==e.indexOf(t[n].id)&&this.removeWindow(t[n].id)},this.findWindow=function(e){var t=e.el.parents(".ogx_window");if(t.length){var n=$(t[0]).data("ogx-id");return this.cfind(OGX.Window.NAME,n)}return!1},this.addPopup=function(e,t){var n;return debug(4,"app add popup",e.id),void 0!==t&&t||(t=l),e.el=t.el[0],e.parent=t,e.chromeos=u.chromeos,e.hasOwnProperty("node:OML")?(n=OGX.Object.create(OGX.Popup.NAME,e),t.add(n),n.focus(),OGX.OML.render(n,e["node:OML"])):n=t.create(OGX.Popup.NAME,e),setTimeout(function(){n.show()},0),n},this.removePopup=function(e,t,n,i,o){if(debug(4,"app remove popup",e),void 0===o&&(o=s),void 0===n&&(n=!1),void 0===i&&(i=!1),void 0===t&&(t=!0),o){var r=o.find(OGX.Popup.NAME,e);if(r)return r.hide(t,d,{id:e,cb:n,params:i}),!0}return!1},this.findPopup=function(e){var t;t=e instanceof HTMLElement?e:e.el;var n=$(t).parents(".ogx_popup");if(n.length){var i=$(n[0]).data("ogx-id");return this.cfind(OGX.Popup.NAME,i)}return!1},this.getVisiblePopups=function(){for(var e=this.gather(OGX.Popup.NAME),t=[],n=0;n<e.length;n++)"visible"===e[a].el.css("visibility")&&t.push(e[n]);return t},this.popupExists=function(e){return!1!==this.cfind(OGX.Popup.NAME,e)},this.groupPopups=function(e,t){var n=e.id,i=t.id,o=e.nodes.get({_NAME_:{eq:"Container"}},null,1),r=t.nodes.get({_NAME_:{eq:"Container"}},null,1);if(o&&r){for(var s=o.nodes.get({_NAME_:{eq:"Carousel"}},null,1),a=o.nodes.get({_NAME_:{eq:"Tabs"}},null,1).set(),d=r.nodes.get({_NAME_:{eq:"Carousel"}},null,1),u=(h=r.nodes.get({_NAME_:{eq:"Tabs"}},null,1)).index(),l=s.panels().slice(),p=0;p<l.length;p++)h.addTab(a[p]),M=l[p].instance?{"default:Uxi":l[p].instance}:{"default:Html":{html:l[p].html}},d.addNode(M,null,!1);u+=a.length,d.showPanel(u,!1),h.selectIndex(u),x.removePopup(e.id,!1,!1,!1,e.parent)}else if(o||r){var c,f,h,g;M=(f=o?(c=o.nodes.get({_NAME_:{eq:"Carousel"}},null,1),h=o.nodes.get({_NAME_:{eq:"Tabs"}},null,1),t):(c=r.nodes.get({_NAME_:{eq:"Carousel"}},null,1),h=r.nodes.get({_NAME_:{eq:"Tabs"}},null,1),e)).nodes.length?((g=f.nodes.slice()[0]).blur(),{"default:Uxi":g}):{"default:Html":{html:f.el.find(".ogx_popup_body:first").html()}},c.addNode(M,null,!0),h.addTab(f.title()),h.selectIndex(h.set().length-1),x.removePopup(f.id,!1,!1,!1,f.parent)}else{var O=e.nodes.slice(),v="";O.length?O=O[0]:(O=!1,v=e.el.find(".ogx_popup_body:first").html());var m,w,G=t.nodes.slice(),X="";G.length?G=G[0]:(G=!1,X=t.el.find(".ogx_popup_body:first").html()),m=O?{"default:Uxi":O}:{"default:Html":{html:v}},w=G?{"default:Uxi":G}:{"default:Html":{html:X}};var b=t.icons()||e.icons();"boolean"==typeof b&&(b=!1),b&&Array.isArray(b)&&b.length||(b=!1);var _=this.gather("Popup");_=_.get({id:{in:e.group}});var M={id:e.group+"_"+_.length,width:e.el.width(),height:e.el.height(),title:e.group,group:e.group,drag:!0,resize:!0,anim:!1,icons:b,"node:OML":[{"default:Container":{index:1,tabs:{list:[t.title(),e.title()]},"node:OML":[w,m]}}]},A=e.parent;this.removePopup(e.id,!1,!1,!1,A),this.removePopup(t.id,!1,!1,!1,A);A=app.addPopup(M,e.parent);$(document).trigger(OGX.Popup.GROUP,{popups:[n,i],popup:A})}},this.ungroupPopup=function(e,t,n){var i=e.nodes.get({_NAME_:{eq:"Container"}},null,1).nodes.get({_NAME_:{eq:"Carousel"}},null,1),o=i.getPanel(t),r={};if(o.instance){var s=i.nodes.slice().get({id:{eq:o.instance.id},_NAME_:{eq:o.instance._NAME_}},null,1);s&&(r["default:Uxi"]=s)}else r["default:Html"]={html:o.html};i.removePanel(t);var a="popup_"+(new Date).getTime();this.addPopup({id:a,group:e.group,title:n,resize:!0,drag:!0,"node:OML":[r]}),$(document).trigger(OGX.Popup.UNGROUP,{from_popup:e.id,from_index:t,to_popup:a})},this.addOverlay=function(e,t){return debug(4,"app add overlay"),void 0===t&&(t=s),!!t&&(t.addOverlay(e),!0)},this.removeOverlay=function(e,t){debug(4,"app remove overlay"),void 0===t&&(t=s),t&&t.removeOverlay(e)},this.theater=!1,this.getJSON=function(e){return OGX.Cache.get("json",e)},this.goto=function(e,t){return void 0===t&&(t={}),t=OGX.Data.merge(t,{history:!0,data:null},!1),this.router.goto(e,t)},this.getDefaults=function(e){return u[e]},(void 0===OGX.Data?(debug(1,"OGX.Data not found!"),0):void 0===OGX.Net?(debug(1,"OGX.Net not found!"),0):void 0===OGX.Templater?(debug(1,"OGX.Templater not found!"),0):void 0===OGX.Display?(debug(1,"OGX.Display not found!"),0):void 0===OGX.View?(debug(1,"OGX.View not found!"),0):void 0===OGX.Controller?(debug(1,"OGX.Controller not found!"),0):void 0===OGX.Stage?(debug(1,"OGX.Stage not found!"),0):void 0===OGX.Window?(debug(1,"OGX.Window not found!"),0):void 0===OGX.Popup?(debug(1,"OGX.Popup not found!"),0):void 0!==OGX.Container||(debug(1,"OGX.Container not found!"),0))&&(OGX.Net=new OGX.Net({ios:i}),OGX.Net.load("app.json",function(e){debug(3,"init"),u=e,n=void 0!==window.ontouchstart,i&&$("body").addClass("ios"),u=OGX.Data.weld(u,t,!1,!1),x.el=$(document),OGX.OML.rendertime=u.rendertime,OGX.Net.preload(u.preload,f),function(e){e?window.addEventListener("resize",c):window.removeEventListener("resize",c)}(!0),function(e){if(e){var t=window.matchMedia("(prefers-color-scheme: dark)");t.addListener(p)}else t.removeListener(p)}(!0)}))},OGX.App=function(e){"use strict";return OGX.Object.create("Core",e)},OGX.App.NAME="App",OGX.App.LOADING="AppLoading",OGX.App.READY="AppReady";if(void 0===OGX)var OGX={};if(OGX.Audio=function(){"use strict";var n=!1;this.get=function(e){var t;return!!(t=OGX.Cache.get("snd",e))&&t},this.play=function(e,t){debug(4,"audio play",e),void 0===t&&(t=1);var i=this.get(e);return!!i&&((i=i.cloneNode()).volume=t,n?i.play().catch(function(){}):setTimeout(function(){i.play().catch(function(){})},0),!0)},$(document).on("touchstart mousedown",function e(){n=!0,$(document).off("touchstart mousedown",e)})},OGX.Audio=new OGX.Audio,void 0===OGX)var OGX={};if(OGX.Bind=function(){"use strict";var l=this,t={object:null,event:null,mode:"eq",action:"filter",property:null,remote_property:null,min_length:0},i={};function n(e,i){var t,n,a,o="string"==typeof i.object;function r(e,t){i.remote_property&&void 0!==t&&(Array.isArray(i.remote_property)||(t=t[i.remote_property])),n(i.property,i.mode,t)}function s(e){if(i.min_length&&e.target.value.length<i.min_length&&e.target.value.length)return!1;n(i.property,i.mode,e.target.value)}switch(a=o?(e&&(i.object={el:$(i.object)},t=i.event),s):(e&&(t=OGX[i.object._NAME_].BIND),r),i.action){case"render":n=l.bindRender;break;case"filter":n=l.bindFilter}e?(i.object.el.on(t,a),o?s({target:{value:i.object.el.val()}}):i.object.bindValue?r(0,i.object.bindValue()):r(0,i.object.val())):i.object.el.off(t,a)}this.bind=function(e){return debug(4,"binding",e.property,"of",this.id,"with",e.object),OGX.Data.merge(e,t),!!e.property&&(e.object&&"string"==typeof e.object&&(e.event="input change",e.action="filter"),i.hasOwnProperty(e.property)||(i[e.property]=[]),i[e.property].push(e),n(!0,e),!0)},this.unbind=function(e){debug(4,"unbinding",i[e].object.id,"from",this.id);for(var t=0;t<i[e].length;t++)n(!1,i[e][t]);return delete i[e],!0},this.clearBinds=function(){for(var e in debug(4,"clearing binds"),i){for(var t=0;t<i[e].length;t++)n(!1,i[e][t]);delete i[e]}}},OGX.Bind.prototype.bindFilter=function(e,t,i){},OGX.Bind.prototype.bindRender=function(e,t){},OGX.Bind.prototype.bindValue=null,void 0===OGX)var OGX={};if(OGX.Cache=function(){"use strict";var n=new OGX.List;n.cache("ext","id"),this.get=function(e,t){debug(5,"cache get",e,t);var i=n.read({ext:e,id:t},null,1);return!!i&&i.data},this.set=function(e){n=new OGX.List(e)},this.add=function(e){if(Array.isArray(e))for(var t=0;t<e.length;t++)debug(4,"cache insert",e[t].ext,e[t].file),n.insert(e[t]);else debug(4,"cache insert",e.ext,e.file),n.insert(e)},this.remove=function(e,t){return debug(4,"cache unset",e,t),n.unset({ext:{eq:e},id:{eq:t}},1)},"undefined"!=typeof __array&&this.set(__array)},OGX.Cache=new OGX.Cache,void 0===OGX)var OGX=function(){};if(require("Calendar","Uxi","Bind","Touch"),OGX.Calendar=function(e){construct(this,"Calendar");var i,n,t,l,a=this,d=e,o={display_date:moment(),date:!1,format:"YYYY-MM-DD",layouts:[{layout:"MONTH_DAYS",engine:"DAY_NUMBER",config:!1}],layout:0,selectable:!0,swipable:!0,chromeos:!1},c=[],r={x:1,y:1},s=!1;function u(e){e?n.on("click",".ogx_calendar_layout_item",f):n.off("click",".ogx_calendar_layout_item",f)}function f(e){var t=$(this);t.hasClass("ogx_calendar_selected_item")?(t.removeClass("ogx_calendar_selected_item"),a.el.trigger(OGX.Calendar.UNSELECT,""),d.date=!1):(t.parent().find(".ogx_calendar_selected_item:first").removeClass("ogx_calendar_selected_item"),t.addClass("ogx_calendar_selected_item"),d.date=moment(t.data("ogx-date")),d.display_date=d.date.clone(),a.el.trigger(OGX.Calendar.SELECT,d.date),p()),setTimeout(h,0)}function h(){for(var e=i.getCells(),t=0;t<e.length;t++)0==e[t].offset.x&&0==e[t].offset.y||v(e[t].abs,e[t].rel,e[t].offset,$(e[t].element).children(0)[0])}function _(e){e?(n.on(OGX.GridSwiper.SWIPE_START,function(){u(!1)}),n.on(OGX.GridSwiper.SWIPE_END,function(){u(!0)}),n.on(OGX.GridSwiper.SWIPE_LEFT,function(e,t){var i=c[l].value();g(i.value,i.unit),m(c[l].labels(d.display_date))}),n.on(OGX.GridSwiper.SWIPE_RIGHT,function(e,t){var i=c[l].value();g(-1*i.value,i.unit),m(c[l].labels(d.display_date))}),n.on(OGX.GridSwiper.SWIPE_UP,function(e,t){l=t.cell.y-1,p(),m(c[l].labels(d.display_date))}),n.on(OGX.GridSwiper.SWIPE_DOWN,function(e,t){l=t.cell.y-1,p(),m(c[l].labels(d.display_date))})):(n.off(OGX.GridSwiper.SWIPE_LEFT),n.off(OGX.GridSwiper.SWIPE_RIGHT),n.off(OGX.GridSwiper.SWIPE_UP),n.off(OGX.GridSwiper.SWIPE_DOWN),n.off(OGX.GridSwiper.SWIPE_START),n.off(OGX.GridSwiper.SWIPE_END))}function g(e,t){d.display_date.add(e,t),p()}function p(){var e=c[l].format(d.display_date),t='<span class="ogx_calendar_display_date">'+d.display_date.format(e)+"</span>";d.date&&(t+='<span class="ogx_calendar_selected_date">'+d.date.format(d.format)+"</span>"),n.children(".ogx_calendar_head:first").children(".ogx_calendar_head_date:first").html(t)}function m(e){n.children(".ogx_calendar_head:first").children(".ogx_calendar_head_labels:first").html(e)}function v(e,t,i,n){if(0<=t.y-1&&t.y-1<d.layouts.length){var a=$(n),o=c[l].value(),r=d.display_date.clone().add(i.x*o.value,o.unit),s=c[t.y-1].html(r,OGX.CalendarEngine[d.layouts[t.y-1].engine],d.layouts[t.y-1].config,d.date);a.html(s)}}function y(e,t){return OGX.CalendarLayout[e].prototype=Object.create(OGX.CalendarLayout.BASE_LAYOUT.prototype),OGX.CalendarLayout[e].prototype.constructor=OGX.CalendarLayout[e],new OGX.CalendarLayout[e](t)}this._NAME_=OGX.Calendar.NAME,this.el=null,this.enable=function(){s||(s=!0,debug(5,"calendar",d.id,"enabled"),d.selectable&&u(!0),_(!0))},this.disable=function(){s&&(debug(5,"calendar",d.id,"disabled"),s=!1,d.selectable&&u(!1),_(!1))},this.val=function(e){return void 0!==e&&(d.date=e,moment.isMoment(d.date)||(d.date=moment(d.date)),d.display_date=d.date.clone(),p(),setTimeout(h,0)),d.date?d.date:""},this.display=function(e){return void 0!==e?(d.display_date=e,moment.isMoment(d.display_date)||(d.display_date=moment(d.display_date)),p(),setTimeout(h,0),!0):d.display_date},this.axis=function(e,t){d.axis.x=e,d.axis.y=t},this.getLayout=function(){return l},void 0!==OGX.GridSwiper?"undefined"!=typeof moment?(debug(5,"calender init",d.id),function(){for(var e in o)d.hasOwnProperty(e)||(d[e]=o[e]);a.el=n=$(d.el),n.addClass("ogx_calendar"),d.date&&(moment.isMoment(d.date)||(d.date=moment(d.date)),d.display_date=d.date.clone()),d.display_date?moment.isMoment(d.display_date)||(d.display_date=moment(d.display_date)):d.display_date=moment(),l=d.layout,r.y=l+1}(),n.html('<div class="ogx_calendar_head"><div class="ogx_calendar_head_date"></div><div class="ogx_calendar_head_labels"></div></div><div class="ogx_calendar_body"></div>'),function(){t=[[!1,!1,!1]];for(var e=0;e<d.layouts.length;e++)t.push([v,v,v]);t.push([!1,!1,!1])}(),function(){for(var e=0;e<d.layouts.length;e++)c.push(y(d.layouts[e].layout,{}))}(),i=a.create("GridSwiper",{el:d.el+" .ogx_calendar_body:first",loop:!0,map:t,start:{x:1,y:1},chromeos:d.chromeos}),p(),m(c[l].labels(d.display_date)),a.enable(),debug(5,"calendar",d.id,"init")):debug(1,"moment.js not found! "):debug(1,"OGX.GridSwiper not found! ")},OGX.Calendar.NAME="Calendar",OGX.Calendar.SELECT="CalendarSelect",OGX.Calendar.UNSELECT="CalendarUnselect",OGX.Calendar.BIND=OGX.Calendar.SELECT+" "+OGX.Calendar.UNSELECT,OGX.CalendarLayout={},OGX.CalendarLayout.BASE_LAYOUT=function(){"use strict";this.labels=function(e){return""},this.html=function(e,t,i,n){return""},this.value=function(){return{value:1,unit:"months"}},this.format=function(){return"YYYY-MM"}},OGX.CalendarLayout.MONTH_DAYS=function(){"use strict";OGX.CalendarLayout.BASE_LAYOUT.call(this),this.labels=function(){for(var e="",t=function(){for(var e=new Date(Date.UTC(2017,0,2)),t=[],i=0;i<7;i++)t.push(e.toLocaleDateString(navigator.language,{weekday:"short"})),e.setDate(e.getDate()+1);return t}(),i=0;i<t.length;i++)e+='<span class="ogx_calendar_layout_month_days_label">'+t[i]+"</span>";return e},this.html=function(e,t,i,n){var a,o=e.format("MM"),r=moment(e.format("YYYY-MM-")+"01").day(),s=moment(e.format("YYYY-MM-")+"01").subtract(r,"days"),l="";n&&(l=n.format("YYYY-MM-DD"));for(var d,c="",u=0;u<42;u++)d="",a=s.format("YYYY-MM-DD"),s.format("MM")!==o&&(d+="ogx_calendar_layout_month_days_offset "),a===moment().format("YYYY-MM-DD")&&(d+="ogx_calendar_layout_month_days_today "),n&&l===a&&(d+="ogx_calendar_selected_item "),c+='<div class="ogx_calendar_layout_item ogx_calendar_layout_month_days '+d+'" data-ogx-date="'+a+'">'+t(a,i)+"</div>",s.add(1,"days");return c},this.value=function(){return{value:1,unit:"months"}},this.format=function(){return"YYYY-MM"}},OGX.CalendarLayout.CENTURY_DECADES=function(){"use strict";OGX.CalendarLayout.BASE_LAYOUT.call(this),this.labels=function(e){return'<span class="ogx_calendar_layout_century_decades_label">'+100*Math.floor(Number(e.format("YYYY"))/100)+"'s</span>"},this.html=function(e,t,i,n){var a,o,r=moment(),s=100*Math.floor(Number(r.format("YYYY"))/100),l=10*Math.floor(Number(r.format("YYYY").substr(2))/10),d=100*Math.floor(Number(e.format("YYYY"))/100),c=0,u=0;n&&(c=100*Math.floor(Number(n.format("YYYY"))/100),u=10*Math.floor(Number(n.format("YYYY").substr(2))/10));for(var f="",h=0;h<10;h++)o="",s+l==d+(a=10*h)&&(o="ogx_calendar_layout_century_decades_current "),c+u===d+a&&(o+="ogx_calendar_selected_item "),f+='<div class="ogx_calendar_layout_item ogx_calendar_layout_century_decades '+o+'" data-ogx-date="'+(d+a)+'-01-01">'+t(d+a,i)+"</div>";return f},this.value=function(){return{value:100,unit:"years"}},this.format=function(){return"YYYY"}},OGX.CalendarLayout.CENTURY_YEARS=function(){"use strict";OGX.CalendarLayout.BASE_LAYOUT.call(this),this.labels=function(e){return'<span class="ogx_calendar_layout_century_decades_label">'+100*Math.floor(Number(e.format("YYYY"))/100)+"'s</span>"},this.html=function(e,t,i,n){var a,o=moment(),r=100*Math.floor(Number(o.format("YYYY"))/100),s=Number(o.format("YYYY").substr(2)),l=100*Math.floor(Number(e.format("YYYY"))/100),d=0,c=0;n&&(d=100*Math.floor(Number(n.format("YYYY"))/100),c=Math.floor(Number(n.format("YYYY").substr(2))));for(var u="",f=0;f<100;f++)a="",l+f===r+s&&(a+="ogx_calendar_layout_century_years_current "),l+f===d+c&&(a+="ogx_calendar_selected_item"),u+='<div class="ogx_calendar_layout_item ogx_calendar_layout_century_years '+a+'" data-ogx-date="'+(l+f)+'-01-01">'+t(l+f+"-01-01",i)+"</div>";return u},this.value=function(){return{value:100,unit:"years"}},this.format=function(){return"Y"}},OGX.CalendarLayout.DECADE_YEARS=function(){"use strict";OGX.CalendarLayout.BASE_LAYOUT.call(this),this.labels=function(e){return'<span class="ogx_calendar_layout_century_years_label">'+10*Math.floor(Number(e.format("YYYY"))/10)+"'s</span>"},this.html=function(e,t,i,n){var a,o=10*Math.floor(Number(e.format("YYYY"))/10),r="",s=Number(moment().format("YYYY")),l="";n&&(l=Number(n.format("YYYY")));for(var d=0;d<10;d++)a="",o+d===s&&(a+="ogx_calendar_layout_decade_years_current "),o+d===l&&(a+="ogx_calendar_selected_item "),r+='<div class="ogx_calendar_layout_item ogx_calendar_layout_decade_years '+a+'" data-ogx-date="'+(o+d)+'-01-01">'+t(o+d+"-01-01",i)+"</div>";return r},this.value=function(){return{value:10,unit:"years"}},this.format=function(){return"Y"}},OGX.CalendarLayout.DECADE_MONTHS=function(){"use strict";OGX.CalendarLayout.BASE_LAYOUT.call(this),this.labels=function(e){for(var t=10*Math.floor(Number(e.format("YYYY"))/10),i=Number(String(t).substr(2,2)),n="",a=0;a<10;a++)n+='<span class="ogx_calendar_layout_decade_months_label">\''+i+"</span>",i++;return n},this.html=function(e,t,i,n){var a,o,r,s,l=10*Math.floor(Number(e.format("YYYY"))/10),d="",c=moment().format("YYYY-MM");n&&(a=n.format("YYYY-MM"));for(var u=0;u<12;u++){s=u+1;for(var f=0;f<10;f++)o="",(r=l+f+"-"+(s<10?"0"+s:s))===c&&(o="ogx_calendar_layout_decade_months_current "),r===a&&(o+="ogx_calendar_selected_item "),d+='<div class="ogx_calendar_layout_item ogx_calendar_layout_decade_months '+o+'" data-ogx-date="'+r+'-01">'+t(moment(r+"-01"),i)+"</div>"}return d},this.value=function(){return{value:10,unit:"years"}},this.format=function(e){return"["+10*Math.floor(Number(e.format("YYYY"))/10)+"'s]"}},OGX.CalendarLayout.YEAR_MONTHS=function(){"use strict";OGX.CalendarLayout.BASE_LAYOUT.call(this),this.labels=function(e){return'<span class="ogx_calendar_layout_year_months_label">Months</span>'},this.html=function(e,t,i,n){var a,o,r=moment().format("YYYY-MM"),s=e.format("YYYY"),l="",d="";n&&(d=n.format("YYYY-MM"));for(var c=1;c<13;c++)a="",s+"-"+(o=c<10?"0"+c:c)===r&&(a+="ogx_calendar_layout_year_months_current "),s+"-"+o===d&&(a+="ogx_calendar_selected_item "),l+='<div class="ogx_calendar_layout_item ogx_calendar_layout_year_months '+a+'" data-ogx-date="'+s+"-"+o+'-01">'+t(s+"-"+o+"-01",i)+"</div>";return l},this.value=function(){return{value:1,unit:"years"}},this.format=function(){return"Y"}},OGX.CalendarLayout.YEAR_WEEKS=function(){"use strict";OGX.CalendarLayout.BASE_LAYOUT.call(this),this.labels=function(e){return'<span class="ogx_calendar_layout_year_weeks_label">Weeks</span>'},this.html=function(e,t,i,n){var a=moment().week(),o=e.format("YYYY"),r=moment().format("YYYY"),s="",l="";n&&(l=n.week(),s=n.format("YYYY"));for(var d,c,u="",f=1;f<53;f++)d="",a===f&&o===r&&(d="ogx_calendar_layout_year_weeks_current "),l===f&&o===s&&(d+="ogx_calendar_selected_item "),u+='<div class="ogx_calendar_layout_item ogx_calendar_layout_year_weeks '+d+'" data-ogx-date="'+(c=moment().year(o).week(f).format("YYYY-MM-DD"))+'">'+t(c,i)+"</div>";return u},this.value=function(){return{value:1,unit:"years"}},this.format=function(){return"Y"}},OGX.CalendarLayout.YEAR_DAYS=function(){"use strict";OGX.CalendarLayout.BASE_LAYOUT.call(this),this.labels=function(e){return'<span class="ogx_calendar_layout_year_weeks_label">Nth Day</span>'},this.html=function(e,t,i,n){var a,o,r,s="",l=e.format("YYYY-MM-DD"),d=moment(e.format("YYYY")+"-01-01"),c="";n&&(c=n.format("YYYY-MM-DD")),o=e.isLeapYear()?366:365;for(var u=0;u<o;u++)a="",(r=d.format("YYYY-MM-DD"))===l&&(a="ogx_calendar_layout_year_days_current "),r===c&&(a+="ogx_calendar_selected_item "),s+='<div class="ogx_calendar_layout_item ogx_calendar_layout_year_days '+a+'" data-ogx-date="'+r+'">'+t(moment(r),i)+"</div>",d.add(1,"days");return s},this.value=function(){return{value:1,unit:"years"}},this.format=function(){return"Y"}},OGX.CalendarLayout.MONTH_WEEKS=function(){"use strict";OGX.CalendarLayout.BASE_LAYOUT.call(this),this.labels=function(e){return'<span class="ogx_calendar_layout_year_weeks_label">Nth Week</span>'},this.html=function(e,t,i,n){var a,o="",r=moment(),s=Number(r.format("YYYY")),l=Number(r.format("w")),d=Number(e.format("YYYY")),c=0,u=0;n&&(c=Number(n.format("YYYY")),u=Number(n.format("w")));o="";for(var f,h=moment(e.format("YYYY-MM-[01]")),_=0;_<5;_++)f="",a=Number(h.format("w")),d===c&&a===u&&(f+="ogx_calendar_selected_item "),d===s&&a===l&&(f+="ogx_calendar_layout_month_weeks_current"),o+='<div class="ogx_calendar_layout_item ogx_calendar_layout_month_weeks '+f+'" data-ogx-date="'+h.format("YYYY-MM-DD")+'">'+t(h.clone(),i)+"</div>",h.add(7,"days");return o},this.value=function(){return{value:1,unit:"months"}},this.format=function(){return"[(]YYYY-MM[)] W"}},OGX.CalendarLayout.WEEK_DAYS=function(){"use strict";OGX.CalendarLayout.BASE_LAYOUT.call(this),this.labels=function(e){for(var t="",i=function(){for(var e=new Date(Date.UTC(2017,0,2)),t=[],i=0;i<7;i++)t.push(e.toLocaleDateString(navigator.language,{weekday:"short"})),e.setDate(e.getDate()+1);return t}(),n=0;n<i.length;n++)t+='<span class="ogx_calendar_layout_month_days_label">'+i[n]+"</span>";return t},this.html=function(e,t,i,n){var a,o,r="",s=e.weekday(),l=e.subtract(s,"days"),d=moment().format("YYYY-MM-DD"),c="";n&&(c=n.format("YYYY-MM-DD"));for(var u=0;u<7;u++)a="",(o=l.format("YYYY-MM-DD"))===d&&(a="ogx_calendar_layout_week_days_current "),o===c&&(a+="ogx_calendar_selected_item "),r+='<div class="ogx_calendar_layout_item ogx_calendar_layout_week_days '+a+'" data-ogx-date="'+o+'">'+t(moment(o),i)+"</div>",l.add(1,"days");return r},this.value=function(){return{value:1,unit:"weeks"}},this.format=function(){return"YYYY-MM"}},OGX.CalendarLayout.DAY_HOURS=function(){"use strict";OGX.CalendarLayout.BASE_LAYOUT.call(this),this.labels=function(e){return'<span class="ogx_calendar_layout_day_hours_label">Hours</span>'},this.html=function(e,t,i,n){var a,o,r="",s=Number(moment().format("HH")),l=e.format("YYYY-MM-DD "),d=moment().format("YYYY-MM-DD "),c="",u="";n&&(c=Number(n.format("HH")),u=n.format("YYYY-MM-DD "));for(var f=0;f<24;f++)o="",f===s&&l===d&&(o="ogx_calendar_layout_days_hours_current "),f===c&&l===u&&(o+="ogx_calendar_selected_item "),r+='<div class="ogx_calendar_layout_item ogx_calendar_layout_days_hours '+o+'" data-ogx-date="'+(l+(a=f<10?"0"+f:String(f)))+':00">'+t(moment(l+a+":00"),i)+"</div>";return r},this.value=function(){return{value:1,unit:"days"}},this.format=function(){return"YYYY-MM-DD HH:[00]"}},OGX.CalendarLayout.DAY_WORK_HOURS=function(){"use strict";OGX.CalendarLayout.BASE_LAYOUT.call(this),this.labels=function(e){return'<span class="ogx_calendar_layout_day_work_hours_label">Work Hours</span>'},this.html=function(e,t,i,n){i&&void 0!==i?i.hasOwnProperty("start")||(i.start=8,i.end=17):i={start:8,end:17};var a,o,r="",s=Number(moment().format("HH")),l=e.format("YYYY-MM-DD "),d=moment().format("YYYY-MM-DD "),c="",u="";n&&(c=Number(n.format("HH")),u=n.format("YYYY-MM-DD "));for(var f=i.start;f<i.end+1;f++)o="",f===s&&l===d&&(o="ogx_calendar_layout_days_work_hours_current "),f===c&&u===l&&(o+="ogx_calendar_selected_item "),r+='<div class="ogx_calendar_layout_item ogx_calendar_layout_days_work_hours '+o+'" data-ogx-date="'+(l+(a=f<10?"0"+f:f))+':00">'+t(moment(l+a+":00"),i)+"</div>";return r},this.value=function(){return{value:1,unit:"days"}},this.format=function(){return"YYYY-MM-DD HH:[00]"}},OGX.CalendarLayout.DAY=function(e){"use strict";this.labels=function(e){return'<span class="ogx_calendar_layout_day_label">'+function(e){for(var t=new Date(Date.UTC(2017,0,2)),i=[],n=e.day(),a=0;a<7;a++)i.push(t.toLocaleDateString(navigator.language,{weekday:"long"})),t.setDate(t.getDate()+1);return i[n]}(e)+"</span>"},this.html=function(e,t,i,n){var a="",o=e.format("YYYY-MM-DD"),r=moment().format("YYYY-MM-DD");return n&&o===n.format("YYYY-MM-DD")&&(a+="ogx_calendar_selected_item "),o===r&&(a+="ogx_calendar_layout_day_current "),'<div class="ogx_calendar_layout_item ogx_calendar_layout_day '+a+'" data-ogx-date="'+o+'">'+t(e,i)+"</div>"},this.value=function(){return{value:1,unit:"days"}},this.format=function(){return"YYYY-MM-DD"},this.select=function(e){}},OGX.CalendarEngine={},OGX.CalendarEngine.CELL_VALUE=function(e,t){var i=moment(e);return t.hasOwnProperty("css")||(t.css=""),'<div class="ogx_calendar_engine_cell_value '+t.css+'">'+i.format(t.format)+"</div>"},OGX.CalendarEngine.DAY_NUMBER=function(e,t){return OGX.CalendarEngine.CELL_VALUE(e,{format:"DD",css:"ogx_calendar_engine_day_number"})},OGX.CalendarEngine.WEEK_NUMBER=function(e,t){return'<div class="ogx_calendar_engine_week_number">'+moment(e).week()+"</div>"},OGX.CalendarEngine.MONTH_NUMBER=function(e,t){return OGX.CalendarEngine.CELL_VALUE(e,{format:"MM",css:"ogx_calendar_engine_month_number"})},OGX.CalendarEngine.YEAR_NUMBER=function(e,t){return OGX.CalendarEngine.CELL_VALUE(e,{format:"YY",css:"ogx_calendar_engine_year_number"})},OGX.CalendarEngine.DECADE_NUMBER=function(e){return'<div class="ogx_calendar_engine_date_day_number">'+String(e).substr(2)+"'s</div>"},require("Carousel","Uxi","Placeholder","Touch"),OGX.Carousel=function(e){construct(this,"Carousel");var a,d,i,t,o,r,c=this,s=e,n={min_x:100,anim:!0,drag:!0,dots:!1,css:!1,index:0},l={position:"bottom"},u=!1,f=0,h=0,_=new OGX.List,g="ogx_carousel";function p(e){void 0!==e&&_[e]&&_[e].instance&&_[e].instance&&c.find(!1,_[e].instance).blur()}function m(e){d.off("transitionend"),d.removeClass(g+"_anim")}function v(e){if(e.distX>e.distY){var t=r*i*-1+e.distX*e.dirX;t<=0&&t>-1*(d.width()-c.el.width())&&d.css({transform:"translate3d("+t+"px, 0, 0)"})}}function y(e){if(e.distX>s.min_x){var t=r+-1*e.dirX;0<=t&&t<h&&r!==t&&(p(r),r=t,a.trigger(OGX.Carousel.CHANGE,r))}var i=0;r&&(i=100/h*(-1*r)),x(i,r,!0)}function x(e,t,i){i?(d.addClass(g+"_anim"),d.on("transitionend",function(){d.off("transitionend"),d.removeClass(g+"_anim"),function(e){void 0!==e&&_[e]&&_[e].instance&&_[e].instance&&c.find(!1,_[e].instance).focus()}(t)})):d.removeClass(g+"_anim"),d.css({transform:"translate3d("+e+"%, 0, 0)"})}function O(){u=!0,clearInterval(t),t=setInterval(b,50),i=Math.floor(a.innerWidth()),d.removeClass(g+"_anim")}function b(){u=!1,clearInterval(t),t=!1}function w(){if(h){_.clear();var i,n;s.dots&&1,d.children("."+g+"_view").each(function(e,t){i=$(t),(n=i.children(":first")).length&&n[0].hasAttribute("data-ogx-id")?(e!==r&&c.nodes[e].blur(),_.push({index:e,instance:c.nodes[e].id,html:!1}),0):_.push({index:e,instance:!1,html:i.html()})})}}this._NAME_=OGX.Carousel.NAME,this.el=null,this.enable=function(){s.drag&&this.touch.swipe.enable(),debug(5,"carousel",s.id,"enabled"),setTimeout(function(){for(var e=0;e<_.length;e++)_[e].instance&&e!==r&&c.find(!1,_[e].instance).blur()},0)},this.disable=function(){s.drag&&this.touch.swipe.disable(),debug(5,"carousel",s.id,"disabled")},this.resize=function(){setTimeout(O,0)},this.show=function(e,t){var i=_.findIndex("instance",t,1);i&&this.showPanel(i.index)},this.anim=function(e){if(void 0===e)return s.anim;s.anim=e},this.destroy=function(){t&&clearInterval(t),s.dots&&o.destroy()},this.val=function(e){if(void 0===e)return r;this.showPanel(e)},this.panels=function(){return _},this.addNode=function(e,t,i,n){void 0===i&&(i=!1),void 0===n&&(n=!1);var a=function(e){void 0===e&&(e="");return h++,d.append('<div class="'+g+'_view" style="width:'+100/h+'%;" data-ogx-panel-id="'+f+'">'+e+"</div>"),d.css("width",Math.round(100*h)+"%"),d.children("."+g+"_view").css("width",100/h+"%"),++f-1}(),o="."+g+'[data-ogx-id="'+this.id+'"] .'+g+"_views:first ."+g+'_view[data-ogx-panel-id="'+a+'"]',r={},s=o;for(var l in e){s+=":"+l.split(":")[1],r[s]=e[l];break}setTimeout(function(){OGX.OML.render(c,r,t),setTimeout(w,0),i&&c.showPanel(h-1,n)},0)},this.removeNode=function(e){for(var t=0;t<_.length;t++)if(_[t].instance===e)return this.removePanel(t),!0;return!1},this.showPanel=function(e,t,i){if((void 0===i&&(i=!1),0<=e&&e<h&&!u)&&((a=r)!==e||i)){void 0===t&&(t=s.anim),p(r);var n=100/h*(-1*e),a=e;return setTimeout(function(){x(n,a,t)},0),r=e,s.dots&&o.select(e),!0}return!1},this.getPanel=function(e){return _[e]},this.swapPanels=function(e,t){var i=d.children("."+g+"_view:eq("+e+")").detach();e<t?d.children("."+g+"_view:eq("+(t-1)+")").after(i):d.children("."+g+"_view:eq("+t+")").before(i);var n=100/h*(-1*t);d.removeClass(g+"_anim"),d.css({transform:"translate3d("+n+"%, 0, 0)"}),r=t,_.swap(e,t),_[e].index=t,_[t].index=e,setTimeout(w,0),a.trigger(OGX.Carousel.CHANGE,r)},this.removePanel=function(e){return 0<=e&&e<h&&(this.nodes.length&&_[e].instance&&this.find(!1,_[e].instance,"remove"),_.splice(e,1),d.children("."+g+"_view:eq("+e+")").remove(),h--,e<=r&&r--,d.removeClass(g+"_anim").css("width",Math.round(100*h)+"%"),d.children("."+g+"_view").css("width",100/h+"%"),setTimeout(w,0),c.showPanel(e-1,!1,!0),!0)},function(){if(void 0===OGX.Data)return debug(1,"OGX.Data not found!");OGX.Data.merge(s,n,!1),s.dots&&("boolean"==typeof s.dots&&(s.dots={}),OGX.Data.merge(s.dots,l)),r=s.index,c.el=a=$(s.el),i=Math.floor(a.innerWidth()),s.hasOwnProperty("node:OML")&&(h=s["node:OML"].length),function(){s.css||(s.css=""),a.addClass(g+" "+s.css);var e="";s.dots&&"top"===s.dots.position&&(e+='<div class="carousel_dots"></div>'),e+='<div class="'+g+'_views" style="width:'+100*h+'%;"></div>',s.dots&&"bottom"===s.dots.position&&(e+='<div class="carousel_dots"></div>'),a.append(e),(d=a.find("."+g+"_views:first")).css({transform:"translate3d("+100/h*(-1*r)+"%, 0, 0)"})}(),s.dots&&(o=c.create("Dots",{el:"."+g+'[data-ogx-id="'+c.id+'"] > .carousel_dots',total:h})).bind("dots",c),function(){for(var e=[],t=0;t<h;t++)d.append('<div class="'+g+'_view" style="width:'+100/h+'%;" data-ogx-panel-id="'+f+'"></div>'),e.push("."+g+'[data-ogx-id="'+c.id+'"] > .'+g+"_views > ."+g+'_view[data-ogx-panel-id="'+f+'"]'),f++;c.placeholders(s,e),a.trigger(OGX.Carousel.READY)}(),c.touch.swipe.set({x:!0,cb_down:m,cb_swipe:v,cb_up:y}),setTimeout(w,0),s.index&&setTimeout(function(){c.showPanel(s.index,!1)},0),debug(5,"carousel",s.id,"init")}()},OGX.Carousel.NAME="Carousel",OGX.Carousel.READY="CarouselReady",OGX.Carousel.DRAG="CarouselDrag",OGX.Carousel.CHANGE="CarouselChange",OGX.Carousel.RESTORE="CarouselRestore",void 0===OGX)var OGX={};if(require("Chat","Uxi"),OGX.Chat=function(__config){construct(this,"Chat");var that=this,config=__config,config_default={placeholder:"Type a message",dot_speed:600,on_keyb_update_delay:300,messages:[],handle_keyboard:!0,hide_keyboard_on_send:!1,template_left:'<div class="ogx_chat_message ogx_chat_message_left" style="{{$opacity}} data-id="{{$uid}}"><span class="ogx_chat_message_icon" style="{{$bg}}"><span>{{$letter}}</span></span><span class="ogx_chat_message_container"><span class="ogx_chat_message_body">{{$body}}</span><span class="ogx_chat_message_date">{{$date}}</span><span style="clear:both"></span></span></div>',template_right:'<div class="ogx_chat_message ogx_chat_message_right" style="{{$opacity}}" data-id="{{$uid}}"><span class="ogx_chat_message_container"><span class="ogx_chat_message_body">{{$body}}</span><span class="ogx_chat_message_date">{{$date}}</span><span style="clear:both"></span></span></div>',key:"_id",users:[],user:!1,display_mode:OGX.Chat.DISPLAY_INITIALS,picture_key:"",restrict:{multiline:!1,length:500},date_format:"YYYY-MM-DD h:mm:ss A"},container,inner,scroller,composer,intv,winh,oldh=!1,typing={},type=".",enabled=!1;function render(){if(0<config.messages.length){for(var e=0;e<config.messages.length;e++)addMessage(config.messages[e]);scroller.resize(),scroller.bottom()}scroller.vocal()}function addMessage(__msg,__prepend){void 0===__prepend&&(__prepend=!1),scroller.observe(!1),scroller.mute();var u=config.users.find(config.key,__msg.from,1);if(u){var initals=u.first_name.substr(0,1).toUpperCase()+u.last_name.substr(0,1).toUpperCase();switch(config.display_mode){case OGX.Chat.DISPLAY_INITIALS:__msg.letter=initals,__msg.bg="";break;case OGX.Chat.DISPLAY_PICTURE:__msg.letter="";var e=eval("u."+config.picture_key);"undefined"!==e?__msg.bg="background-image:url('"+e+"')":(__msg.letter=initals,__msg.bg="")}__msg.uid=u[config.key],__msg.opacity=__prepend?"opacity:1;":"";var html=OGX.Templater.templatize(getTemplate(__msg),__msg);__prepend?inner.prepend(html):inner.append(html);var msg=inner.children(".ogx_chat_message:last");setTimeout(function(){msg.addClass("ogx_chat_message_anim"),scroller.resize(),__prepend?scroller.top():scroller.bottom(),scroller.vocal(),scroller.observe(!0)},100)}}function addTyping(e){typing[e]=!0;var t='<div class="ogx_chat_typing" data-user="'+e+'"><span class="ogx_chat_typing_body">.</div></div>';inner.append(t),animTyping(!0)}function removeTyping(e){typing[e]=!1,inner.find('.ogx_chat_typing[data-user="'+e+'"]').remove(),0===inner.find(".ogx_chat_typing").length&&animTyping(!1)}function animTyping(e){intv=e?intv||setInterval(typeDot,config.dot_speed):(clearInterval(intv),null)}function typeDot(){3<(type+=".").length&&(type="."),inner.find(".ogx_chat_typing_body").html(type)}function getTemplate(e){return e.from===config.user?config.template_right:config.template_left}function sendMessage(){var e=composer.find("textarea:first").val();if(e.length&&(e=(e=(e=e.replace(/^[\r|\n\r]+/,"")).replace(/<\/?[^>]+(>|$)/g,"")).replace(/â€™/,"'")).length){e=e.replace(/[\r\n]/g,"<br>");var t={from:config.user,body:e,date:moment().format(config.date_format)};addMessage(t);var i=JSON.parse(JSON.stringify(t));delete i.bg,delete i.letter,composer.find("textarea:first").val(""),that.el.trigger(OGX.Chat.SEND_MESSAGE,i)}}function handleShowKeyb(e){oldh=oldh||container.height(),container.height(oldh-e.keyboardHeight),updateScroller()}function handleHideKeyb(){container.height(oldh),updateScroller()}function updateScroller(){setTimeout(function(){scroller.resize(),scroller.bottom()},config.on_keyb_update_delay)}function listenKeyb(e){e?(window.addEventListener("native.keyboardshow",handleShowKeyb),window.addEventListener("native.keyboardhide",handleHideKeyb)):(window.removeEventListener("native.keyboardshow",handleShowKeyb),window.removeEventListener("native.keyboardhide",handleHideKeyb))}function listenArea(e){e?composer.on("keyup","textarea",function(e){13===e.which&&(sendMessage(),config.hide_keyboard_on_send&&handleHideKeyb())}):composer.off("keyup","textarea")}function listenComposer(e){e?composer.on("click",".ogx_chat_composer_send",function(){sendMessage(),config.hide_keyboard_on_send&&handleHideKeyb()}):composer.off("click",".ogx_chat_composer_send")}function initScroller(){scroller=that.create("Scroller",{el:that.el.find(".ogx_chat_messages:first")[0],initDelay:100,auto_scroll:!0,trigger:!0}),inner=scroller.inner(),(inner=$(inner)).addClass("ogx_chat_messages_inner"),scroller.mute(),scroller.resize(),render()}function initMarkup(){var e='<div class="ogx_chat_messages"></div><div class="ogx_chat_composer">';e+='<span class="ogx_chat_composer_input"><textarea placeholder="'+config.placeholder+'">',e+='</textarea></span><span class="ogx_chat_composer_send"></span></div>',container.append(e),composer=container.find(".ogx_chat_composer:first")}function initUsers(){for(var e in config.users)typing[e]=!1}function initDefaults(){for(var e in config_default)config.hasOwnProperty(e)||(config[e]=config_default[e]);config.users.hasOwnProperty("find")||(config.users=new OGX.List(config.users)),that.el=container=$(config.el),container.addClass("ogx_chat")}function init(){if(void 0!==OGX.Scroller)if(void 0!==OGX.Templater)if("undefined"!=typeof moment)if(config.restrict&&void 0===OGX.Form)debug(1,"OGX.Form not found! ");else{if(initDefaults(),initMarkup(),initUsers(),initScroller(),config.restrict){var e=JSON.parse(JSON.stringify(config.restrict));config.restrict.hasOwnProperty("forbidden")&&(e.forbidden=config.restrict.forbidden),config.restrict.hasOwnProperty("allowed")&&(e.allowed=config.restrict.allowed),e.el=that.el.find(".ogx_chat_composer:first .ogx_chat_composer_input:first textarea")[0],OGX.Form.restrictField(e)}that.enable(),winh=$(window).height(),debug(5,"chat",config.id,"init")}else debug(1,"moment.js not found! ");else debug(1,"OGX.Templater not found! ");else debug(1,"OGX.Scroller not found! ")}this._NAME_=OGX.Chat.NAME,this.el=null,this.enable=function(){enabled||(enabled=!0,debug(5,"chat",config.id,"enabled"),config.handle_keyboard&&listenKeyb(!0),listenComposer(!0),listenArea(!0))},this.disable=function(){this.el.find(".ogx_chat_composer:first .ogx_chat_composer_input:first textarea").blur(),enabled&&(enabled=!1,debug(5,"chat",config.id,"disabled"),config.handle_keyboard&&listenKeyb(!1),listenComposer(!1),listenArea(!1))},this.users=function(e){return void 0!==e?(e.hasOwnProperty("find")||(e=new OGX.List(e)),config.users=e,!0):config.users},this.user=function(e){return void 0===e?config.user:(config.user=e,!0)},this.typing=function(e,t){e&&!typing[t]?addTyping(t):!e&&typing[t]&&removeTyping(t)},this.compose=function(e){composer.find("textarea:first").val(e)},this.clear=function(){inner.empty()},this.getScroller=function(){return scroller},this.addMessage=function(e){addMessage(e)},this.setMessages=function(e){config.messages=e,render()},this.prependMessages=function(e){for(var t=0;t<e.length;t++)addMessage(e[t],!0);config.messages=e.concat(config.messages)},this.destroy=function(){config.restrict&&OGX.Form.unrestrictField(that.el.find(".ogx_chat_composer:first .ogx_chat_composer_input:first textarea")[0])},init()},OGX.Chat.NAME="Chat",OGX.Chat.SEND_MESSAGE="ChatSend",OGX.Chat.DISPLAY_INITIALS="ChatDisplayInitials",OGX.Chat.DISPLAY_PICTURE="ChatDisplayPicture",void 0===OGX)var OGX={};if(OGX.Color={},OGX.Color.hexToRgb=function(e){"use strict";e=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(e,t,i,n){return t+t+i+i+n+n});var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null},OGX.Color.rgbToHex=function(e,t,i){"use strict";return"#"+((1<<24)+(e<<16)+(t<<8)+i).toString(16).slice(1)},OGX.Color.rgbToHsl=function(e){"use strict";var t,i,n,a=new RegExp("rgb\\(([0-9]+)\\, ([0-9 ]+)\\, ([0-9]+)","g").exec(e);if(a){a.shift(),t=a[0],i=a[1],n=a[2],t/=255,i/=255,n/=255;var o,r,s=Math.max(t,i,n),l=Math.min(t,i,n),d=(s+l)/2;if(s===l)o=r=0;else{var c=s-l;switch(r=.5<d?c/(2-s-l):c/(s+l),s){case t:o=(i-n)/c+(i<n?6:0);break;case i:o=(n-t)/c+2;break;case n:o=(t-i)/c+4}o/=6}return[o,r,d]}return!1},OGX.Color.hslToRgb=function(e,t,i){"use strict";var n,a,o;if(0===t)n=a=o=i;else{var r=function(e,t,i){return i<0&&(i+=1),1<i&&(i-=1),i<1/6?e+6*(t-e)*i:i<.5?t:i<2/3?e+(t-e)*(2/3-i)*6:e},s=i<.5?i*(1+t):i+t-i*t,l=2*i-s;n=r(l,s,e+1/3),a=r(l,s,e),o=r(l,s,e-1/3)}return[Math.round(255*n),Math.round(255*a),Math.round(255*o)]},require("Container","Uxi"),OGX.Container=function(e){construct(this,"Container");var a=this,o={tabs:!0,carousel:{enabled:!0},enabled:!0,reorder:!0,anim:!0,drag:!0,flatten:!1,chromeos:!1,index:0,dots:!1},r=e,s=!1,l=!1,n=!1,d="normal",t=0;function i(e){e?(l.el.on(OGX.Tabs.SELECT,function(e,t){var i=l.index();n.val(i),a.el.trigger(OGX.Container.CHANGE,i)}),l.el.on(OGX.Tabs.CLOSE,function(){}),l.el.on(OGX.Tabs.REORDER,function(e,t){n.swapPanels(t.from,t.to)}),l.el.on(OGX.Tabs.ADD,function(){}),n.el.on(OGX.Carousel.CHANGE,function(e,t){l.selectIndex(t),a.el.trigger(OGX.Container.CHANGE,t)})):(l.el.off(OGX.Tabs.SELECT),l.el.off(OGX.Tabs.CLOSE),l.el.off(OGX.Tabs.REORDER),l.el.off(OGX.Tabs.ADD),n.el.off(OGX.Carousel.CHANGE)),function n(e){e?l.el.on(OGX.Tabs.REMOVE,function(e,t){n(!1);var i=a.el.parents(".ogx_popup:first").data("ogx-id");i=app.cfind("Popup",i),app.ungroupPopup(i,t.index,t.label),setTimeout(function(){n(!0)},200)}):l.el.off(OGX.Tabs.REMOVE)}(e)}this.el=null,this._NAME_=OGX.Container.NAME,this.construct=function(){n=this.find(OGX.Carousel.NAME,this.id+"_carousel")},this.show=function(e,t){if(n&&"normal"===d){var i=n.nodes.findIndex("id",t);i&&(n.val(i.index),r.tabs&&l.selectIndex(i.index))}},this.showIndex=function(e){return!(!n||"normal"!==d)&&(n.val(e),r.tabs&&l.selectIndex(e),!0)},this.enable=function(){r.tabs&&n&&i(!0),debug(5,"container",r.id,"enabled")},this.disable=function(){r.tabs&&n&&i(!1),debug(5,"container",r.id,"disabled")},this.resize=function(){r.flatten&&(n&&"flattened"!==d&&this.el.width()>=r.flatten?(d="flattened",r.tabs&&(l.blur(),l.hide()),n.blur(),t=function(e){var t=e[0].style.transform;return t=(t=t.match(/translate3d\(([0-9px%,\.\- ]+)\)/))[1].split(",")}(n.el.children(".ogx_carousel_views:first"))[0],n.el.children(".ogx_carousel_views:first").addClass("ogx_container_flattened").css("transform","translate3d(0px, 0px, 0px)")):n&&"flattened"===d&&this.el.width()<r.flatten&&(d="normal",r.tabs&&(l.focus(),l.show()),n.focus(),n.el.children(".ogx_carousel_views:first").removeClass("ogx_container_flattened").css("transform","translate3d("+t+", 0px, 0px)")))},function(){if(void 0===OGX.Data)return debug(1,"OGX.Data not found!");if(void 0===OGX.Tabs)return debug(1,"OGX.Tabs not found!");if(void 0===OGX.Carousel)return debug(1,"OGX.Carousel not found!");debug(5,"container init",r.id),OGX.Data.merge(r,o,!1),r.tabs&&"object"!=typeof r.tabs&&(r.tabs={}),a.el=s=$(r.el),s.addClass("ogx_container");var e=!1;r.tabs&&(function(){var e={el:'.ogx_container[data-ogx-id="'+a.id+'"]',reorder:r.reorder,editable:!1,chromeos:r.chromeos,enabled:r.enabled,index:r.index};e=OGX.Data.merge(r.tabs,e),l=a.create("Tabs",e)}(),e="ogx_carousel_shink");var t=r["node:OML"].slice(),i={},n='.ogx_container[data-ogx-id="'+a.id+'"]:Carousel';i["node:OML"]={},i["node:OML"][n]={id:a.id+"_carousel",css:e,anim:r.anim,chromeos:r.chromeos,drag:r.drag,enabled:r.carousel.enabled,index:r.index,dots:r.dots,"node:OML":t},r["node:OML"]=i["node:OML"],setTimeout(function(){a.resize()},0),debug(5,"container",r.id,"init")}()},OGX.Container.NAME="Container",OGX.Container.CHANGE="ContainerChange",void 0===OGX)var OGX={};if(require("Controller","Touch"),OGX.Controller=function(e){construct(this,"Controller");e=OGX.Data.merge(e,{enabled:!0,blured:!0,always_on:!1}),this.el=!1,this.enabled=e.enabled,this.blured=e.blured,this.always_on=e.always_on,this.id=e.id,this._NAME_=OGX.Controller.NAME,this.always_on&&this.focus()},OGX.Controller.prototype.blur=function(){this.always_on||this.blured||(this.blured=!0,this.ux(!1),this.disable())},OGX.Controller.prototype.focus=function(){this.blured&&(this.blured=!1,this.enabled&&(this.ux(!0),this.enable()))},OGX.Controller.prototype.construct=function(){},OGX.Controller.prototype.enable=function(){},OGX.Controller.prototype.disable=function(){},OGX.Controller.prototype.ux=function(){},OGX.Controller.prototype.resize=function(){},OGX.Controller.prototype.clear=function(){},OGX.Controller.prototype.destroy=function(){},OGX.Controller.prototype.kill=function(){OGX.Object.destroy(this)},OGX.Controller.NAME="Controller",void 0===OGX)var OGX={};if(OGX.Display=function(e){"use strict";var i,l,n={display:!1,displays:!1},a={html:!1,css:!1,oml:!1,placeholder:!1,template:!1,view:!1,bind_css:!1,add_css:!1,calc_css:!1,bind_template:!1};function d(e){if(i.display&&!i.display.hasOwnProperty("bind"))return i.display;if(i.displays&&i.display.hasOwnProperty("bind")){if(e.hasOwnProperty(i.display.bind)){var t=e[i.display.bind];return i.displays[t]}if(i.displays.hasOwnProperty("__default"))return i.displays.__default}return!1}function o(e){var t=OGX.Data.merge(a,e,!0,!0);return t.template&&("object"==typeof t.template?t.bind_template=!0:(t.html=OGX.Templater.getTemplate(t.template),t.template=!1)),t.css&&(t.bind_css="object"==typeof t.css&&t.css.hasOwnProperty("bind"),t.add_css="object"==typeof t.css&&t.css.hasOwnProperty("add"),t.calc_css="object"==typeof t.css&&t.css.hasOwnProperty("conditions")),t}function t(e){if(void 0===e&&(e={}),i=OGX.Data.clone(n),!e.hasOwnProperty("display")&&!e.hasOwnProperty("displays"))return i.display=OGX.Data.merge(a,e,!0,!0,!0),i.display=o(i.display),void(l=d());if(e.hasOwnProperty("display")&&e.display&&!e.display.hasOwnProperty("bind"))return i.display=OGX.Data.merge(a,e.display,!0,!0,!0),i.display=o(i.display),void(l=d());if(e.hasOwnProperty("display")&&e.display&&e.display.hasOwnProperty("bind")&&e.hasOwnProperty("displays")&&e.displays&&(i.display=e.display,i.displays=OGX.Data.clone(e.displays)),i.displays)for(var t in i.displays)i.displays[t]=OGX.Data.merge(a,i.displays[t],!0,!0,!0),i.displays[t]=o(i.displays[t])}this._NAME_=OGX.Display.NAME,this.val=function(e){if(void 0===e)return OGX.Data.clone(i);t(e)},this.display=function(e){return i.displays&&i.displays.hasOwnProperty(e)?(l=i.displays[e],!0):l},this.css=function(e){var t,i="",n=void 0!==e;if((t=n?d(e):l)&&(t.bind_css&&n?i+=e[t.css.bind]:t.css&&"string"==typeof t.css&&(i=t.css),t.add_css&&(i+=" "+t.css.add),t.calc_css&&n))for(var a,o,r=0;r<t.css.conditions.length;r++)if("true"===OGX.Templater.templatize(t.css.conditions[r][0],e)&&((a=t.css.conditions[r][1]).hasOwnProperty("css")&&(i=a.css),a.hasOwnProperty("add")&&(i+=" "+a.add),a.hasOwnProperty("remove"))){o=a.remove.explode(" ");for(var s=0;s<o.length;s++)i=i.replace(o[0],"")}return i||""},this.html=function(e){var t,i=!1,n=void 0!==e;return(t=n?d(e):l)&&(t.bind_template&&n?i=OGX.Templater.getTemplate(e[t.template.bind]):(t.template||t.html)&&(i=t.html),n&&i&&(i=OGX.Templater.templatize(i,e))),i=i||""},this.oml=function(e,t,i){void 0===i&&(i="&item");var n={},a=d(t);if(a=a||l){if(a.oml)return n=OGX.OML.replaceNodeName(OGX.Data.clone(a.oml),e),void 0!==i&&OGX.OML.replaceDataRecursive(n,t,i),a.placeholder?function(e,t,i){var n,a,o=OGX.Data.clone(e.oml);for(var r in o){var s,l;for(var d in n=r.replace("default",t),o[n]=o[r],o[n]["node:OML"]=[],e.placeholder){l=i[d].length;for(var c=0;c<l;c++){for(var u in s=OGX.Data.clone(e.placeholder[d]),(a=OGX.Data.clone(i))[d]=a[d][c],s){s[u].data=a;break}o[n]["node:OML"].push(s)}return delete o[r],o}}return!1}(a,e,t):n;if(a.template)return"string"==typeof a.template?n[e+":Templates."+a.template]={data:t}:n[e+":Templates."+t[a.template.bind]]={data:t},n;if(a.hasOwnProperty("html"))return n[e+":Html"]={html:this.html(t)},n}return!1},this.hasOML=function(){return!1!==l.oml},this.toJSON=function(){return i},t(e)},OGX.Display.NAME="Display",void 0===OGX)var OGX={};if(require("Dots","Uxi","Touch"),OGX.Dots=function(e){construct(this,"Dots");var n,i=this,a=e,t={el:"document",total:0,current:0,clickable:!0},o={};function r(e){switch(o[e]._NAME_){case OGX.Carousel.NAME:o[e].el.off(OGX.Carousel.CHANGE,s),delete o[e];break;case OGX.Iceberg.NAME:o[e].el.off(OGX.Iceberg.SHOW,s),delete o[e]}}function s(e,t){i.select(t)}function l(e){e?n.on(i.touch.down,".ogx_dots_item",function(){var e=Number($(this).data("id"));i.select(e),n.trigger(OGX.Dots.SELECT,e),function(e){for(var t in o)switch(o[t]._NAME_){case OGX.Carousel.NAME:o[t].val(e)}}(e)}):n.off(i.touch.down)}function d(){for(var e,t="",i=0;i<a.total;i++)e="",a.current===i&&(e="ogx_dots_selected"),t+='<div class="ogx_dots_item" data-id="'+i+'"><span class="ogx_dots_gfx '+e+'"></span></div>';n.html(t)}this._NAME_=OGX.Dots.NAME,this.el=null,this.enable=function(){a.clickable&&l(!0),debug(5,"dots",a.id,"enabled")},this.disable=function(){a.clickable&&l(!1),debug(5,"dots",a.id,"disabled")},this.bind=function(e,t){return!(o.hasOwnProperty(e)||!t.hasOwnProperty("_NAME_"))&&function(e,t){switch((o[e]=t)._NAME_){case OGX.Carousel.NAME:a.total=t.panels().length,a.current=t.val(),setTimeout(d,0),t.el.on(OGX.Carousel.CHANGE,s);break;case OGX.Iceberg.NAME:a.total=t.panels().length,a.current=t.val(),setTimeout(d,0),t.el.on(OGX.Iceberg.SHOW,s)}return!0}(e,t)},this.unbind=function(e){return!!o.hasOwnProperty(e)&&r(e)},this.select=function(e){n.find(".ogx_dots_selected").removeClass("ogx_dots_selected"),n.children(".ogx_dots_item:eq("+e+")").children(".ogx_dots_gfx:first").addClass("ogx_dots_selected"),a.current=e},this.destroy=function(){!function(){for(var e in o)r(e)}()},OGX.Data.merge(a,t),i.el=n=$(a.el),n.addClass("ogx_dots"),d(),debug(5,"dots",a.id,"init")},OGX.Dots.NAME="Dots",OGX.Dots.SELECT="DotsSelect",void 0===OGX)var OGX={};if(require("DynamicList","Uxi","Bind","Touch"),OGX.DynamicList=function(e){construct(this,"DynamicList");var d,c,u,f,l=this,h=e,t={el:null,key:!1,as:"item",display:!1,displays:!1,reorder:!1,swipe:!1,chromeos:!1,min_x:30,click_time:100,hold_time:2e3,interval:5,list:[],mode:OGX.DynamicList.SELECT_MODE_SINGLE,trigger:!1,swipe_template:'<div class="ogx_dynamic_list_item ogx_dynamic_list_swiper_back_item" style="height:{{$height}}px; z-index:{{$zindex}}; margin-bottom:{{$margin}}px;">{{$template}}</div>',zindex:1},i={mode:OGX.DynamicList.SWIPE_MODE_DELETE,options:{},template:!1,html:""},_=null,g=new OGX.List,p=1,a="__id__",m={mode:!1,stime:0,target:0,si:0,ei:0,y:0},n=null,o=null,v=null,s=0,y=new OGX.Display(h),r=!1,x=!1;function O(e,t,i){if(y.hasOML()){var n,a,o=y.oml('.ogx_dynamic_list[data-ogx-id="'+l.id+'"] .ogx_dynamic_list_item[data-ogx-id="'+i[t]+'"]',i,h.as);$('.ogx_dynamic_list[data-ogx-id="'+l.id+'"] .ogx_dynamic_list_item[data-ogx-id="'+i[t]+'"]').find(".ogx_uxi").each(function(e,t){n=$(t).data("ogx-id"),(a=l.cfind(!1,n,1))&&l.find(a._NAME_,a.id,"remove")}),OGX.OML.render(l,o,i)}else e.html(y.html(i))}function b(){var e=z(),t=g;u&&(g.resetFilters(),g.setFilters(h.list.getFilters()),_=t=g.filter(),t.length!==g.length&&(t.length?d.trigger(OGX.DynamicList.SELECT,t):d.trigger(OGX.DynamicList.UNSELECT)));for(var i,n,a,o="",r=[],s=0;s<e.length;s++)!1,n="",i=e[s][f],g.find(f,i,1)&&(n="ogx_dynamic_list_selected_item"),y.html(e[s]),o+='<div class="ogx_dynamic_list_item '+n+" "+y.css(e[s])+'" data-ogx-id='+i+"></div>",a=y.oml('.ogx_dynamic_list[data-ogx-id="'+l.id+'"] .ogx_dynamic_list_item[data-ogx-id="'+i+'"]',e[s],h.as),r.push(a);d.html(o),function(e){for(var t=0;t<e.length;t++)l.parse(e[t])}(r),h.trigger&&d.trigger(OGX.DynamicList.RENDER)}function w(e){void 0!==d&&r&&(e?d.on("click",".ogx_dynamic_list_item",P):d.off("click",".ogx_dynamic_list_item",P))}function G(e){e?d.on(l.touch.down,".ogx_dynamic_list_item",T):d.off(l.touch.down,".ogx_dynamic_list_item",T)}function X(e){o=e?setInterval(D,20):(clearInterval(o),null)}function E(e){e?d.on(l.touch.move,".ogx_dynamic_list_item",C):d.off(l.touch.move,".ogx_dynamic_list_item")}function T(e){m.mode=!1,m.target=$(e.currentTarget),m.si=m.target.index(),m.cy=d.offset().top,e=l.event(e),m.startx=e.pageX,m.starty=e.pageY,v&&clearInterval(v),m.stime=(new Date).getTime(),h.reorder&&X(!0),E(!0),$("body").on(l.touch.up,M)}function C(e){e=l.event(e),m.y=-1*(m.starty-e.pageY),m.mx=e.pageX-m.startx,m.px=e.pageX,m.py=e.pageY,m.st=!1,h.swipe&&!m.mode&&Math.abs(m.mx)>h.min_x&&(m.mode="swipe",h.scroll&&!m.st&&(m.st=!0,x.disable(),x.container().css("cssText","height:"+x.container().height()+"px !important;")),h.reorder&&X(!1),L(!0))}function D(){!m.mode&&(new Date).getTime()-m.stime>h.hold_time&&(m.mode="reorder",m.item=h.list.find(f,m.target.data("id").toString(),1),d.trigger(OGX.DynamicList.HOLD,m.item),X(!1),setTimeout(function(){m.tgy=m.target.position().top,m.tgx=m.target.position().left,m.y=0;var e=m.target.outerWidth(),t=m.target.outerHeight();m.clone=m.target.clone().css({position:"absolute",left:m.tgx+"px",top:m.tgy+"px",width:e+"px",height:t+"px"}).addClass("ogx_dynamic_list_reorder").prependTo(d),m.target.addClass("ogx_dynamic_list_frozen"),v=setInterval(k,h.interval),d.on(l.touch.move,I)}(),0))}function M(e){if($("body").off(l.touch.up,M),(h.reorder||h.swipe)&&(clearInterval(v),E(v=!1)),h.swipe&&L(!1),h.reorder&&X(!1),h.scroll&&(x.enable(),x.container().removeAttr("style")),h.reorder&&"reorder"===m.mode){if(d.off(l.touch.move,I),m.clone){var t=JSON.parse(JSON.stringify(h.list[m.si]));return h.list.delete(m.si),h.list.insert(t,m.ei),m.clone.remove(),m.clone=!1,m.target.removeClass("ogx_dynamic_list_frozen"),void d.trigger(OGX.DynamicList.DROP,m.item)}if((new Date).getTime()-m.stime<h.click_time){var i=m.target.data("id").toString(),n=h.list.find(f,i,1);d.trigger(OGX.DynamicList.SELECT,n),l.select(f,i)}}else if(h.swipe&&"swipe"===m.mode){var a=m.target.outerWidth(!0),o=Math.abs(100*m.mx/a);o<50?o?(m.target.addClass("ogx_dynamic_list_swiper_trans_item_restore"),m.target.addClass("ogx_dynamic_list_swiper_trans_item").css("transform","translateX(0px)")):(m.target.next(".ogx_dynamic_list_swiper_back_item:first").remove(),m.target.css("transform","translateX(0px)")):0<m.mx?(m.target.attr("data-side","left"),m.target.addClass("ogx_dynamic_list_swiper_trans_item").css("transform","translateX("+a+"px)")):(m.target.attr("data-side","right"),m.target.addClass("ogx_dynamic_list_swiper_trans_item").css("transform","translateX("+-1*a+"px)"))}m.mode=!1}function L(e){n=e?setInterval(S,h.interval):(clearInterval(n),!1)}function S(){if("swipe"===m.mode&&Math.abs(m.mx)>h.min_x){var e=parseInt(m.target.css("border-top-width").split("px")[0]),t=parseInt(m.target.css("border-bottom-width").split("px")[0]),i=m.target.outerHeight();if(!m.target.hasClass("ogx_dynamic_list_swiper_work")){m.target.addClass("ogx_dynamic_list_swiper_work");var n={};n.height=i,n.margin=-2*(e+t),n.top=m.target.position().top,n.zindex=h.zindex;var a="";h.swipe.template?a=OGX.Templater.getTemplate(h.swipe.template):h.swipe.html&&(a=h.swipe.html),n.template=a,a=OGX.Templater.templatize(h.swipe_template,n),m.target.after(a)}if(h.swipe.mode===OGX.DynamicList.SWIPE_MODE_SIDE&&(m.mx<0?(s=1,m.target.next(".ogx_dynamic_list_swiper_back_item:first").addClass("ogx_dynamic_list_swiper_side_left").removeClass("ogx_dynamic_list_swiper_side_right")):(s=-1,m.target.next(".ogx_dynamic_list_swiper_back_item:first").addClass("ogx_dynamic_list_swiper_side_right").removeClass("ogx_dynamic_list_swiper_side_left"))),m.py>=m.target.offset().top&&m.py<=m.target.offset().top+i){m.target.css("transform","translateX("+m.mx+"px)");var o=m.target.next(".ogx_dynamic_list_swiper_back_item:first");m.mx<0?o.addClass("ogx_dynamic_list_swiper_right").removeClass("ogx_dynamic_list_swiper_left"):o.addClass("ogx_dynamic_list_swiper_left").removeClass("ogx_dynamic_list_swiper_right")}else M(m.target)}}function N(e){e?d.on("transitionend",".ogx_dynamic_list_swiper_trans_item",A):d.off("transitionend",".ogx_dynamic_list_swiper_trans_item",A)}function A(e){var t=$(this),i=t.next(".ogx_dynamic_list_swiper_back_item:first");if(t.hasClass("ogx_dynamic_list_swiper_trans_item_restore"))i.remove(),t.css("transform","translateX(0px)"),t.removeClass("ogx_dynamic_list_swiper_trans_item");else{var n,a=t.index(),o=t.data("ogx-id");switch(h.swipe.mode){case OGX.DynamicList.SWIPE_MODE_DELETE:t.remove(),Y(i),n=h.list.findDelete(h.key,String(o),1),d.trigger(OGX.DynamicList.DELETE,{item:n,index:a});break;case OGX.DynamicList.SWIPE_MODE_SIDE:var r;n=h.list.find(h.key,o,1),r=-1===s?"right":"left",d.trigger(OGX.DynamicList.SIDED,{side:r,item:n,index:a});break;case OGX.DynamicList.SWIPE_MODE_CUSTOM:}}t.removeClass("ogx_dynamic_list_swiper_work"),t.removeClass("ogx_dynamic_list_swiper_trans_item_restore")}function Y(e){e.addClass("ogx_dynamic_list_swiper_delete"),e.on("transitionend",function(){e.off("transitionend"),e.remove()})}function I(e){e.preventDefault(),e.stopImmediatePropagation(),e=l.event(e),m.y=-1*(m.starty-e.pageY)}function k(){if(1<Math.abs(d.offset().top-m.cy))return clearInterval(v),v=!1,m.clone.remove(),m.clone=!1,m.target.removeClass("ogx_dynamic_list_frozen"),void d.trigger(OGX.DynamicList.RELEASE);var i=!1,e=d.children(".ogx_dynamic_list_item:last"),t=e.offset().top+-1*m.cy;if(m.tgy+m.y<t?m.clone.css({top:m.tgy+m.y}):i=e,!i){var n,a,o,r,s=0;d.children(".ogx_dynamic_list_item").each(function(e,t){if((t=$(t))[0]!==m.clone[0]&&!t.hasClass("ogx_dynamic_list_frozen")){if(n=t.offset().top,a=t.outerHeight(),r=n+a/2,o=m.clone.offset().top,n<o&&o<r)return s=-1,void(i=t);if(r<o&&o<n+a)return s=1,void(i=t)}})}if(i){switch(m.ei=h.list.findIndex(f,$(i).data("id").toString()).index,s){case-1:i.index()-1!==m.target.index()&&m.target.detach().insertBefore(i);break;case 1:i.index()+1!==m.target.index()&&m.target.detach().insertAfter(i)}i=!1}}function P(e){var t=$(this);switch(h.mode){case OGX.DynamicList.SELECT_MODE_SINGLE:t.hasClass("ogx_dynamic_list_selected_item")||t.hasClass("ogx_dynamic_list_swiper_trans_item")||(W(t.index(),!0),d.trigger(OGX.DynamicList.SELECT,g[g.length-1]));break;case OGX.DynamicList.SELECT_MODE_TOGGLE:t.hasClass("ogx_dynamic_list_selected_item")||t.hasClass("ogx_dynamic_list_swiper_trans_item")?(W(t.index(),!1),d.trigger(OGX.DynamicList.UNSELECT)):(l.resetSelection(),W(t.index(),!0),d.trigger(OGX.DynamicList.SELECT,g[g.length-1]));break;case OGX.DynamicList.SELECT_MODE_MULTI:var i;if(t.hasClass("ogx_dynamic_list_selected_item")||t.hasClass("ogx_dynamic_list_swiper_trans_item"))W(t.index(),!1),d.trigger(OGX.DynamicList.UNSELECT);else W(t.index(),!0),i=u?_:g,d.trigger(OGX.DynamicList.SELECT,i);break;case OGX.DynamicList.SELECT_MODE_HIT:var n=z();if(t.hasClass("ogx_dynamic_list_swiper_back_item")){var a="left";t.hasClass("ogx_dynamic_list_swiper_side_right")&&(a="right"),d.trigger(OGX.DynamicList.BACK_HIT,{side:a,item:n[t.index()]})}else d.trigger(OGX.DynamicList.SELECT,n[t.index()])}}function R(e,t,i){"single"===h.mode&&l.resetSelection();var n,a=z().find(e,t);a&&!Array.isArray(a)&&(a=[a]);for(var o=0;o<a.length;o++)(n=d.find('.ogx_dynamic_list_item[data-ogx-id="'+a[o][f]+'"]:first'))&&(i?(n.addClass("ogx_dynamic_list_selected_item"),g.push(a[o])):n.removeClass("ogx_dynamic_list_selected_item"));return"single"===h.mode&&a.length?a[0]:a}function W(e,t){var i,n=z();if(0<(i=d.find(".ogx_dynamic_list_item:eq("+e+")")).length){if(h.mode===OGX.DynamicList.SELECT_MODE_SINGLE&&l.resetSelection(),t)i.addClass("ogx_dynamic_list_selected_item"),g.push(n[e]);else{i.removeClass("ogx_dynamic_list_selected_item");var a=i.data("ogx-id");h.key||(a=String(a)),g.findDelete(f,a,1)}return!0}return!1}function z(){return u?c:h.list}function H(){for(var e=0;e<h.list.length;e++)h.list[e][f]=String(p),p++}function U(e){for(var t=0;t<e.length;t++)delete e[t][f];return e}this._NAME_=OGX.DynamicList.NAME,this.el=null,this.enable=function(){return debug(5,"dynamicList",this.id,"enabled"),h.mode!==OGX.DynamicList.STATIC&&(this.touch.enable(),w(!0),(h.reorder||h.swipe)&&(G(!0),h.swipe&&N(!0)),!0)},this.disable=function(){return debug(5,"dynamicList",this.id,"disabled"),h.mode!==OGX.DynamicList.STATIC&&(this.touch.disable(),w(!1),(h.reorder||h.swipe)&&(G(!1),h.swipe&&N(!1)),!0)},this.bindFilter=function(e,t,i){if(debug(4,"dynamicList",this.id,"filter",e,JSON.stringify(i)),void 0!==i)if("object"==typeof i)for(var n in i)h.list.removeFilter(n),h.list.addFilter(n,t,i[n]);else h.list.removeFilter(e),h.list.addFilter(e,t,i);h.list.getFilters()&&(c=h.list.filter(),u=!0),setTimeout(b,0)},this.bindValue=function(){return this.getSelection()},this.destroy=function(){this.clearBinds(),d.empty(),d.removeClass("ogx_dynamic_list")},this.val=function(e,t){if(void 0===e){if(h.key)return h.list;var i=JSON.parse(JSON.stringify(h.list));return U(OGX.List(i))}var n;debug(4,"dynamicList",this.id,"set",e.length,"items"),void 0===t&&(t=!1),e.hasOwnProperty("insert")||(e=new OGX.List(e)),t||(n=h.list.getFilters()),h.list=e,h.key||(p=1,f=a,H()),!t&&Object.keys(n).length?(h.list.setFilters(n),setTimeout(this.filter,0)):setTimeout(b,0)},this.getFilteredList=function(){if(u){if(h.key)return c;var e=JSON.parse(JSON.stringify(c));return U(OGX.List(e))}return!1},this.display=function(e){return void 0===e?h.display:h.display.val(e)},this.mode=function(e){return void 0===e?h.mode:(h.mode=e,!0)},this.order=function(e,t){return h.list.order(e,t),setTimeout(b,0),!0},this.filter=function(){return debug(4,"dynamicList",h.id,"filtering with",Object.keys(h.list.getFilters()).length,"filters"),c=h.list.filter(),u=!0,setTimeout(b,0),c},this.unfilter=function(){return u=!1,setTimeout(b,0),!0},this.addFilter=function(e,t,i){return h.list.addFilter(e,t,i)},this.removeFilter=function(e,t,i){return h.list.removeFilter(e,t,i)},this.resetFilters=function(){return h.list.resetFilters()},this.getFilters=function(){return h.list.getFilters()},this.insert=function(e,t){if(!Array.isArray(e)){h.key||(e[f]=p++);var i=!1,n=!0;if(u){var a=new OGX.List(e);a.setFilters(h.list.getFilters()),0===a.filter().length?n=!1:c.push(e)}var o='<div class="ogx_dynamic_list_item '+y.css(e)+'" data-ogx-id='+e[f]+"></div>",r=y.oml('.ogx_dynamic_list[data-ogx-id="'+this.id+'"] .ogx_dynamic_list_item[data-ogx-id="'+e[f]+'"]',e,h.as);if(void 0===t)h.list.push(e),n&&d.append(o);else if(h.list.insert(e,t),n&&(u?i=(c=h.list.filter()).findIndex(f,e[f]):0===t?d.prepend(o):i=h.list.findIndex(f,e[f]),i)){var s=d.children(".ogx_dynamic_list_item:nth-child("+(i.index+1)+")");0<s.length?s.before(o):d.append(o)}return this.parse(r),h.trigger&&d.trigger(OGX.DynamicList.RENDER),n}for(var l=0;l<__items.length;l++)void 0!==t?this.insert(__items[l],t+l):this.insert(__items[l])},this.delete=function(e){var t=z().delete(e);if(t){var i=d.children(".ogx_dynamic_list_item:eq("+e+")");return this.remove(t[f]),i.remove(),!0}return!1},this.deleteSelection=function(){for(var e=z(),t=0;t<g.length;t++)e.findDelete(f,g[t][f],1),this.remove(g[t][f]),d.children(".ogx_dynamic_list_selected_item").remove();return!0},this.findDelete=function(e,t,i){void 0===i&&1===arguments.length&&(t=e,e=f);var n,a,o=h.list.findDelete(e,t,i);o&&!Array.isArray(o)&&(o=[o]);for(var r=0;r<o.length;r++)a=(n=d.children('.ogx_dynamic_list_item[data-ogx-id="'+o[r][f]+'"]:first')).next(".ogx_dynamic_list_swiper_back_item:first"),n.remove(),this.remove(o[r][f]),Y(a);return o},this.findIndex=function(e,t){1===arguments.length&&(t=e,e=f);var i=h.list.find(e,t,1);return i?d.children('.ogx_dynamic_list_item[data-ogx-id="'+i[f]+'"]').index():-1},this.findReplace=function(e,t,i){2===arguments.length&&(i=t,t=e,e=f),h.key||(i[f]=p++);var n=h.list.findReplace(e,t,i,1);if(n){var a=d.children('.ogx_dynamic_list_item[data-ogx-id="'+n[f]+'"]:first');return a.length&&(a.attr("data-ogx-id",i[f]),O(a,f,i),h.trigger&&d.trigger(OGX.DynamicList.RENDER)),!0}return!1},this.select=function(e,t){return R(e,t,!0)},this.selectIndex=function(e){return W(e,!0)},this.unselect=function(e,t){return R(e,t,!1)},this.unselectIndex=function(e){return W(e,!1)},this.resetSelection=function(){g=new OGX.List,d.children(".ogx_dynamic_list_selected_item").removeClass("ogx_dynamic_list_selected_item")},this.getSelection=function(e){return void 0===e&&(e=!1),e?d.children(".ogx_dynamic_list_selected_item"):h.key?g:U(JSON.parse(JSON.stringify(g)))},this.getElement=function(e,t){1===arguments.length&&(t=e,e=f);var i=h.list.find(e,t,1);return!!i&&d.children('.ogx_dynamic_list_item[data-ogx-id="'+i[f]+'"]')[0]},this.findUpdate=function(e,t,i,n,a,o){var r;"number"==typeof n&&(o=a,Array.prototype.unshift.call(arguments,f)),void 0===o&&(o=!0);var s=h.list.findUpdate.apply(h.list,arguments);if(s&&!Array.isArray(s)&&(s=[s]),s.length&&o){for(var l=0;l<s.length;l++)(r=d.children('.ogx_dynamic_list_item[data-ogx-id="'+s[l][f]+'"]:first')).length&&(O(r,f,s[l]),h.trigger&&d.trigger(OGX.DynamicList.RENDER));return s.length}return!1},this.refresh=function(e,t,i){var n=arguments.length;void 0!==i&&n--,1===n&&(t=e,e=f);var a=h.list.find(e,t,i);if(a&&a.length){for(var o,r=0;r<a.length;r++)0<(o=d.children('.ogx_dynamic_list_item[data-ogx-id="'+a[r][f]+'"]')).length&&O(o,f,a[r]);return!0}return!1},this.restore=function(e,t){1===arguments.length&&(t=e,e=f);var i=h.list.find(e,t,1),n=d.children('.ogx_dynamic_list_item[data-ogx-id="'+i[f]+'"]');n.addClass("ogx_dynamic_list_swiper_trans_item_restore"),n.css({transform:"translateX(0px)","z-index":h.zindex+1}),setTimeout(function(){n.next(".ogx_dynamic_list_swiper_back_item:first").remove()},200)},this.clear=function(){d.empty()},this.reset=function(){d.empty(),u=!1,h.list=new OGX.List,g=new OGX.List,c=new OGX.List},this.render=function(){setTimeout(b,0)},void 0!==OGX.Templater?void 0!==OGX.List?void 0!==OGX.Display?(OGX.hasOwnProperty("Tags")||(OGX.Tags={NAME:"OgxTags"}),OGX.hasOwnProperty("Switch")||(OGX.Switch={NAME:"OgxSwitch"}),OGX.hasOwnProperty("Roulette")||(OGX.Roulette={NAME:"OgxRoulette"}),h=h||{},OGX.Data.merge(h,t),h.list.hasOwnProperty("_NAME_")||(h.list=new OGX.List(h.list)),!h.key&&0<h.list.length?(f=a,H()):f=h.key,h.swipe&&("object"!=typeof h.swipe&&(h.swipe={}),OGX.Data.merge(h.swipe,i)),l.el=d=$(h.el),d.addClass("ogx_dynamic_list"),l.val(h.list),r=!0,l.blured||w(!0),d.trigger(OGX.DynamicList.READY),h.scroll&&(x=l.find(OGX.Scroller.NAME,h.id+"_scroller")),debug(5,"dyanmiclist",h.id,"init")):debug(1,"OGX.Display not found! "):debug(1,"OGX.List not found! "):debug(1,"OGX.Templater not found! ")},OGX.DynamicList.NAME="DynamicList",OGX.DynamicList.HOLD="DynamicListHold",OGX.DynamicList.RELEASE="DynamicListRelease",OGX.DynamicList.DROP="DynamicListDrop",OGX.DynamicList.SELECT="DynamicListSelect",OGX.DynamicList.DELETE="DynamicListDelete",OGX.DynamicList.SIDED="DynamicListSided",OGX.DynamicList.BACK_HIT="DynamicListBackHit",OGX.DynamicList.UNSELECT="DynamicListUnselect",OGX.DynamicList.RENDER="DynamicListRender",OGX.DynamicList.SELECT_MODE_SINGLE="single",OGX.DynamicList.SELECT_MODE_TOGGLE="toggle",OGX.DynamicList.SELECT_MODE_MULTI="multi",OGX.DynamicList.SELECT_MODE_HIT="hit",OGX.DynamicList.STATIC="static",OGX.DynamicList.SWIPE_LEFT="DynamicListSwipeLeft",OGX.DynamicList.SWIPE_RIGHT="DynamicListSwipeRight",OGX.DynamicList.SWIPE_MODE_DELETE="DynamicListSwipeModeDelete",OGX.DynamicList.SWIPE_MODE_SIDE="DynamicListSwipeModeSide",OGX.DynamicList.SWIPE_MODE_CUSTOM="DynamicListSwipeModeCustom",OGX.DynamicList.READY="DynamicListReady",OGX.DynamicList.BIND=OGX.DynamicList.SELECT+" "+OGX.DynamicList.UNSELECT,void 0===OGX)var OGX={};if(OGX.Form=function(){"use strict";var that=this,form_default={el:!1,allowed:!1,forbidden:!1,change_cb:!1,submit_cb:!1,validate:!1,elem_types:["input","textarea"],wait:1e3,fields:{}},field_default={el:!1,allowed:/^[a-z0-9\\!\\.\\?\\#\\@\\$\\:\\(\\)\\/_,;%'"â€™ \\-]$/gi,forbidden:!1,pattern:!1,validate:!1,mask:!1,mask_char:"%",paste:!0,autocomplete:null,multiline:!1,input_cb:!1,change_cb:!1,val:null,changing:!1,wait:2e3,intv:!1,max:2500,type:"string",params:null},binds=new OGX.List,restricts=new OGX.List;function bindForm(i){for(var n,a,o={el:i.el,config:i,form:$(i.el),fields:new OGX.List,val:""},r=0;r<i.elem_types.length;r++)o.form.find(i.elem_types[r]).each(function(e,t){t.hasAttribute("name")&&(a=t.getAttribute("name"),n=OGX.Data.clone(field_default),OGX.Data.merge(n,i,!0,!1,!0),i.fields.hasOwnProperty(a)&&(n=OGX.Data.merge(n,i.fields[a],!0)),n.el=i.el+" "+i.elem_types[r]+'[name="'+a+'"]',n.change_cb=onFormChange,n.params=i.el,bindField(n),o.fields.insert({el:n.el}))});o.form.on("submit",function(e){e.preventDefault(),e.stopImmediatePropagation();var t={obj:formToObject(o.el),form:o.el};if(o.config.validate){var i=that.validateForm(o.el);!0===i?t.valid=!0:(t.valid=!1,t.error=i)}o.config.submit_cb?o.config.submit_cb(t):o.form.trigger("submit",t)}),binds.insert(o)}function onFormChange(e,t){var i,n=binds.find("el",t,1);if(n&&n.config.change_cb){for(var a in n.fields)if(n.fields[a].intv)return;var o=formToObject(n.form);for(var r in o)n.config.fields.hasOwnProperty(r)&&n.config.fields[r].hasOwnProperty("type")?o[r]=typeVal(n.config.fields[r].type,o[r]):n.config.hasOwnProperty("type")&&(o[r]=typeVal(n.config.type,o[r]));if(i=JSON.stringify(o),n.val!==i){var s;if(n.val=i,n.config.validate){s={obj:o,form:t,valid:!1};var l=that.validateForm(n.form);!0===l?s.valid=!0:(s.valid=!1,s.error=l)}else s=o;n.config.change_cb(s)}}}function bindField(e){var l={el:e.el,config:e,field:$(e.el),intv:!1};l.name=l.field.attr("name"),l.val=l.field.val(),l.field.val(l.val),e.pattern&&l.field.attr("pattern",e.pattern),binds.insert(l),$(document).on("input change",l.el,function(){var e=$(this).val();if(e!==l.val){if(l.config.input_cb){var t={value:null,obj:{},el:null};e=typeVal(l.config.type,e),t.el=l.field[0],t.value=e,t.property=name,t.obj[name]=e,l.config.input_cb(t,l.config.params)}l.intv||(l.intv=setInterval(function(){checkField(l)},50))}}),e.multiline||$(document).on("keydown",l.el,function(e){if(8!==e.which&&13!==e.which&&void 0!==e.key&&1===e.key.length){var t=$(this).val(),i=e.key;if(13!==e.which&&l.config.mask){if(t.length>=l.config.mask.length)return e.preventDefault(),e.stopImmediatePropagation(),!1;for(var n=l.config.mask,a=0;a<t.length;a++)l.config.mask.substr(a,1)===l.config.mask_char&&(n=n.replace(l.config.mask_char,t.substr(a,1)));var o=n.indexOf(l.config.mask_char),r=!1;return o+1<n.length+1&&(r=n.substr(o+1,1)),-1!==o&&(i===l.config.mask.substr(n.indexOf(l.config.mask_char)-1,1)?n=n.substr(0,n.indexOf(l.config.mask_char)-1):(n=n.substr(0,n.indexOf(l.config.mask_char)),r&&r!==l.config.mask_char&&setTimeout(function(){l.field.val(n+i+r)},0))),void l.field.val(n)}}if(13===e.which){e.preventDefault(),e.stopImmediatePropagation();t=$(this).val();if(l.intv&&(clearInterval(l.intv),l.intv=null),l.config.change_cb){var s={value:null,obj:{},el:null};t=typeVal(l.config.type,t),s.el=l.field[0],s.property=l.name,s.value=t,s.obj[l.name]=t,l.config.validate&&(s.valid=l.field[0].checkValidity()),l.config.change_cb(s,l.config.params)}else l.field.trigger("change",t)}}),(l.config.allowed||l.config.forbidden)&&that.restrictField(l.config)}function typeVal(e,t){switch(e){case"string":return String(t);case"number":return Number(t);case"int":return parseInt(t);case"bool":return"true"===t||1===t}}function restrictField(e){var i={el:e.el,config:e,field:$(e.el),keys:[],content:null},n=[8,9];if(null===e.autocomplete&&i.field[0].hasAttribute("autocomplete")&&"on"===i.field.attr("autocomplete")?e.autocomplete=!0:e.autocomplete=!1,e.autocomplete||i.keys.push(229),(e.autocomplete||e.paste)&&e.hasOwnProperty("allowed")&&e.allowed){var t=e.allowed.toString(),a=t.match(/\$\/([gi])+/),o="gi";a&&(t=t.replace(a[0],"+$"),o=a[1]),t=t.replace("/^","^"),e.allowed=new RegExp(t,o)}-1!==["input","texarea"].indexOf(i.field.get(0).tagName.toLowerCase())?i.content="val":i.content="html",i.config.multiline||i.keys.push(13),$(document).on("textInput keydown",i.el,function(e){if("textInput"===e.type){var t=e.originalEvent.data;if(i.config.allowed&&!t.match(i.config.allowed))return e.preventDefault(),e.stopImmediatePropagation(),!1;if(i.config.forbidden&&t.match(i.config.forbidden))return e.preventDefault(),e.stopImmediatePropagation(),!1;if("keydown"===e.type){if(-1!==i.keys.indexOf(e.which))return e.preventDefault(),e.stopImmediatePropagation(),!1;if($(this)[i.content]().length>=i.config.max&&-1===e.which.indexOf(n))return e.preventDefault(),e.stopImmediatePropagation(),!1}}}),i.config.paste||$(document).on("paste",i.el,function(e){e.preventDefault(),e.stopImmediatePropagation()}),restricts.insert(i)}function formToObject(e){return $(e).serializeArray().map(function(e){return this[e.name]=e.value,this}.bind({}))[0]}function checkField(e){var t=$(e.el).val();if(e.val!==t&&(e.val=t,e.config.changing=(new Date).getTime()),e.config.changing&&(new Date).getTime()>e.config.wait+e.config.changing&&(clearInterval(e.intv),e.intv=!1,e.config.change_cb)){var i={value:null,obj:{},el:null};t=typeVal(e.config.type,t),i.el=e.field[0],i.property=e.name,i.value=t,i.obj[i.property]=t,e.config.validate&&(i.valid=i.el.checkValidity()),e.config.change_cb(i,e.config.params)}}this.bindForm=function(e){return!binds.find("el",e.el,1)&&(OGX.Data.merge(e,form_default),bindForm(e),!0)},this.unbindForm=function(e){var t=binds.find("el",e,1);if(t){for(var i in $(document).off("submit",t.el),t.fields)this.unbindField(t.fields[i].el);binds.findDelete("el",e,1)}},this.bindField=function(e){return!binds.find("el",e.el,1)&&(OGX.Data.merge(e,field_default),bindField(e),!0)},this.unbindField=function(e){if(!binds.find("el",e,1))return!1;var t=binds.find("el",e,1);t&&($(document).off("input change",t.el),t.config.multiline||$(document).off("keydown",t.el),t.intv&&clearInterval(t.intv),restricts.find("el",t.el,1)&&this.unrestrictField(t.el),binds.findDelete("el",t.el,1))},this.restrictField=function(e){return!restricts.find("el",e.el,1)&&(restrictField(e),!0)},this.unrestrictField=function(e){if(!restricts.find("el",e,1))return!1;var t=restricts.find("el",e,1);return $(document).off("textInput keydown",t.el),t.config.paste||$(document).off("paste",t.el),restricts.findDelete("el",e,1),!0},this.formToObj=function(e){return formToObject(e)},this.populateForm=function(__form,__data){var form=$(__form),name,el,val;form.find("*[name]").each(function(__idx,__el){name=__el.getAttribute("name"),val=!1;try{val=eval("__data."+name)}catch(e){}val&&(el=$(__el),el.val(val),__el.hasAttribute("type")&&"hidden"===el.attr("type")&&el.trigger("change"))})},this.validateForm=function(e){for(var i,n,a,t=$(e),o={},r=!0,s=form_default.elem_types,l=0;l<s.length;l++)t.find(s[l]).each(function(e,t){i=$(t),t.hasAttribute("required")&&t.hasAttribute("pattern")&&("input"===i[0].tagName&&"submit"!==i.attr("type")||"input"!==i[0].tagName)&&(n=i.attr("pattern"),a=i.val(),n&&((n=new RegExp(n,"g")).test(a)||(o[i.attr("name")]=!1,r=!1)))});return!!r||o}},OGX.Form=new OGX.Form,void 0===OGX)var OGX={};if(OGX.Geo=function(e){"use strict";var s=this;void 0===e&&(e={});var o,t,i,n={map:null,markers:[],icon:"",browser_loc:null},l=e;function r(e,t){for(var i,n={},a=0;a<e.length;a++){i=!1;for(var o=0;o<t.length;o++){for(var r=0;r<t[o].address_components.length;r++)if(-1!==t[o].address_components[r].types.indexOf(e[a][0])){n.hasOwnProperty(e[a][1])&&n[e[a][1]].length||(n[e[a][1]]=t[o].address_components[r].short_name),i=!0;break}if(i)break}}return n=s.clean(n)}function d(e){return e*(Math.PI/180)}function c(e){return Array.isArray(e)?new google.maps.LatLng(e[0],e[1]):"function"!=typeof e.lat?new google.maps.LatLng(e.lat,e.lng):e}function a(e){var t={gmap:new google.maps.LatLng(e.coords.latitude,e.coords.longitude),raw:{lat:e.coords.latitude,lng:e.coords.longitude}};i?(i(t),i=null):$(document).trigger(OGX.Geo.BROWSER_LOC_SUCCESS,t)}function u(e){$(document).trigger(OGX.Geo.BROWSER_LOC_ERROR,e)}this._NAME_=OGX.Geo.NAME,this.setMap=function(e){l.map=e,google.maps.event.addListenerOnce(l.map,"tilesloaded",function(){$(document).trigger(OGX.Geo.MAP_LOADED)})},this.getMap=function(){return l.map},this.getMapRadius=function(){return!!l.map&&function(){if(l.map){var e=l.map.getBounds(),t=e.getCenter(),i=e.getNorthEast(),n=t.lat()/57.2958,a=t.lng()/57.2958,o=i.lat()/57.2958,r=i.lng()/57.2958;return 3963*Math.acos(Math.sin(n)*Math.sin(o)+Math.cos(n)*Math.cos(o)*Math.cos(r-a))}return!1}()},this.getCurrentLocation=function(){return!!l.map&&function(){var e=l.map.getCenter();return new google.maps.LatLng(e.lat(),e.lng())}()},this.getBrowserLocation=function(e){i=void 0===e?null:e,navigator.geolocation.getCurrentPosition(a,u,{maximumAge:0,timeout:1e4,enableHighAccuracy:!0})},this.getDistance=function(e,t,i,n){var a=d(i-e),o=d(n-t),r=Math.sin(a/2)*Math.sin(a/2)+Math.cos(d(e))*Math.cos(d(i))*Math.sin(o/2)*Math.sin(o/2),s=6371*(2*Math.atan2(Math.sqrt(r),Math.sqrt(1-r)));return Math.round(1e3*s)/1e3},this.addressToLatLng=function(e,i,n){o.geocode({address:e},function(e,t){t==google.maps.GeocoderStatus.OK?i(e[0].geometry.location,n):i(!1,n)})},this.getCityBoundaries=function(e,t,i,n,a){o.geocode({address:e+", "+t+", "+i},function(e,t){t==google.maps.GeocoderStatus.OK?n(e[0].geometry,a):n(!1,a)})},this.latLngToZip=function(e,n,t){e=c(e),o.geocode({location:e},function(e,t){if(t===google.maps.GeocoderStatus.OK){var i=r([["postal_code","zip"]],e);n(i)}})},this.latLngToCountryStateCity=function(e,n,a){e=c(e),o.geocode({location:e},function(e,t){if(t===google.maps.GeocoderStatus.OK){var i=r([["country","country"],["administrative_area_level_1","state"],["locality","city"],["administrative_area_level_2","city"]],e);n(i,a)}else n(!1,a)})},this.partialAddressToCountryStateCity=function(e,n,a){o.geocode({address:e},function(e,t){if(t===google.maps.GeocoderStatus.OK){var i=r([["country","country"],["administrative_area_level_1","state"],["locality","city"],["administrative_area_level_2","city"]],e);n(i,a)}else n(!1,a)})},this.latLngToAddress=function(e,n,a){e=c(e),o.geocode({location:e},function(e,t){if(t===google.maps.GeocoderStatus.OK){var i=r([["street_number","number"],["route","street"],["postal_code","zip"],["country","country"],["administrative_area_level_1","state"],["locality","city"],["administrative_area_level_2","city"]],e);e[0].hasOwnProperty("formatted_address")&&(i.formatted=e[0].formatted_address),n(i,a)}else n(!1,a)})},this.partialAddressToAddress=function(e,n,a){o.geocode({address:e},function(e,t){if(t===google.maps.GeocoderStatus.OK){var i=r([["street_number","number"],["route","street"],["postal_code","zip"],["country","country"],["administrative_area_level_1","state"],["locality","city"],["administrative_area_level_2","city"]],e);e[0].hasOwnProperty("formatted_address")&&(i.formatted=e[0].formatted_address),i.lat=e[0].geometry.location.lat(),i.lng=e[0].geometry.location.lng(),n(i,a)}else n(!1,a)})},this.zipToAddress=function(e,t,i){this.partialAddressToAddress(e,t,i)},this.zipToLatLng=function(e,n,a){o.geocode({address:e},function(e,t){if(t===google.maps.GeocoderStatus.OK){var i={};i.lat=e[0].geometry.location.lat(),i.lng=e[0].geometry.location.lng(),n(i,a)}else n(!1,a)})},this.getRoute=function(i){var e={start:!1,end:!1,waypoints:!1,optimize:!0,mode:OGX.Geo.TRAVEL_MODE_CAR,callback:!1,params:!1};for(var t in e)i.hasOwnProperty(t)||(i[t]=e[t]);var n=new google.maps.DirectionsService,a={origin:i.start,destination:i.end,travelMode:i.mode};i.waypoints&&(a.waypoints=i.waypoints,i.optimize&&(a.optimizeWaypoints=!0)),n.route(a,function(e,t){t===google.maps.DirectionsStatus.OK?i.callback(e,i.params):i.callback(!1,i.params)})},this.calcRouteMinutes=function(e){for(var t=0,i=0;i<e.legs.length;i++)t+=e.legs[i].duration.value;return t=Math.round(t/60)},this.drawRoute=function(e){(t=t||new google.maps.DirectionsRenderer).setMap(l.map),t.setDirections(e)},this.clearMap=function(){l.map&&t&&t.setMap(null)},this.latLngToLoc=function(e,t){return new google.maps.LatLng(e,t)},this.clean=function(e,t){var i;if(void 0===t&&(t=!1),e.hasOwnProperty("city")&&e.hasOwnProperty("vicinity")&&-1!==e.vicinity.indexOf(",")&&(i=new RegExp(", ([a-z -']+)$","gi").exec(e.vicinity))&&1<i.length&&(e.city===i[1]?e.vicinity=e.vicinity.replace(i[0],""):e.city?e.city.length>i[1].length&&(e.city=i[1],e.vicinity=e.vicinity.replace(i[0],"")):e.city=i[1]),t)for(var n in e)-1===t.indexOf(n)&&delete e[n];return e},"undefined"!=typeof google&&void 0!==google.maps?(o=new google.maps.Geocoder,function(){for(var e in n)l.hasOwnProperty(e)||(l[e]=n[e])}(),l.map&&l.markers.length):$(document).trigger(OGX.Geo.ERROR_GMAP)},OGX.Geo.NAME="Geo",OGX.Geo.ERROR="GEO_error",OGX.Geo.ERROR_GMAP="GEO_GMAP_ERROR",OGX.Geo.TRAVEL_MODE_CAR="DRIVING",OGX.Geo.TRAVEL_MODE_TRANSIT="TRANSIT",OGX.Geo.TRAVEL_MODE_WALK="WALKING",OGX.Geo.TRAVEL_MODE_BIKE="BICYCLING",OGX.Geo.BROWSER_LOC_SUCCESS="GEO_BROWSER_LOC_SUCCESS",OGX.Geo.BROWSER_LOC_ERROR="GEO_BROWSER_LOC_ERROR",OGX.Geo.MAP_LOADED="GEO_MAP_LOADED",void 0===OGX)var OGX={};if(require("Ghost","Uxi"),OGX.Ghost=function(e){construct(this,"Ghost"),this.el=$(e.el),this._NAME_=OGX.Ghost.NAME,css="ogx_ghost",e.hasOwnProperty("css")&&(css+=" "+e.css),this.el.addClass(css),delete css},OGX.Ghost.NAME="Ghost",void 0===OGX)var OGX={};if(require("GridSwiper","Uxi","Touch"),OGX.GridSwiper=function(e){construct(this,"GridSwiper");var s,l,d,c,t,i,n,a,o,r,u,f,h=this,_=e,g={map:[[!0,!0,!0],[!0,!0,!0],[!0,!0,!0]],axis:{x:!0,y:!0},loop:!0,start:!1,chromeos:!1},p=!1,m={x:null,y:null},v={x:0,y:0},y=".ogx_grid_swiper_cell",x=!1,O=!1,b={x:0,y:0},w={x:0,y:0},G=(new Date).getTime()+Math.round(1e3*Math.random()),X=[];function E(e){e?s.on(h.touch.down,T):s.off(h.touch.down,T)}function T(e){p=!1,a=n=i=t=0,e=k(e),m.x=e.pageX,m.y=e.pageY,L(x=!0)}function C(e){e?$("body").on(h.touch.up,D):$("body").off(h.touch.up,D)}function D(e){x&&(L(x=!1),M())}function M(e,t,i){var n,a;void 0===e&&(e=0),void 0===t&&(t=0),void 0===i&&(i=!0),i&&Y(!0),l.addClass("ogx_grid_swiper_anim"),v=I(l),n=-1*Math.round((v.x+e)/d)*d*-1,a=-1*Math.round((v.y+t)/c)*c*-1,l.css({transform:"translate3d("+n+"px, "+a+"px, 0px)"})}function L(e){e?(N(!0),s.on(h.touch.move,S)):(N(!1),s.off(h.touch.move,S))}function S(e){e=k(e),a=n=i=t=0,p||(_.axis.x&&Math.abs(e.pageX-m.x)>Math.abs(e.pageY-m.y)?p="x":_.axis.y&&Math.abs(e.pageX-m.x)<Math.abs(e.pageY-m.y)&&(p="y")),p&&(_.axis.x&&"x"===p?(t=Math.abs(e.pageX-m.x),n=0<e.pageX-m.x?1:-1):_.axis.y&&"y"===p&&(i=Math.abs(e.pageY-m.y),a=0<e.pageY-m.y?1:-1))}function N(e){e?f||(O=!1,f=setInterval(A,10)):f&&(clearInterval(f),f=null)}function A(){if((t||i)&&(O||s.trigger(OGX.GridSwiper.SWIPE_START),O=!0),_.axis.x&&"x"===p&&t&&n&&t<=d){if(!_.loop&&(b.x+-1*n<0||b.x+-1*n>_.map[0].length-1))return;if((o=(b.x+-1*n)%_.map[0].length)<0&&(o=Math.abs(_.map[0].length+o)),!1===_.map[w.y][o])return;u=t*n,l.css({transform:"translate3d("+(-1*b.x*d+u)+"px, "+v.y+"px, 0px)"})}else if(_.axis.y&&"y"===p&&i&&a&&i<=c){if(!_.loop&&(b.y+-1*a<0||b.y+-1*a>_.map.length-1))return;if((r=(b.y+-1*a)%_.map.length)<0&&(r=Math.abs(_.map.length+r)),!1===_.map[r][w.x])return;u=i*a,l.css({transform:"translate3d("+v.x+"px, "+(-1*b.y*c+u)+"px, 0px)"})}}function Y(e){e?(l.off("transitionend"),l.on("transitionend",function(){O&&(s.trigger(OGX.GridSwiper.SWIPE_END),O=!1),l.off("transitionend"),l.removeClass("ogx_grid_swiper_anim"),v=I(l);var e={x:null,y:null};e.x=-1*Math.round(v.x/d),e.y=-1*Math.round(v.y/c),b.x!==e.x?(n=b.x>e.x?1:-1,b.x=e.x,w.x=P(b).x,-1===n?(l.children(y+"[data-y="+(b.y-1)+"]").attr("data-x",b.x).css("left",b.x*d),l.children(y+"[data-y="+(b.y+1)+"]").attr("data-x",b.x).css("left",b.x*d),l.children(y+"[data-x="+(b.x-2)+"][data-y="+b.y+"]").attr("data-x",b.x+1).css("left",(b.x+1)*d),s.trigger(OGX.GridSwiper.SWIPE_LEFT,{cell:w,point:b}),R(X=[{x:b.x+1,y:b.y},{x:b.x,y:b.y-1},{x:b.x,y:b.y+1}])):(l.children(y+"[data-y="+(b.y-1)+"]").attr("data-x",b.x).css("left",b.x*d),l.children(y+"[data-y="+(b.y+1)+"]").attr("data-x",b.x).css("left",b.x*d),l.children(y+"[data-x="+(b.x+2)+"][data-y="+b.y+"]").attr("data-x",b.x-1).css("left",(b.x-1)*d),s.trigger(OGX.GridSwiper.SWIPE_RIGHT,{cell:w,point:b}),R(X=[{x:b.x-1,y:b.y},{x:b.x,y:b.y-1},{x:b.x,y:b.y+1}])),z()):b.y!==e.y&&(a=b.y>e.y?1:-1,b.y=e.y,w.y=P(b).y,-1===a?(l.children(y+"[data-x="+(b.x-1)+"]").attr("data-y",b.y).css("top",b.y*c),l.children(y+"[data-x="+(b.x+1)+"]").attr("data-y",b.y).css("top",b.y*c),l.children(y+"[data-y="+(b.y-2)+"][data-x="+b.x+"]").attr("data-y",b.y+1).css("top",(b.y+1)*c),s.trigger(OGX.GridSwiper.SWIPE_UP,{cell:w,point:b}),R(X=[{x:b.x,y:b.y+1},{x:b.x-1,y:b.y},{x:b.x+1,y:b.y}])):(l.children(y+"[data-x="+(b.x-1)+"]").attr("data-y",b.y).css("top",b.y*c),l.children(y+"[data-x="+(b.x+1)+"]").attr("data-y",b.y).css("top",b.y*c),l.children(y+"[data-y="+(b.y+2)+"][data-x="+b.x+"]").attr("data-y",b.y-1).css("top",(b.y-1)*c),s.trigger(OGX.GridSwiper.SWIPE_DOWN,{cell:w,point:b}),R(X=[{x:b.x,y:b.y-1},{x:b.x-1,y:b.y},{x:b.x+1,y:b.y}])),z()),p=0})):l.off("transitionend")}function I(e){var t=e.css("transform");return"none"===t?0:(t=(t=(t=t.substr(7)).substr(0,t.length-1)).split(","),{x:Number(t[4]),y:Number(t[5])})}function k(e){return e.hasOwnProperty("originalEvent")&&void 0!==e.originalEvent.changedTouches?e.originalEvent.changedTouches[0]:e}function P(e){var t={x:0,y:0};return t.x=e.x%_.map[0].length,t.x<0&&(t.x=Math.abs(_.map[0].length+t.x)),t.y=e.y%_.map.length,t.y<0&&(t.y=Math.abs(_.map.length+t.y)),t}function R(e){for(var t,i={x:null,y:null},n=0;n<e.length;n++){if(e[n].y<0||e[n].y>_.map.length-1){if(!_.loop)return!1;i.y=P(e[n]).y}else i.y=e[n].y;if(e[n].x<0||e[n].x>_.map[0].length-1){if(!_.loop)return!1;i.x=P(e[n]).x}else i.x=e[n].x;t=_.map[i.y][i.x],W(e[n],t)}}function W(e,t){var i=!1;switch(typeof t){case"string":l.children(y+'[data-x="'+e.x+'"][data-y="'+e.y+'"]').children(y+"_content:first").html(t);break;case"function":(i=t(e,P(e),{x:e.x-b.x,y:e.y-b.y},l.children(y+'[data-x="'+e.x+'"][data-y="'+e.y+'"]').children(y+"_content:first")[0]))&&l.children(y+'[data-x="'+e.x+'"][data-y="'+e.y+'"]').children(y+"_content:first").html(i);break;case"object":var n='.ogx_grid_swiper[data-ogx-id="'+G+'"] > .ogx_grid_swiper_container > '+y+'[data-x="'+e.x+'"][data-y="'+e.y+'"] > '+y+"_content",a=P(e);for(var o in t){t[o].id="cell_"+a.x+"_"+a.y;break}t=OGX.OML.replaceNodeName(t,n);var r=h.nodes.find("id","cell_"+a.x+"_"+a.y,1);r&&h.remove(r._NAME_,r.id),$(n).empty(),OGX.OML.render(h,t,{abs:e,rel:P(e)}),z()}}function z(){for(var e=0;e<h.nodes.length;e++)h.nodes[e].id==="cell_"+w.x+"_"+w.y?h.nodes[e].focus():h.nodes[e].blur()}function H(){X=[],_.axis.x&&(X.push({x:_.start.x-1,y:_.start.y}),X.push({x:_.start.x+1,y:_.start.y})),X.push({x:_.start.x,y:_.start.y}),_.axis.y&&(X.push({x:_.start.x,y:_.start.y-1}),X.push({x:_.start.x,y:_.start.y+1})),R(X)}function U(){_.map.length||(_.map=[[]],_.axis.y=!1),_.map.length&&!Array.isArray(_.map[0])&&(_.map=[_.map],_.axis.y=!1),_.start||(_.start={x:null,y:null},_.start.y=Math.floor(_.map.length/2),_.start.x=Math.floor(_.map[0].length/2))}function F(){var e=_.start.x*-d,t=_.start.y*-c,i=_.start.y-1,n=_.start.x,a='<div class="ogx_grid_swiper_container" style="transform:translate3d('+e+"px, "+t+'px, 0px);">',o=-1*e,r=-1*t-c;_.axis.y&&(a+='<div class="ogx_grid_swiper_cell" style="left:'+o+"px; top:"+r+'px;" data-x="'+n+'" data-y="'+i+'"><div class="ogx_grid_swiper_cell_content"></div></div>',a+='<div class="ogx_grid_swiper_cell" style="left:'+o+"px; top:"+(r+2*c)+'px;" data-x="'+n+'" data-y="'+(2+i)+'"><div class="ogx_grid_swiper_cell_content"></div></div>'),a+='<div class="ogx_grid_swiper_cell" style="left:'+o+"px; top:"+(r+c)+'px;" data-x="'+n+'" data-y="'+(1+i)+'"><div class="ogx_grid_swiper_cell_content"></div></div>',_.axis.x&&(a+='<div class="ogx_grid_swiper_cell" style="left:'+(o-d)+"px; top:"+-1*t+'px;" data-x="'+(n-1)+'" data-y="'+_.start.y+'"><div class="ogx_grid_swiper_cell_content"></div></div>',a+='<div class="ogx_grid_swiper_cell" style="left:'+(o+d)+"px; top:"+-1*t+'px;" data-x="'+(n+1)+'" data-y="'+_.start.y+'"><div class="ogx_grid_swiper_cell_content"></div></div>'),a+="</div>",s.html(a),l=s.children(".ogx_grid_swiper_container:first"),b.x=_.start.x,b.y=_.start.y,v.x=e,v.y=t,w.x=_.start.x,w.y=_.start.y}this._NAME_=OGX.GridSwiper.NAME,this.el=null,this.enable=function(){debug(5,"gridwwiper",_.id,"enabled"),E(!0),C(!0)},this.disable=function(){debug(5,"gridwwiper",_.id,"disabled"),E(!1),C(!1),N(!1)},this.resize=function(){Y(!1),l.removeClass("ogx_grid_swiper_anim"),d=s.width(),c=s.height();var e=b.x*-d,t=b.y*-c;l.children(y+"[data-y="+(b.y-1)+"]").css({top:(b.y-1)*c,left:b.x*d}),l.children(y+"[data-y="+b.y+"]").css({top:b.y*c,left:b.x*d}),l.children(y+"[data-y="+(b.y+1)+"]").css({top:(b.y+1)*c,left:b.x*d}),l.children(y+"[data-x="+(b.x-1)+"]").css({top:b.y*c,left:(b.x-1)*d}),l.children(y+"[data-x="+(b.x+1)+"]").css({top:b.y*c,left:(b.x+1)*d}),l.css("transform","translate3d("+e+"px, "+t+"px, 0px"),L(!1),setTimeout(function(){M(0,0,!1),l.addClass("ogx_grid_swiper_anim")},0)},this.setMap=function(e,t){_.map=e,void 0!==t&&(_.start=t),U(),F(),H()},this.setMapCell=function(e,t){_.map[e.y]||(_.map[e.y]=[]),_.map[e.y][e.x]=t},this.getMapCell=function(e){return 0<e.y&&_.map.length<e.y&&0<e.x&&_.map[e.y].length<e.x&&_.map[e.y][e.x]},this.getCells=function(){var i,n,a,o,r=[];return l.children(y).each(function(e,t){i=$(t),n={x:Number(i.attr("data-x")),y:Number(i.attr("data-y"))},a=P(n),o={x:n.x-b.x,y:n.y-b.y},r.push({abs:n,rel:a,offset:o,element:t})}),r},this.getCellContent=function(e){return l.children(y+"[data-x="+e.x+"][data-y="+e.y+"]").children(y+"_content:first")[0]},this.getCurrentCell=function(){return w},this.renderCellContent=function(e){R([e])},this.setTopCell=function(e){this.setOffsetCell({x:0,y:-1},e)},this.setBottomCell=function(e){this.setOffsetCell({x:0,y:1},e)},this.setLeftCell=function(e){this.setOffsetCell({x:-1,y:0},e)},this.setRightCell=function(e){this.setOffsetCell({x:1,y:0},e)},this.setOffsetCell=function(e,t){var i={x:e.x+b.x,y:e.y+b.y};this.setMapCell(i,t)},this.getOffsetCell=function(e){var t={x:e.x+b.x,y:e.y+b.y};return this.getMapCell(t)},this.getOffsetCellContent=function(e){var t={x:e.x+b.x,y:e.y+b.y};return this.getCellContent(t)},this.swipeRight=function(){M(-d)},this.swipeLeft=function(){M(d)},this.swipeUp=function(){M(0,-c)},this.swipeDown=function(){M(0,c)},OGX.Data.merge(_,g),(s=$(_.el)).addClass("ogx_grid_swiper"),s.attr("data-ogx-id",G),d=s.width(),c=s.height(),U(),F(),H(),debug(5,"gridwwiper",_.id,"init")},OGX.GridSwiper.NAME="GridSwiper",OGX.GridSwiper.SWIPE_LEFT="GridSwiperSwipeLeft",OGX.GridSwiper.SWIPE_RIGHT="GridSwiperSwipeRight",OGX.GridSwiper.SWIPE_UP="GridSwiperSwipeUp",OGX.GridSwiper.SWIPE_DOWN="GridSwiperSwipeDown",OGX.GridSwiper.SWIPE_START="GridSwiperSwipeStart",OGX.GridSwiper.SWIPE_END="GridSwiperSwipeEnd",void 0===OGX)var OGX={};if(require("GroupedList","Uxi","Bind","Touch"),OGX.GroupedList=function(e){construct(this,"GroupedList");var i,o,s,n,a,l=this,d=e,t={group_by:"name",group_mode:null,group_param:null,group_order:null,order:null,list:new OGX.List,key:null,swipe:!1,reorder:!1,display:!1,mode:OGX.DynamicList.SELECT_MODE_HIT,scope:["public"]},r="static";function c(e){e?"static"===r&&i.on(l.touch.down,".ogx_grouped_list_item",u):"static"===r&&i.off(l.touch.down,".ogx_grouped_list_item",u)}function u(){i.find(".ogx_grouped_list_selected_item").removeClass("ogx_grouped_list_selected_item"),$(this).addClass("ogx_grouped_list_selected_item");var e=d.list[Number($(this).data("id"))];i.trigger(OGX.GroupedList.SELECT,e)}function f(e){return d.group_order.indexOf(e)}function h(e,t){for(var i,n=0;n<o.nodes.length;n++)if(i=o.nodes[n].val().find(e,t,1))return{list:o.nodes[n],item:i};return!1}function _(){var e=!1,t=!1;if(d.list&&(e=d.list,a&&(e=n),e.length&&(t=s,s=e.group(d.group_by,d.group_mode,d.group_param))),e&&e.length){if(JSON.stringify(t)!==JSON.stringify(s)){l.find(OGX.NestList.NAME,l.id+"_nests","remove");var i=function(){var e='.ogx_grouped_list[data-ogx-id="'+l.id+'"]',t={};t[e+":NestList"]={id:l.id+"_nests",list:[],"node:OML":[]};var i,n=[],a=OGX.Data.clone(d.group_order);for(var o in s)i=d.group_order?d.group_order.indexOf(o):n.length,t[e+":NestList"].list.push({title:o}),n[i]={"default:DynamicList":{list:s[o],key:d.key,mode:d.mode,display:d.display,swipe:d.swipe,reorder:d.reorder,order:d.order}};for(var r=0;r<n.length;r++)void 0===n[r]&&(n.splice(r,1),a.splice(r,1),r--);return t[e+":NestList"]["node:OML"]=n,t[e+":NestList"].order=a,t}();OGX.OML.render(l,i),o=l.find(OGX.NestList.NAME,l.id+"_nests")}}else s=!1,l.el.empty()}this._NAME_=OGX.GroupedList.NAME,this.el=null,this.enable=function(){c(!0),debug(5,"groupedlist",d.id,"enabled")},this.disable=function(){c(!1),debug(5,"groupedlist",d.id,"disabled")},this.bindFilter=function(e,t,i){debug(4,"grouoedlist",this.id,"filter",e,JSON.stringify(i)),d.list.removeFilter(e),void 0!==i&&d.list.addFilter(e,t,i),d.list.getFilters()&&(n=d.list.filter(),a=!0),setTimeout(_,0)},this.bindValue=function(){return this.getSelection()},this.destroy=function(){this.clearBinds()},this.scope=function(e){return void 0!==e?(d.scope=e,o.scope(e),!0):d.scope},this.val=function(e){if(void 0===e)return d.list;e.hasOwnProperty("insert")||(e=new OGX.List(e));var t=d.list.getFilters();"{}"!==JSON.stringify(t)&&(a=!0,e.setFilters(t),n=e.filter()),d.list=e,setTimeout(_,0)},this.nests=function(){return o||!1},this.filter=function(){return n=d.list.filter(),a=!0,setTimeout(_,0),!0},this.unfilter=function(){return a=!1,setTimeout(_,0),!0},this.addFilter=function(e,t,i){return d.list.addFilter(e,t,i)},this.removeFilter=function(e,t,i){return d.list.removeFilter(e,t,i)},this.resetFilters=function(){return d.list.resetFilters()},this.getFilters=function(){return d.list.getFilters()},this.addGroup=function(e,t,i){var n={title:e,scope:d.scope},a={};void 0===t&&(t=[]),a["default:DynamicList"]={list:t,key:d.key,display:d.display,swipe:d.swipe,reorder:d.reorder},o.addNest(n,a,i),d.group_order.insert(e,i),d.list=d.list.concat(t)},this.removeGroup=function(e){return!!this.getGroupList(e)&&(o.removeNest(e),d.list.findDelete(d.group_by,e),!0)},this.addToGroup=function(e,t){var i=this.getGroupList(e);i&&(i.insert(t),d.list.push(t),setTimeout(function(){o.updateNestHeight(e)},0))},this.removeFromGroup=function(e,t,i){2===arguments.length&&(i=t,t=d.key);var n=this.getGroupList(e);n&&(n.findDelete(t,i,1),d.list.findDelete(t,i,1),n.val().length?setTimeout(function(){o.updateNestHeight(e)},0):this.removeGroup(e))},this.updateGroupItem=function(e,t,i,n){this.getGroupList(e).findUpdate(t,i,n,!1,1),d.list.findUpdate(t,i,n,1)},this.replaceGroupItem=function(e,t,i,n){this.getGroupList(e).findReplace(t,i,n),d.list.findReplace(t,i,n,1)},this.getGroupList=function(e){var t=f(e);return o.nodes[t]},this.addItem=function(e){var t=e[d.group_by];if(-1===d.group_order.indexOf(t)){var i=f(t);-1!==i?this.addToGroup(t,[e],i):this.addGroup(t,[e])}else this.addToGroup(t,e);setTimeout(function(){o.updateNestHeight(t)},0)},this.removeItem=function(e,t){d.key&&1===arguments.length&&(t=e,e=d.key);var i=d.list.find(e,t,1);if(i){var n=i[d.group_by];return this.removeFromGroup(n,e,t),setTimeout(function(){o.updateNestHeight(n)},0),!0}return!1},this.replaceItem=function(e,t,i){d.key&&2===arguments.length&&(t=e,e=d.key);var n=h(e,t);return!!n&&(n.item[d.group_by]!==i[d.group_by]?(n.list.findDelete(e,t,1),d.list.findDelete(e,t,1),this.addItem(i),setTimeout(function(){o.updateNestHeight(n.item[d.group_by]),o.updateNestHeight(i[d.group_by])},0)):n.list.findReplace(e,t,i),!0)},this.updateItem=function(e,t,i,n){if(d.key){var a=arguments.length;void 0!==n&&a--,2===a&&(i=t,t=e,e=d.key)}var o=h(e,t);if(o){if(i.hasOwnProperty(d.group_by)&&o.item[d.group_by]!==i[d.group_by]){o.list.findDelete(e,t,1);var r=d.list.findUpdate(e,t,1);r=OGX.Data.merge(r,i,!0,!1,n),this.addItem(r)}else o.list.findUpdate(e,t,i,n,1);return!0}return!1},this.render=function(){return setTimeout(_,0),!0},this.refresh=function(){var e=i.find(".ogx_grouped_list_selected_item:first");if(0<e.length){var t=e.data("id");e.html(OGX.Templater.templatize(d.template,d.list[t]))}},"undefined"!=typeof moment?void 0!==OGX.List?void 0!==OGX.Templater?void 0!==OGX.NestList?(OGX.Data.merge(d,t),d.list.hasOwnProperty("insert")||(d.list=new OGX.List(d.list)),d.group_order&&!d.group_order.hasOwnProperty("insert")&&(d.group_order=new OGX.List(d.group_order)),d.display&&d.display.hasOwnProperty("css")&&("object"!=typeof d.display.css&&d.display.css?d.display.css+=" ogx_grouped_list_item":d.display.hasOwnProperty("add")?d.display.add="ogx_grouped_list_item "+d.display.add:d.display.add="ogx_grouped_list_item"),s=!1,l.el=i=$(d.el),i.addClass("ogx_grouped_list"),_(),debug(5,"groupedlist",d.id,"init")):debug(1,"OGX.NestList not found! "):debug(1,"OGX.Templater not found! "):debug(1,"OGX.List not found! "):debug(1,"moment.js not found! ")},OGX.GroupedList.NAME="GroupedList",OGX.GroupedList.SELECT="GroupedListSelect",OGX.GroupedList.BIND=OGX.GroupedList.SELECT,void 0===OGX)var OGX={};if(require("Html","Uxi"),OGX.Html=function(e){construct(this,"Html"),this._NAME_=OGX.Html.NAME,void 0!==e&&e&&(this.el=$(e.el),e.scroll?setTimeout(function(){OGX.HtmlRender(e)},0):OGX.HtmlRender(e))},OGX.HtmlRender=function(e){var t=$(e.el),i=new OGX.Display(e);data=!1,e.data&&Object.keys(e.data).length&&(data=e.data),t.html(i.html(data)),e.css&&t.addClass(i.css(data)),e.hasOwnProperty("id")&&e.id&&"#"===e.id.substr(0,1)&&t.attr("id",e.id.substr(1))},OGX.Html.NAME="Html",void 0===OGX)var OGX={};if(require("Iceberg","Uxi","Touch"),OGX.Iceberg=function(e){construct(this,"Iceberg");var i,n,a,o,s=this,t={left:0,right:0,top:0,bottom:0,min:50,drag:!0,flatten:!1,"node:OML":{}},l=e,d=!1,r="normal",c="main",u={left:null,main:null,right:null,top:null,bottom:null},f=[0,0,0],h=0,_=0,g=0,p=0;function m(e){for(var t in u)u[t]&&u[t].instance&&(e===t?u[t].instance.focus():u[t].instance.blur())}function v(){d.hasClass("ogx_iceberg_anim")||(d.off("transitionend"),f=b(d))}function y(e){var t=0;return e.dirY&&e.distY>e.distX&&(t=1),t}function x(e){l.drag&&e.dist&&((a=y(e))||-1===["main","left","right"].indexOf(c)?-1!==["main","top","bottom"].indexOf(c)&&e.dirY&&e.distY&&(n=f[1]+e.distY*e.dirY)<=p&&g<=n&&d.css({transform:"translate3d(0, "+n+"px, 0)"}):e.dirX&&e.distX&&(i=f[0]+e.distX*e.dirX)<=_&&h<=i&&d.css({transform:"translate3d("+i+"px, 0, 0)"}))}function O(e){if(n=i=0,a=y(e),e.swipe&&e.dist){var t;switch(e.swipe=!1,c){case"main":-1===e.dirX&&l.right&&!a?(i=-u.right.outerWidth(),t="right",e.swipe=!0):1===e.dirX&&l.left&&!a?(i=u.left.outerWidth(),t="left",e.swipe=!0):1===e.dirY&&l.top&&a?(n=u.top.outerHeight(),t="top",e.swipe=!0):-1===e.dirY&&l.bottom&&a&&(n=-u.bottom.outerHeight(),t="bottom",e.swipe=!0);break;case"left":-1!==e.dirX||a||(i=0,t="main",e.swipe=!0);break;case"right":1!==e.dirX||a||(i=0,t="main",e.swipe=!0);break;case"top":-1===e.dirY&&a&&(n=0,t="main",e.swipe=!0);break;case"bottom":1===e.dirY&&a&&(n=0,t="main",e.swipe=!0)}o=a?1===e.dirY?OGX.Iceberg.SWIPE_DOWN:OGX.Iceberg.SWIPE_UP:1===e.dirX?OGX.Iceberg.SWIPE_RIGHT:OGX.Iceberg.SWIPE_LEFT,e.swipe&&e.dist&&(d.addClass("ogx_iceberg_anim"),d.on("transitionend",function(){d.off("transitionend"),d.removeClass("ogx_iceberg_anim"),f=b(d),m(c=t),d.trigger(o,c)}),d.css({transform:"translate3d("+i+"px, "+n+"px, 0)"}))}else if(e.dist){switch(n=i=0,c){case"left":i=u.left.outerWidth();break;case"right":i=-u.right.outerWidth();break;case"top":n=u.top.outerHeight();break;case"bottom":n=-u.bottom.outerHeight()}d.addClass("ogx_iceberg_anim"),d.on("transitionend",function(){d.off("transitionend"),d.removeClass("ogx_iceberg_anim"),f=b(d),d.trigger(OGX.Iceberg.RESTORE,c)}),d.css({transform:"translate3d("+i+"px, "+n+"px, 0)"})}}function b(e){var t=e[0].style.transform;if(t=t.match(/translate3d\(([0-9px%,\.\- ]+)\)/)){t=t[1].split(",");for(var i=0;i<t.length;i++)t[i]=Number(t[i].split("px")[0]);return t}return[0,0,0]}function w(){var e;for(var t in u)u[t]&&((e=u[t].children(":first")).length&&e[0].hasAttribute("data-ogx-id")?u[t].instance=s.nodes.find("id",String(e.data("ogx-id")),1):u[t].instance=!1)}this._NAME_=OGX.Iceberg.NAME,this.el=null,this.show=function(e,t){if(void 0===e&&(e=!1),"normal"===r)for(var i in u)if(u[i]&&u[i].instance&&u[i].instance.id===t){if(!e)return this.val(i),!0;if(u[i].instance._NAME_===u[i].instance.NAME)return this.val(i),!0}return!1},this.val=function(e){if(void 0===e)return c;if(n=i=0,"normal"===r){switch(e){case"left":i=u.left.outerWidth();break;case"top":n=u.top.outerHeight();break;case"main":i=0;break;case"right":i=u.left.outerWidth();break;case"bottom":n=-u.bottom.outerHeight()}u[c].instance&&u[c].instance.blur(),u[c=e].instance&&u[c].instance.focus(),d.css({transform:"translate3d("+i+"px, "+n+"px, 0)"})}},this.enable=function(){"flattened"!==r&&(this.touch.swipe.enable(),setTimeout(function(){m(c)},0)),debug(5,"iceberg",l.id,"enabled")},this.disable=function(){this.touch.swipe.disable(),debug(5,"iceberg",l.id,"disabled")},this.resize=function(){u.left&&(_=u.left.outerWidth()),u.right&&(h=-u.right.outerWidth()),u.top&&(p=u.top.outerHeight()),u.bottom&&(g=-u.bottom.outerHeight()),l.flatten&&("flattened"!==r&&this.el.outerWidth()>=l.flatten?(r="flattened",f=b(d),d.addClass("ogx_iceberg_views_flattened").css("transform","translate3d(0px, 0px, 0px)"),d.children(".ogx_iceberg_view").addClass("ogx_iceberg_view_flattened"),this.disable()):"flattened"===r&&this.el.width()<l.flatten&&(r="normal",d.children(".ogx_iceberg_view").removeClass("ogx_iceberg_view_flattened"),d.removeClass("ogx_iceberg_views_flattened").css("transform","translate3d("+f[0]+"px, 0px, 0px)"),this.enable()))},debug(5,"iceberg",l.id,"init"),OGX.Data.merge(l,t),width=Math.round($(l.el).innerWidth()),height=$(l.el).innerHeight(),s.el=$(l.el),s.el.addClass("ogx_iceberg"),function(){var e,t,i='<div class="ogx_iceberg_views ogx_hw">',n={},a='.ogx_iceberg[data-ogx-id="'+s.id+'"] > .ogx_iceberg_views > .ogx_iceberg_view[data-ogx-panel-id="';for(var o in l["node:OML"])for(var r in l["node:OML"][o])0===r.indexOf("left")&&(i+='<div class="ogx_iceberg_view_left ogx_view ogx_iceberg_view" data-ogx-panel-id="left" style="width:'+(isNaN(l.left)?l.left:l.left+"px")+';"></div>',n.left=a+'left"]',u.left=!0),0===r.indexOf("top")&&(i+='<div class="ogx_iceberg_view_top ogx_view ogx_iceberg_view" data-ogx-panel-id="top" style="height:'+(isNaN(l.top)?l.top:l.top+"px")+';"></div>',n.top=a+'top"]',u.top=!0),0===r.indexOf("main")&&(i+='<div class="ogx_iceberg_view_main ogx_view ogx_iceberg_view" data-ogx-panel-id="main"></div>',n.main=a+'main"]'),0===r.indexOf("right")&&(i+='<div class="ogx_iceberg_view_right ogx_view ogx_iceberg_view" data-ogx-panel-id="right" style="width:'+(isNaN(l.right)?l.right:l.right+"px")+';"></div>',n.right=a+'right"]',u.right=!0),0===r.indexOf("bottom")&&(i+='<div class="ogx_iceberg_view_bottom ogx_view ogx_iceberg_view" data-ogx-panel-id="bottom" style="height:'+(isNaN(l.bottom)?l.bottom:l.bottom+"px")+';"></div>',n.bottom=a+'bottom"]',u.bottom=!0);for(s.el.html(i),o=0;o<l["node:OML"].length;o++)for(var r in l["node:OML"][o])e=r.split(":")[0],t=r.replace(e,n[e]),l["node:OML"][o][t]=l["node:OML"][o][r],delete l["node:OML"][o][r];d=s.el.children(".ogx_iceberg_views:first"),u.left&&(u.left=d.children(".ogx_iceberg_view_left:first"),_=u.left.outerWidth()),u.top&&(u.top=d.children(".ogx_iceberg_view_top:first"),p=u.top.outerHeight()),u.main=d.children(".ogx_iceberg_view_main:first"),u.right&&(u.right=d.children(".ogx_iceberg_view_right:first"),h=-u.right.outerWidth()),u.bottom&&(u.bottom=d.children(".ogx_iceberg_view_bottom:first"),g=-u.bottom.outerHeight())}(),setTimeout(w,0),s.touch.swipe.set({x:!0,y:!0,min_x:l.min,min_y:l.min,cb_down:v,cb_swipe:x,cb_up:O}),s.resize()},OGX.Iceberg.NAME="Iceberg",OGX.Iceberg.SHOW="icebergShow",OGX.Iceberg.SWIPE_UP="icebergSwipeUp",OGX.Iceberg.SWIPE_DOWN="icebergSwipeDown",OGX.Iceberg.SWIPE_LEFT="icebergSwipeLeft",OGX.Iceberg.SWIPE_RIGHT="icebergSwipeRight",OGX.Iceberg.RESTORE="icebergRestore",void 0===OGX)var OGX={};if(OGX.Loading=function(e){"use strict";var t=this,i=!1,n={display:{css:"ogx_loading",html:" ",anim:OGX.Overlay.FADE}};e.hasOwnProperty("loading")&&e.loading&&setTimeout(function(){t.addLoading()},0),this.hasLoading=function(){return!!i},this.addLoading=function(e){i||(i=!0,void 0===e&&(e={}),OGX.Data.merge(e,n),this.addOverlay(e))},this.removeLoading=function(e){i&&(this.removeOverlay(e),i=!1)}},void 0===OGX)var OGX={};if(OGX.Media=function(){"use strict";var i=!1,n={},a=0;function o(e,t,i){var n=$(e).parent().innerWidth(),a=$(e).parent().innerHeight(),o=function(e,t){var i=e.width/e.height,n={};return t.width/t.height<i?(n.width=t.width,n.height=Math.round(e.height*(t.width/e.width))):(n.width=Math.round(e.width*(t.height/e.height)),n.height=t.height),n}({width:t,height:i},{width:n,height:a}),r=(n-o.width)/2,s=(a-o.height)/2;$(e).css("left",r+"px"),$(e).css("top",s+"px"),$(e).prop("width",o.width),$(e).prop("height",o.height)}function r(e){var t=$(e);t&&(t.find(".ogx_video").each(function(e,t){!function(e,t,i){var n=t/i,a=$(e).parent().innerWidth(),o=$(e).parent().innerHeight(),r=a,s=Math.ceil(r/n);s<o&&(r=(s=o)*n),$(e).prop("width",r),$(e).prop("height",s)}(t,parseInt($(t).data("width"),10),parseInt($(t).data("height"),10))}),t.find(".ogx_video_resp").each(function(e,t){!function(e,t,i){var n=t/i,a=$(e).parent().innerWidth(),o=$(e).parent().innerHeight(),r=a,s=Math.ceil(r/n);s<o&&(r=(s=o)*n),$(e).prop("width",r),$(e).prop("height",s)}(t,parseInt($(t).data("width"),10),parseInt($(t).data("height"),10))}),t.find(".ogx_video_poster").each(function(e,t){!function(e,t,i){var n=t/i,a=$(e).parent().innerWidth(),o=$(e).parent().innerHeight(),r=a,s=Math.ceil(r/n),l=0,d=0;s<o&&(s=o,r=Math.ceil(s*n)),a<r?l=(r-a)/2*-1:r<a&&(l=(a-r)/2*-1),o<s?d=(s-o)/2*-1:s<o&&(d=(o-s)/2*-1),$(e).css("left",l+"px"),$(e).css("top",d+"px"),$(e).prop("width",r),$(e).prop("height",s)}(t,parseInt($(t).data("width"),10),parseInt($(t).data("height"),10))}),t.find(".ogx_image_contain").each(function(e,t){o(t,parseInt($(t).data("width"),10),parseInt($(t).data("height"),10))}),t.find(".ogx_image_cover").each(function(e,t){!function(e,t,i){var n=$(e).parent().innerWidth(),a=n/(t/i),o=($(e).parent().innerHeight()-a)/2;0<o&&(o=0),$(e).parent().css("overflow","hidden"),$(e).prop("width",n),$(e).prop("height",a),$(e).css("top",o+"px")}(t,parseInt($(t).data("width"),10),parseInt($(t).data("height"),10))}),t.find(".ogx_image_fit").each(function(e,t){!function(e,t,i){var n=t/i,a=$(e).parent().innerWidth(),o=a,r=Math.ceil(o/n),s=0;a<o?s=(o-a)/2*-1:o<a&&(s=(a-o)/2*-1),$(e).css("left",s+"px"),$(e).prop("width",o),$(e).prop("height",r)}(t,parseInt($(t).data("width"),10),parseInt($(t).data("height"),10))}),t.find(".ogx_image_scale").each(function(e,t){!function(e,t,i){var n=t/i,a=$(e).parent().innerWidth(),o=Math.ceil(a/n);$(e).prop("width",a),$(e).prop("height",o)}(t,parseInt($(t).data("width"),10),parseInt($(t).data("height"),10))}),t.find(".ogx_image_resp").each(function(e,t){!function(e,t,i){var n=t/i,a=$(e).parent().innerWidth();t<a&&(a=t);var o=Math.ceil(a/n);$(e).prop("width",a),$(e).prop("height",o)}(t,parseInt($(t).data("width"),10),parseInt($(t).data("height"),10))}))}function s(e){e?$(window).on("resize",t):$(window).off("resize",t)}function t(){for(var e in n)r(n[e].selector)}function l(e){e.find(".ogx_video, .ogx_video_resp, .ogx_video_poster").each(function(e,t){$(t).attr("data-width",$(t).attr("width")),$(t).attr("data-height",$(t).attr("height")),$(t).parent().css("overflow","hidden")}),e.find(".ogx_image_cover, .ogx_image_contain, .ogx_image_fit, .ogx_image_scale, .ogx_image_resp").each(function(e,t){$(t).css("position","relative"),$(t).attr("data-width",$(t).attr("width")),$(t).attr("data-height",$(t).attr("height"))}),setTimeout(r,200)}this.resize=function(e){void 0!==e?r(e):t()},this.bind=function(e,t){return!n.hasOwnProperty(e)&&(n[e]={observer:null,element:t},n[e].observer=function(i){var e=new(window.MutationObserver||window.WebKitMutationObserver)(function(e,t){e.forEach(function(e){l($(i))}),r(i)});return e.observe(document.querySelector(i),{childList:!0,subtree:!0}),e}(t),n[e].selector=t,a++,i||s(i=!0),l($(t)),r(t),!0)},this.unbind=function(e){return!(!n.hasOwnProperty(e)||!n[e].observer)&&(n[e].observer.disconnect(),delete n[e],!--a&&i&&s(i=!1),!0)}},OGX.Media=new OGX.Media,void 0===OGX)var OGX={};if(require("NestList","Uxi","Bind"),OGX.NestList=function(e){construct(this,"NestList");var a,n,o=this,t={scope:["public"],template:'<div class="ogx_nest_list_item {{$dsp}}" data-ogx-nest-id="{{$id}}"><div class="ogx_nest_list_item_head {{$css}}"><span class="ogx_nest_list_item_title">{{$title}}</span><span class="ogx_nest_list_item_icon"></span></div><div class="ogx_nest_list_item_body"><div class="ogx_nest_list_item_content">{{$body}}</div></div></div>',list:new OGX.List,item_default:!1,map:{title:"title",scope:"scope",id:"id"},order:!1,timeout:200},r={title:"",scope:[],open:!0},s={id:0,title:!1,scope:[],height:0,y:0,hidden:!1,open:!0,selector:!1},l=e,d=!1,c=0,u=0,f=1,h={y:0,h:0,way:1},_=!1,g=new OGX.List;function i(e){e?a.on("click",".ogx_nest_list_item_head",p):a.off("click",".ogx_nest_list_item_head",p)}function p(e){d||(d=!0,m($(this)))}function m(e){var t=e.parent(0).data("ogx-nest-id"),i=!1;e.hasClass("ogx_nest_list_item_head_closed")?(h.way=1,e.addClass("ogx_nest_list_item_head_open").removeClass("ogx_nest_list_item_head_closed"),g.findUpdate("id",t,{open:!0},!1,1),i=!0):(h.way=0,e.removeClass("ogx_nest_list_item_head_open").addClass("ogx_nest_list_item_head_closed"),g.findUpdate("id",t,{open:!1},!1,1));var n=g.find("id",t,1);i?(function(e){var t=v(e);if(t)return t.focus()}(n),a.trigger(OGX.NestList.OPEN,n)):(function(e){var t=v(e);if(t)return t.blur()}(n),a.trigger(OGX.NestList.CLOSE,n)),setTimeout(x,0)}function v(e){var t=$(e.selector).find(".ogx_uxi:first");if(t.length){var i=String(t.data("ogx-id")),n=o.nodes.find("id",i,1);if(n)return n}return!1}function y(e){if(e.hasOwnProperty("scope"))for(var t=0;t<e.scope.length;t++)if(-1!==l.scope.indexOf(e.scope[t]))return!0;return!1}function x(){var e;!function(){var e=0;u=0,h.y=0;for(var t=h.h=0;t<g.length;t++)g[t].y=e,g[t].hidden||(c=c||a.children(".ogx_nest_list_item:eq("+t+")").children(".ogx_nest_list_item_head").outerHeight(!0),u+=c,h.y=e,g[t].open&&(h.y+=g[t].height,e+=g[t].height,u+=g[t].height),h.h=g[t].height);u-=h.h}();for(var t=a.children(".ogx_nest_list_mask:first"),i=0;i<g.length;i++)(e=a.children('.ogx_nest_list_item[data-ogx-nest-id="'+g[i].id+'"]')).removeClass("ogx_nest_list_item_noanim"),e.css("transform","translateY("+g[i].y+"px)");var n="height:"+Math.ceil(u+h.h)+"px !important;";t.on("transitionend",function(){t.off("transitionend"),h.way||a.css("cssText",n),d=!1}),h.way&&a.css("cssText",n),setTimeout(function(){t.css({transform:"translateY("+h.y+"px)"})},0)}function O(e,t){OGX.Data.merge(e,r);var i=OGX.Data.merge(s,e,!0,!0);e.hasOwnProperty(l.map.id)?i.id=e[l.map.id]:(i.id=f,f++);var n=function(e){var t={css:"",dsp:"ogx_nest_list_prep",id:e.id};return t[l.map.title]=e[l.map.title],e.open?t.css="ogx_nest_list_item_head_open":t.css="ogx_nest_list_item_head_closed",OGX.Templater.templatize(l.template,t)}(i);return void 0!==t&&t<l.list.length-1&&0<t?a.children(".ogx_nest_list_item:eq("+t+")").before(n):a.children(".ogx_nest_list_mask:first").before(n),i.selector='.ogx_nest_list[data-ogx-id="'+o.id+'"] > .ogx_nest_list_item[data-ogx-nest-id="'+i.id+'"] > .ogx_nest_list_item_body > .ogx_nest_list_item_content',setTimeout(function(){b(i);var e=$('.ogx_nest_list[data-ogx-id="'+o.id+'"] > .ogx_nest_list_item[data-ogx-nest-id="'+i.id+'"]');i.hidden&&e.addClass("ogx_nest_list_item_hidden"),e.removeClass("ogx_nest_list_prep")},l.timeout),i}function b(e){var t=$(e.selector).outerHeight(!0);e.height=t}function w(){var e=l.list;_&&(e=n),a.empty(),g.clear();var t;a.html('<div class="ogx_nest_list_mask"></div>');for(var i=0;i<e.length;i++)t=O(e[i]),g.push(t),l["node:OML"][i]=OGX.OML.replaceNodeName(l["node:OML"][i],t.selector,"default");setTimeout(x,l.timeout)}function G(){for(var e=[],t=0;t<l.list.length;t++)e[l.order.indexOf(l.list[t][l.map.title])]=l.list[t];return l.list=new OGX.List(e)}function X(){l.list.hasOwnProperty("insert")||(l.list=new OGX.List(l.list));for(var e=0;e<l.list.length;e++)l.item_default?OGX.Data.merge(l.list[e],l.item_default):OGX.Data.merge(l.list[e],r),l.order&&G()}this.el=null,this._NAME_=OGX.NestList.NAME,this.enable=function(){i(!0),debug(5,"nestlist",l.id,"enabled")},this.disable=function(){i(!1),debug(5,"nestlist",l.id,"disabled")},this.show=function(e,t){var i=this.find(e,t);i&&m(i.el.parents(".ogx_nest_list_item:first").children(".ogx_nest_list_item_head:first"))},this.bindFilter=function(e,t,i){debug(4,"NestedList",this.id,"filter",e,JSON.stringify(i)),l.list.removeFilter(e),void 0!==i&&l.list.addFilter(e,t,i),l.list.getFilters()&&(n=l.list.filter(),_=!0),setTimeout(w,0)},this.scope=function(e){return void 0!==e?(l.scope=e,function(){for(var e,t=0;t<g.length;t++)(e=a.children(g[t].selector)).addClass("ogx_nest_list_item_noanim"),y(g[t])?(g[t].hidden=!1,e.removeClass("ogx_nest_list_item_hidden")):(g[t].hidden=!0,e.addClass("ogx_nest_list_item_hidden"));setTimeout(x,0)}(),!0):l.scope},this.val=function(e){if(void 0===e)return l.list;l.list=e,X(),setTimeout(w,0)},this.addNest=function(e,t,i){var n=O(e,i);if(g.insert(n,i),t=OGX.OML.replaceNodeName(t,n.selector,"default"),OGX.OML.render(this,t),void 0!==i){var a=this.nodes.pop();this.nodes.insert(a,i)}},this.removeNest=function(e){var t=g.findIndex(l.map.title,e);t&&(this.nodes[t.index].kill(),this.nodes.splice(t.index,1),$('.ogx_nest_list[data-ogx-id="'+o.id+'"] > .ogx_nest_list_item[data-ogx-nest-id="'+g[t.index].id+'"]').remove(),g.splice(t.index,1),setTimeout(x,0))},this.updateNestHeight=function(e){var t=g.find(l.map.title,e,1);setTimeout(function(){b(t),x()},0)},void 0!==OGX.Display?void 0!==OGX.Templater?(OGX.Data.merge(l,t),X(),l.template=l.template.replace("{{$title}}","{{$"+l.map.title+"}}"),o.el=a=$(l.el),a.addClass("ogx_nest_list"),l.list.length&&w(),debug(5,"nestlist",l.id,"init")):debug(1,"OGX.Templater not found! "):debug(1,"OGX.Display not found! ")},OGX.NestList.NAME="NestList",OGX.NestList.OPEN="NestListOpen",OGX.NestList.CLOSE="NestListClose",OGX.NestList.READY="NestListReady",void 0===OGX)var OGX={};if(OGX.Net=function(e){"use strict";var r=1,s=OGX.Data.merge(e,{file_default:{file:!1,path:!1},extensions:[{ext:"json",path:"/json",type:"json"},{ext:"js",path:"/js",type:"text"},{ext:"html",path:"/html",type:"text"},{ext:"oml",path:"/oml",type:"json"},{ext:"ose",path:"/ose",type:"text"},{ext:"mp3",path:"/snd",type:"mp3"},{ext:"wav",path:"/snd"},{ext:"ogg",path:"/snd"},{ext:"png",path:"/img"},{ext:"jpg",path:"/img"},{ext:"gif",path:"/img"},{ext:"svg",path:"/img"}],ios:!1},!1,!0);function l(e,t,i){switch("/app.json"!==e&&debug(4,"NET loaded",e.path+"/"+e.file),e.ext){case"json":case"txt":case"oml":case"ose":case"html":case"snd":"app.json"!==e.file&&OGX.Cache.add(e)}void 0!==t?setTimeout(function(){t(e.data,i)},0):$(document).trigger(OGX.Net.LOAD_SUCCESS,e)}s.extensions.hasOwnProperty("insert")||(s.extensions=new OGX.List(s.extensions)),this.preload=function(e,i,n){debug(4,"NET bulk preload init");var a={loaded:0,total:0,files:new OGX.List};for(var t in e)for(var o=0;o<e[t].length;o++)debug(4,"NET preload path",e[t][o]),a.total++,this.load(t+"/"+e[t][o],r);function r(e,t){a.loaded++,debug(4,"NET preloaded",a.loaded+"/"+a.total,"items"),a.files.insert(e),a.loaded===a.total&&(debug(4,"NET bulk preload done"),setTimeout(function(){i(a.files,n)},0))}debug(4,"NET preloading",a.total,"items")},this.load=function(e,t,i){var n;"app.json"!==e&&debug(4,"NET loading",e);var a={file:null,path:null};-1!==e.indexOf("/")?(n=e.split("/"),a.file=n.pop(),a.path=n.join("/")):(a.path="",a.file=e),OGX.Data.merge(a,s.file_default);var o=function(e){var t;if(t=/([a-z0-9\_\-]+\.)?([a-z0-9\_\-]+)\.([a-z0-9]{3,4})/gi.exec(e))return t.shift(),t;return!1}(a.file);if(o)switch(a.ext=o[2],a.id=o[1],a.ext){case"json":case"txt":case"oml":case"ose":case"html":a.type=s.extensions.find("ext",a.ext,1).type,function(t,i,n){!function(){var e=t.path+"/"+t.file;"/"===e.substr(0,1)&&(e=e.substr(1)),debug(5,"NET preload file",e),$.ajax({dataType:t.type,url:e}).done(function(e){t.data=e,l(t,i,n)})}()}(a,t,i);break;case"mp3":case"ogg":case"wav":!function(t,i,n){var a;!function(){var e=t.path+"/"+t.file;"/"===e.substr(0,1)&&(e=e.substr(1)),debug(5,"NET preload sound",e),a=new Audio(e),t.data=a,t.ext="snd",s.ios?l(t,i,n):a.oncanplaythrough=function(){l(t,i,n)}}()}(a,t,i);break;case"png":case"gif":case"jpg":case"svg":!function(t,i,n){var a=new Image;!function(){a.onload=function(){t.data=a,l(t,i,n)};var e=t.path+"/"+t.file;"/"===e.substr(0,1)&&(e=e.substr(1)),debug(5,"NET preload img",e),a.src=e}()}(a,t,i);break;case"ttf":case"eot":case"woff":case"woff2":!function(t,i,n){!function(){var e='<div class="ogx_font_loader" style="font-family:'+t.file.split(".")[0]+';" data-ogx-id="font-loader-'+r+'"><b>ogx</b> <i>font</i> init</div>';$("body").append(e),l(t,i,n),function(e){setTimeout(function(){$('.ogx_font_loader[data-ogx-id="font-loader-'+e+'"]').remove()},150)}(r),r++}()}(a,t,i)}}},OGX.Net.LOAD_SUCCESS="NET_LOAD_SUCCESS",void 0===OGX)var OGX={};if(OGX.OSE=function(){"use strict";var charcode;function convertToJS(e){var t,i,n,a,o=0,r="";if(e=(e=e.replace(/^[ \n\r]*{{|}}[\r\n ]*$/g,"")).replace(/(\/\*+((?!\*+\/)[\S\s])*\*+\/)/g,""),(i=/(uxi *(?:#|\$|&|@)*([a-z0-9_\-]+)):(([a-z0-9]+))/gi.exec(e))&&(n='OGX.Object.get({_NAME_:{eq:"'+i[3]+'"}, id:{eq:"'+i[2]+'"}}, null, 1);')===(e=e.replace(i[0],n)))return"return "+e;if((i=/mongogx ([a-z0-9_\-]+)\.([a-z0-9_\-]+)\.([a-z]+)\(([\S ]+)\)/gi.exec(e))&&(n="mongogx.setDatabase('"+i[1]+"');",n+="mongogx.setCollection('"+i[2]+"');",(n+="return mongogx."+i[3]+"("+i[4]+")[0];")===(e=e.replace(i[0],n))))return n;if(/^[ ]*\S+( \S+)?[ ]*$/g.test(e))return"return "+replaceVars(e)+";";for(e+="\r\n";t=/[\S ]*(\r\n|\r)/gi.exec(e);){if(a=replaceLoop(a=t[0].replace(/(\r\n|\r)/gi,"").trim()),charcode++,a=replaceVars(a),/(app|OGX)\.\S+;?/g.test(a))return"return "+a+";";if(e=e.replace(t[0],""),r+=a+"\n",100<++o)return}return r="var __echo=[];\n"+r+'\nif(!__echo.length){return;}else{return __echo.join("");}'}function runJS(t,e,i,n,a){var o;try{o=new Function("__object","__thread_object","__route_object","__local_object",t)(e,i,n,a)}catch(e){debug(1,t,e.toString())}if(o)return o}function replaceLoop(e){var t,i,n,a;return(t=/loop (\S+) ?(as (\S+) ?(\S+ )?)?{/gi.exec(e))&&(i="__"+String.fromCharCode(charcode).toLowerCase()+"__",n=(n=t[0]).replace(t[0],"for(var "+i+" in JSON.parse(JSON.stringify("+t[1]+"))){"),t[2]&&(a=t[4]?"&"+t[3]+"="+i+"; &"+t[4]+"="+t[1]+"["+i+"]; ":"&"+t[3]+"="+t[1]+"["+i+"]; "),n+=a,e=e.replace(t[0],n)),e}function replaceVars(e){for(var t,i,n,a=0;i=/((&|#|@|\$)([a-z0-9\-_]+))(\.[a-z0-9\-_\.\[\]\$]+|\.\$|\.)?(;)?/gi.exec(e);){switch(n=!1,new RegExp("/"+i[2]+"/g"),i[2]){case"&":n="__thread_object."+i[3];break;case"@":n="__local_object."+i[3];break;case"$":n="__object."+i[3];break;case"#":n=i[3]}if(t=i[0].replace(i[1],n),e=e.replace(i[0],t),200<++a)return e}for(;/(json|template|ose|oml|crumb|echo) (\S+)/g.test(e);){if(!1,(i=/crumb ([a-z0-9\-_]+)?/gi.exec(e))&&(t="__route_object."+i[1],e=e.replace(i[0],t),!0),(i=/json ([a-z0-9\-_\.]+)(;)?/gi.exec(e))&&(e=e.replace(i[0],"app.getJSON("+getTrueVal(i[1])+")")),(i=/template ([a-z0-9\-_]+)(;)?/gi.exec(e))&&(e=e.replace(i[0],"OGX.Templater.getTemplate("+getTrueVal(i[1])+")")),(i=/ose ([a-z0-9\-_]+)(;)?/gi.exec(e))&&(i[1]=getTrueVal(i[1]),script=that.get(i[1]),script&&(e=exp.replace(i[0],script.replace(/({{|}})/g,"")))),(i=/oml ([a-z0-9\-_]+)(;)?/gi.exec(e))&&(e=e.replace(i[0],"OGX.OML.get("+getTrueVal(i[1])+")")),i=/echo ('|")?(((?![;}\r\n]+|$)([\S\s]))*)(?:'|")?/gi.exec(e)){var o="+$1+",r="'";void 0!==i[1]&&(r="\\"+i[1]),o=r+o+r,i[2]=i[2].replace(/(__(?!;\n\r)[a-z0-9_\-\.]+)/gi,o),t="__echo.push("+r+i[2]+r+");",e=e.replace(i[0],t)}if(200<++a)return e}return e}function getTrueVal(__string){var e=!1;try{e=eval(__string)}catch(e){}return!e||e&&e instanceof HTMLElement?'"'+__string+'"':__string}this.get=function(e){return OGX.Cache.get("ose",e)},this.execScript=function(e,t,i,n){var a=this.get(e);return a&&this.exec(a,t,i,n),!1},this.exec=function(e,t,i,n,a){void 0===t&&(t={}),void 0===i&&(i={}),void 0===n&&(n={}),void 0===a&&(a={}),charcode=65;var o=runJS(convertToJS(e),t,i,n,a);return o||!1},this.loadExecScript=function(e,t,i,n,a){$.get(e,function(e){OGX.OSE.exec(e,t,i,n,a)})}},OGX.OSE=new OGX.OSE,OGX.OSE.SCRIPT_LOADED="OSE_SCRIPT_LOADED",OGX.OSE.SCRIPTS_LOADED="OSE_SCRIPTS_LOADED",void 0===OGX)var OGX={};if(OGX.Overlay=function(e){"use strict";var t=this,a=!1,i=!1,o={anim:OGX.Overlay.FADE,display:{css:"",html:" "},index:!1,close_on_click:!1},r=!1,n="mousedown";function s(e){a&&(e?a.on(n,l):a.off(n,l))}function l(){s(!1),t.removeOverlay()}e.hasOwnProperty("overlay")&&e.overlay&&setTimeout(function(){t.addOverlay(e.overlay)},0),this.hasOverlay=function(){return!!a},this.addOverlay=function(e){if("object"!=typeof e&&(e={}),OGX.Data.merge(e,o),e.display.hasOwnProperty("_NAME_")||(e.display=new OGX.Display(e.display)),r=e,!this.hasOverlay()){var t=this.el;r.hasOwnProperty("el")&&(t=$(r.el));var i="z-index:"+(r.zindex?r.zindex:this.topIndex(t))+";",n='<div class="ogx_overlay '+r.display.css()+'" style="'+i+'">'+r.display.html()+"</div>";if(t.prepend(n),(a=t.children(".ogx_overlay:first")).off("transitionend"),r.anim)switch(r.anim){case OGX.Overlay.FADE:setTimeout(function(){a&&a.removeClass("ogx_overlay_fade_out").addClass("ogx_overlay_fade_in")},50)}else a.css("opacity",1)}e.close_on_click&&s(!0)},this.removeOverlay=function(e){if(s(!1),void 0===e&&(e=!1,r&&r.anim&&(e=r.anim)),a)if(e)switch(e){case OGX.Overlay.FADE:a.removeClass("ogx_overlay_fade_in").addClass("ogx_overlay_fade_out"),0<a.css("opacity")?a.on("transitionend",function(){a&&(a.off("transitionend"),a.remove(),a=!1)}):a&&(a.removeClass("ogx_overlay_fade_in").removeClass("ogx_overlay_fade_out"),a.off("transitionend"),a.remove(),a=!1)}else a.remove(),a=!1;else debug(2,"No overlay to remove")},this.addGroupOverlay=function(){i||(this.el.prepend('<div class="ogx_group_overlay" style="z-index:'+(this.topIndex()+1e3)+'"></div>'),i=!0)},this.removeGroupOverlay=function(){i&&(this.el.children(".ogx_group_overlay:first").remove(),i=!1)}},OGX.Overlay.FADE="fade",OGX.Overlay.REMOVE="OverlayRemove",OGX.Placeholder=function(){},OGX.Placeholder.prototype.placeholders=function(e,t){if(void 0===e||void 0===t)return!1;var i;e.hasOwnProperty("node:OML")||(e["node:OML"]=[]);for(var n=0;n<e["node:OML"].length;n++)for(var a in e["node:OML"][n])if(0===a.indexOf("default")){i=a.split(":")[1],e["node:OML"][n][t[n]+":"+i]=e["node:OML"][n][a],delete e["node:OML"][n][a];break}return e},void 0===OGX)var OGX={};if(require("Point","Uxi"),OGX.Point=function(e){construct(this,"Point");var o=this,r=OGX.Data.merge(e,{live:[]}),n=new OGX.List;function s(){for(var e=o.el.width(),t=0;t<o.points.length;t++)if(e>=o.points[t].min&&e<=o.points[t].max)return{id:t,oml:o.points[t].oml};return!1}this.points=[],this.point=null,this.el=$(e.el),this._NAME_=OGX.Point.NAME,this.construct=function(e,t){},this.resize=function(){var e=s();e&&e.id!==this.point&&(this.point=e.id,function(e){for(var t,i=0;i<r.live.length;i++)(t=o.find(!1,r.live[i]))&&(t.sleep(),e&&n.push(t),t.parent.nodes.findDelete("id",t.id,1))}(r.live.length&&!n.length),this.nodes.length&&this.clear(),OGX.OML.render(this,this.points[this.point].oml,r.data,r.route_data,n))},this.oml=function(){return this.points[this.point].oml},o.el=$(r.el),o.el.addClass("ogx_point ogx_view"),function(){var e;for(var t in r)if(-1!==t.indexOf(":")){e=t.split(":");var i,n=JSON.parse(JSON.stringify(r[t]));for(var a in n)0===a.indexOf("default:")&&(i=a.split(":"),n['.ogx_point[data-ogx-id="'+o.id+'"]:'+i[1]]=n[a],delete n[a]);o.points.push({min:parseInt(e[0],10),max:parseInt(e[1],10),oml:n})}o.point=s().id}()},OGX.Point.NAME="Point",require("Popup","Uxi","Placeholder","Touch","Resize","Overlay"),OGX.Popup=function(e){construct(this,"Popup");var i,n,r=this,a={el:!1,width:"80%",height:"80%",html:!1,template:!1,title:!1,css:"",icon:!1,icons:!1,view:!1,drag:!1,resize:!1,center:!0,show:!1,group:!1,data:{},buttons:[],buttons_enabled:!0,anim:OGX.Popup.FADE,anim_param:{scale:.7},overlay:!1,zindex:!1,chromeos:!1,parent:null},s=e,l=!1,o=!1,d="ogx_popup",c=[],u=[],f={w:0,h:0},h=!1;function _(){s.anim&&r.el.removeClass(d+"_"+s.anim);var e=b();c[0]="translate3d("+e.x+"px, "+e.y+"px, 0px)",r.el.css({transform:c.join(" ")}),r.resizeNodes()}function g(){r.blurNodes(),r.front()}function p(){r.focusNodes()}function m(){l.addClass(d+"_drag"),r.front()}function v(){if(l.removeClass(d+"_drag"),h){for(var e=0;e<u.length;e++)u[e].removeGroupOverlay();u=[],app.groupPopups(r,h)}}function O(e){if(r.parent&&(u=r.parent.nodes.get({_NAME_:{eq:"Popup"},group:{eq:r.group}},{z:-1})).length){i=r.el.position(),h=!1;for(var t=0;t<u.length;t++)r.id!==u[t].id&&u[t].group===r.group&&(n=u[t].el.position(),f.w=u[t].el.width(),f.h=u[t].el.height(),i.left>n.left&&i.left<n.left+f.w&&i.top>n.top&&i.top<n.top+f.h&&(h||(h=u[t],u[t].addGroupOverlay())),h||u[t].removeGroupOverlay())}}function b(){var e=o.width(),t=o.height(),i=s.width,n=s.height;if("string"==typeof i&&-1!==i.indexOf("%")&&(i=Number(i.split("%")[0]),i=Math.round(i*e/100)),"string"==typeof n&&-1!==n.indexOf("%")&&(n=Number(n.split("%")[0]),n=Math.round(n*t/100)),s.center)x=Math.round(e/2-i/2),y=Math.round(t/2-n/2),s.drag&&(s.center=!1);else{var a=l.position();x=a.left,y=a.top,x>e&&(x=e-x),x<-i&&(x=0),y>t&&(y=t-n),y<0&&(y=0)}return{x:x,y:y}}function w(e,t,i,n,a){if(void 0!==t&&!0!==t||(t=!!s.anim&&s.anim),e?(r.front(),r.el.trigger(OGX.Popup.SHOW,r)):r.el.trigger(OGX.Popup.HIDE,r),t){var o={};switch(t){case OGX.Popup.SCALE:c[1]=e?"scale(1,1)":"scale("+s.anim_param.scale+", "+s.anim_param.scale+")",o.transform=c.join(" ");break;case OGX.Popup.FADE:o.opacity=e?1:0}e&&(l.css("display","flex"),o.visibility="visible"),setTimeout(function(){l.css(o)},50),l.on("transitionend",function(){l.off("transitionend"),e?r.resizeNodes():l.css({display:"none",visibility:"hidden"}),void 0!==i&&i&&i(n),void 0!==a&&a&&a(r.id)})}else e?l.css({opacity:e,display:"flex",visibility:"visible"}):l.css({display:"none",visibility:"hidden"}),void 0!==i&&i&&i(n),void 0!==a&&a&&a(r.id)}function t(e,t){void 0===t&&(t=!1),e?s.buttons_enabled&&!t||(s.buttons_enabled=!0,l.children("."+d+"_buttons:first").removeClass(d+"_buttons_disabled"),l.on(r.touch.down,"."+d+"_button",function(e){e.preventDefault(),e.stopImmediatePropagation();var t=$(this).index();l.trigger(OGX.Popup.CLICK_BUTTON,{index:t,value:s.buttons[t]}),"object"==typeof s.buttons[t]&&s.buttons[t].hasOwnProperty("callback")&&s.buttons[t].callback&&(s.buttons[t].hasOwnProperty("params")?s.buttons[t].callback.apply(null,[s.buttons[t].params]):s.buttons[t].callback())})):s.buttons_enabled&&(s.buttons_enabled=!1,l.children("."+d+"_buttons:first").addClass(d+"_buttons_disabled"),l.off(r.touch.down,".ogx_popup_button"))}function G(e){e?r.el.on(r.touch.down,"."+d+"_icons_icon",function(e){var t,i=$(this).index(),n=s.icons[i];"object"==typeof n&&n.hasOwnProperty("callback")&&(n.hasOwnProperty("params")&&(t=n.params),n.callback.call(null,t))}):r.el.off(r.touch.down,"."+d+"_icons_icon")}function X(){for(var e="",t=0;t<s.icons.length;t++)"string"==typeof s.icons[t]?e+='<div class="'+d+'_icons_icon" style="background-image:url(\''+s.icons[t]+"')\"></div>":e+='<div class="'+d+'_icons_icon" style="background-image:url(\''+s.icons[t].icon+"')\"></div>";return e}function E(){s.index?r.z=s.index:r.z=s.parent.topIndex();var e=b(),t=s.width,i=s.height;-1===String(t).indexOf("%")&&(t+="px"),-1===String(i).indexOf("%")&&(i+="px");var n="";(s.icon||s.title||s.icons||s.drag)&&(n+='<div class="'+d+'_head">',s.icon&&(n+='<div class="'+d+'_icon" style="background-image:url(\''+s.icon+"')\"></div>"),s.title&&(n+='<div class="'+d+'_title">'+s.title+"</div>"),n+='<div class="'+d+'_icons">',s.icons&&(n+=X()),n+="</div></div>");var a,o=1;if(c=["translate3d("+e.x+"px, "+e.y+"px, 0)"],s.anim)switch(s.anim){case OGX.Popup.FADE:o=0,a=d+"_fade";break;case OGX.Popup.SCALE:a=d+"_scale",c[1]="scale("+s.anim_param.scale+", "+s.anim_param.scale+")"}n+='<div class="'+d+"_body ogx_view "+s.css+'">',s.html?n+=s.html:s.template&&(n+=OGX.Templater.templatize(OGX.Templater.getTemplate(s.template),s.data)),n+="</div>",s.buttons&&s.buttons.length&&(n+='<div class="'+d+'_buttons">',n+=function(){for(var e="",t=0;t<s.buttons.length;t++)0<s.buttons.length&&("object"==typeof s.buttons[t]?e+='<span class="'+d+'_button">'+s.buttons[t].label+"</span>":e+='<span class="'+d+'_button">'+s.buttons[t]+"</span>");return e}(),n+="</div>"),l.html(n),l.css({width:t,height:i,opacity:o,transform:c.join(" "),"z-index":r.z}),s.anim&&l.addClass(a),r.el=l}this.anim=null,this.el=null,this.floating=!0,this._NAME_=OGX.Popup.NAME,this.group=s.group,this.z=0,this.construct=function(){s.show&&this.show()},this.enable=function(){this.enableButtons(),this.touch.enable(),this.enableResize(),s.icons&&s.icons.length&&G(!0),debug(5,"popup",s.id,"enabled")},this.disable=function(){this.disableButtons(),this.touch.disable(),this.disableResize(),s.icons&&s.icons.length&&G(!1),debug(5,"popup",s.id,"disabled")},this.show=function(e,t,i){w(1,e,t,i),this.focus(!0)},this.hide=function(e,t,i,n){w(0,e,t,i,n),this.blur(!0)},this.enableButtons=function(){s.buttons&&t(!0,!0)},this.disableButtons=function(){s.buttons&&t(!1)},this.center=function(){var e=b();c[0]="translate3d("+e.x+"px, "+e.y+"px, 0px)",r.el.css({transform:c.join(" ")})},this.move=function(e,t){null===e&&(e=r.el.position().left),null===t&&(t=r.el.position().top),c[0]="translate3d("+e+"px, "+t+"px, 0px)",r.el.css({transform:c.join(" ")})},this.front=function(){this.z=s.parent.topIndex(),this.el.css("z-index",this.z)},this.icon=function(e){if(void 0===e)return s.icon;s.icon=e,this.el.children("."+d+"_head:first").children("."+d+"_icon:first").css("background-image","url("+e+")")},this.title=function(e){if(void 0===e)return s.title;s.title=e,this.el.find("."+d+"_title:first").html(e)},this.resize=function(){_()},this.buttons=function(e){if(void 0===e)return s.buttons;s.buttons=e;var t=initButtons();this.el.children("."+d+"_buttons:first").html(t)},this.icons=function(e){if(void 0===e)return s.icons;s.icons&&s.icons.length&&G(!1),s.icons=e,this.el.find("."+d+"_icons:first").html(X()),G(!0)},function(){if(void 0!==OGX.Templater)if(void 0!==OGX.Data)if(void 0!==OGX.Container){if(OGX.Data.merge(s,app.getDefaults("popups")),OGX.Data.merge(s,a),(l=$(s.el)).addClass(d),o=l.parent(),r.anim=s.anim,r.centered=s.center,E(),s.drag){var e={x:!0,y:!0,cb_down:m,cb_up:v,target:"."+d+"_head:first"};s.group&&(e.cb_drag=O),r.touch.drag.set(e)}if(s.resize&&r.setResize({top:!1,cb_resize:_,cb_down:g,cb_up:p}),s.hasOwnProperty("html")&&s.html)s["node:OML"]=[{"default:Html":{html:s.html}}];else if(s.hasOwnProperty("view")&&s.view){var t={};(t["default:Views."+s.view.id]=s)["node:OML"].push(t)}r.placeholders(s,["."+d+'[data-ogx-id="'+s.id+'"] > .'+d+"_body"]),s.overlay&&r.addOverlay(),debug(5,"popup",s.id,"init")}else debug(1,"OGX.Container not found! ");else debug(1,"OGX.Data not found! ");else debug(1,"OGX.Templater not found! ")}()},OGX.Popup.NAME="Popup",OGX.Popup.FADE="fade",OGX.Popup.SCALE="scale",OGX.Popup.HIDE="PopupHide",OGX.Popup.SHOW="PopupShow",OGX.Popup.GROUP="PopupGroup",OGX.Popup.UNGROUP="PopupUngroup",OGX.Popup.CLICK_BUTTON="PopupClickButton",OGX.Popup.FLOAT=!0,void 0===OGX)var OGX={};if(OGX.Resize=function(e){"use strict";var r,s,l,d,c,u,f,h,_=this,g=e,t={enabled:!0,top:!0,left:!0,right:!0,bottom:!0,min_width:100,min_height:100,max_width:0,max_height:0,border:10,cb_up:!1,cb_down:!1,cb_resize:!1},i=!1,n="mousedown",a="mouseup",o="mousemove",p=(g=!1,!1),m=!1,v={w:0,h:0};function y(e){g&&(e?_.el.on(n,x):_.el.off(n,x))}function x(e){e.stopImmediatePropagation();var t=E(e);l=t.pageX,d=t.pageY;var i=_.el.position();r=i.left,s=i.top;var n=_.el.offset(),a=l-n.left,o=d-n.top;v.w=_.el.width(),v.h=_.el.height(),h=f=u=c=0,g.top&&o<g.border&&(h=-1),g.bottom&&o>_.el.height()-g.border&&(h=1),g.left&&a<g.border&&(f=-1),g.right&&a>_.el.width()-g.border&&(f=1),p=-1!==window.getComputedStyle(_.el[0],"width"),m=-1!==window.getComputedStyle(_.el[0],"height"),(f||h)&&(e.preventDefault(),_.hasOwnProperty("dragable")&&_.dragable&&_.touch.drag.disable(),O(!0),w(!0),g.cb_down&&g.cb_down())}function O(e){e?i=i||setInterval(b,5):i&&(clearInterval(i),i=!1)}function b(){if(-1===f||-1===h){var e=r,t=s;c&&f&&(e+=c),u&&h&&(t+=u),c&&-1===f&&u&&1===h&&(t=s),_.el.css("transform","translate3d("+e+"px, "+t+"px, 0)")}f&&v.w+c*f>g.min_width&&(p?_.el.css("width",100*(v.w+c*f)/_.el.parent().width()+"%"):_.el.width(v.w+c*f)),h&&v.h+u*h>g.min_height&&(m?_.el.css("height",100*(v.h+u*h)/_.el.parent().height()+"%"):_.el.height(v.h+u*h)),(c||u)&&(g.cb_resize?g.cb_resize():_.el.trigger(OGX.Resize.RESIZING))}function w(e){e?($("body").on(o,G),$("body").on(a,X)):($("body").off(o,G),$("body").off(a,X))}function G(e){e.preventDefault(),e.stopImmediatePropagation(),e=E(e),c=e.pageX-l,u=e.pageY-d}function X(e){O(!1),w(!1),e=E(e),c=e.pageX-l,u=e.pageY-d,g.cb_up&&g.cb_up(),_.hasOwnProperty("dragable")&&_.dragable&&(y(!1),_.touch.drag.enable(),setTimeout(function(){y(!0)},0))}function E(e){return e.hasOwnProperty("originalEvent")&&void 0!==e.originalEvent.changedTouches?e.originalEvent.changedTouches[0]:e}this.resizable=!0,this.setResize=function(e){OGX.Data.merge(e,t,!1),g=e},this.enableResize=function(){y(!0)},this.disableResize=function(){y(!1)},OGX.Data.merge(g,t,!1),void 0===window.ontouchstart||g.chromeos||(n="touchstart",o="touchmove",a="touchend")},OGX.Resize.RESIZING="resizeResizing",void 0===OGX)var OGX={};if(require("Roulette","Uxi","Bind","Touch"),OGX.Roulette=function(e){construct(this,"Roulette");var o,d,c,i,u,t,r,n=this,f=e,a={force_coef:10,time_coef:.1,min_force_pitch:2,value:null,name:!1,display:!1,key:"value",mode:OGX.Roulette.MODE_REWIND,icon:!1,list:new OGX.List},s={template:!1,html:'<span class="ogx_roulette_block_label">{{$label}}</span>',css:!1},l="object",h=0,_=0,g="ogx_roulette";function p(e,t){void 0===t&&(t=!0),n.el.children('input[name="'+f.name+'"]').val(e),t&&n.el.children('input[name="'+f.name+'"]').trigger("change")}function m(e){e?o.on(n.touch.down,"."+g+"_icon",function(e){e.preventDefault(),e.stopImmediatePropagation(),n.next(!0)}):o.off(n.touch.down,"."+g+"_icon")}function v(e){e?o.on("change","input[type=hidden]",function(e){n.loopval(0,OGX.Data.stringToVal(e.target.value),!1)}):o.off("change","input[type=hidden]")}function y(e){return _+e>f.list.length-1?f.list[0]:_+e<0?f.list[f.list.length-1]:f.list[_+e]}function x(e){i=e.y,w(!0)}function O(e){var t;i=(t=e.dirY!==u?0:e.pt1.y-i,e.pt1.y),u=e.dirY,d.css({transition:"none",transform:"translate3D(0px, "+(T(d)+t)+"px, 0px)"})}function b(e){w(!1),trans=T(d);var t=Math.round(trans/c)*c,i=Math.round(t/c%f.list.length);if(i=i<=0?Math.abs(i):f.list.length-i,_!==i){switch(_=i,l){case"string":f.value=f.list[_];break;case"object":f.value=f.list[_][f.key]}n.el.children('input[name="'+f.name+'"]').val(f.value),n.el.children('input[name="'+f.name+'"]').trigger("change"),n.el.trigger(OGX.Roulette.CHANGE,f.value)}d.css({transition:"all 0.2s ease-out",transform:"translate3D(0px, "+t+"px, 0px)"})}function w(e){e?t=setInterval(G,10):clearInterval(t)}function G(){var e,t,i;(e=Math.floor((d.position().top+c*u)/(c*f.list.length)*-1))!==h&&(0===d.children("."+g+'_stripe[data-id="'+e+'"]').length&&((t=r.clone()).css("top",e*(c*f.list.length)+"px"),t.attr("data-id",e),d.append(t)),d.children("."+g+"_stripe").each(function(e,t){i=d.position().top+$(t).position().top,(Math.ceil(i+c*f.list.length)<-c||c<i)&&$(t).remove()}),h=e)}function X(){w(!1),d.off("transitionend",X)}function E(){var e="",t="";f.icon&&(t+='<div class="'+g+'_container">'),t+='<div class="'+g+'_stripes">';for(var i=0;i<2;i++){t+='<div class="'+g+'_stripe" style="top:'+i*(f.list.length*c)+'px;" data-id="'+i+'">';for(var n=0;n<f.list.length;n++){switch(l){case"string":e=OGX.Templater.templatize(f.display.html(),{label:f.list[n]});break;case"object":e=f.display.html(f.list[n])}t+='<div class="'+g+"_block "+f.display.css(f.list[n])+'" style="height:'+c+"px; line-height:"+c+'px;" data-ogx-id="'+n+'">'+e+"</div>"}t+="</div>"}if(t+="</div>",f.icon&&(t+='</div><div class="'+g+'_icon"></div>'),void 0===_&&(_=0),f.name)switch(l){case"string":t+='<input type="hidden" name="'+f.name+'" value="'+f.list[_]+'">';break;case"object":t+='<input type="hidden" name="'+f.name+'" value="'+f.list[_][f.key]+'">'}o.html(t),d=o.children("."+g+"_stripes:first"),f.icon&&(d=o.children("."+g+"_container:first").children("."+g+"_stripes:first")),r=(r=d.children("."+g+"_stripe:last")).detach();var a=_*c*-1;d.css({transition:"none",transform:"translate3D(0px, "+a+"px, 0px)"})}function T(e){var t=0;return"none"!==e.css("transform")&&(t=Number(e.css("transform").split(",")[5].split(")")[0])),t}function C(e){switch(l){case"string":return{index:f.list.indexOf(e)};case"object":return f.list.findIndex(f.key,e)}}this._NAME_=OGX.Roulette.NAME,this.el=null,this.enable=function(){o.removeClass(g+"_disabled"),this.touch.swipe.enable(),f.icon&&m(!0),f.name&&v(!0),debug(5,"roulette",f.id,"enabled")},this.disable=function(){o.addClass(g+"_disabled"),this.touch.swipe.disable(),f.icon&&m(!1),f.name&&v(!1),w(!1),debug(5,"roulette",f.id,"disabled")},this.bindFilter=function(e,t,i){f.list.removeFilter(e),f.list.addFilter(e,t,i),f.list.filter(),setTimeout(E,0)},this.bindRender=function(e,t){},this.val=function(e,t){if(void 0!==e){var i=C(e).index;-1<i&&(function(e,t){void 0===t&&(t=!0);d.off("transitionend",X),w(!1),u=-1;var i=T(d),n=Math.round(i/c)*c,a=i-n,o=Math.round(n/c%f.list.length);o=o<=0?Math.abs(o):f.list.length-o;var r=o-e;f.mode===OGX.Roulette.MODE_CLOSEST&&r>f.list.length/2&&(r=-1*(f.list.length-o+e));var s=i+r*c-a,l=20*Math.round(Math.abs(r*c)*f.time_coef);w(!0),d.on("transitionend",X),d.css({transition:"all "+l+"ms ease-out",transform:"translate3D(0px, "+s+"px, 0px)"}),_=e}(i),f.name&&p(e,!1))}else switch(l){case"string":return f.list[_];case"object":return f.list[_][f.key]}},this.item=function(){return f.list[_]},this.loopval=function(e,t,i){var n=_,a=C(t).index;-1<a&&(_=a);var o=n-a,r=f.time_coef*Math.abs(o+e*f.list.length);w(!0),d.css({transition:"all "+r+"s ease-out",transform:"translate3D(0px, "+(T(d)+(o*c-f.list.length*c*e))+"px, 0px)"}),d.on("transitionend",X),f.name&&p(t,i),void 0!==i&&i&&this.el.trigger(OGX.Roulette.CHANGE,val)},this.next=function(e){var t,i=y(1);switch(u=1,l){case"string":t=i;break;case"object":t=i[f.key]}this.val(t),void 0!==e&&e&&(this.el.trigger(OGX.Roulette.CHANGE,t),f.name&&this.el.children('input[name="'+f.name+'"]').trigger("input"))},this.prev=function(e){var t,i=y(-1);switch(l){case"string":t=i;break;case"object":t=i[f.key]}this.val(t),void 0!==e&&e&&(this.el.trigger(OGX.Roulette.CHANGE,t),f.name&&this.el.children('input[name="'+f.name+'"]').trigger("change"))},this.setData=function(e,t){e.hasOwnProperty("insert")||(e=new OGX.List(e)),f.value=t,f.list=e,1===f.list.length&&(f.list[1]=f.list[0]),_=void 0===t?0:C(t).index,setTimeout(E,0)},void 0!==OGX.List?void 0!==OGX.Templater?void 0!==OGX.Display?(debug(5,"roulette init",f.id),function(){if(OGX.Data.merge(f,a),0<f.list.length&&!f.list.hasOwnProperty("insert")&&(f.list=new OGX.List(f.list)),"string"==typeof f.list[0]&&(l="string"),1===f.list.length&&(f.list[1]=f.list[0]),f.display?f.display=new OGX.Display(f.display):f.display=new OGX.Display(s),(o=n.el=$(f.el)).addClass(g),o.width(),c=o.height(),f.list.length){var e=o.parent();e[0].hasAttribute("data-value")&&(f.value=OGX.Data.stringToVal(e.data("value")),e.removeAttr("data-value")),f.value||(f.value=f.list[0].value),_=C(f.value).index}}(),f.list.length&&E(),n.touch.swipe.set({x:!1,y:!0,cb_down:x,cb_swipe:O,cb_up:b,target:'ogx_roulette[data-ogx-id="'+n.id+'"] .ogx_roulette_container:first'}),debug(5,"roulette",f.id,"init")):debug(1,"OGX.Display not found! "):debug(1,"OGX.Templater not found! "):debug(1,"OGX.List not found! ")},OGX.Roulette.NAME="Roulette",OGX.Roulette.CHANGE="RouletteChange",OGX.Roulette.MODE_REWIND="RouletteModeRewind",OGX.Roulette.MODE_CLOSEST="RouetteModeClosest",OGX.Roulette.BIND=OGX.Roulette.CHANGE,void 0===OGX)var OGX={};if(require("RouletteTree","Uxi"),OGX.RouletteTree=function(e){construct(this,"RouletteTree");var l,d,c=this,u=e,t={groups:!1,data:!1,value:!1},f=!1;function n(e){e?l.on(OGX.Roulette.CHANGE,a):l.off(OGX.Roulette.CHANGE,a)}function a(e,t){e.stopImmediatePropagation();var n,a=$(e.target).data("ogx-id"),o=f.findIndex("id",String(a)),r=f[o.index].roulette.item().hasOwnProperty("head");if(d=o.index,o.index+1<f.length)for(i=o.index+1;i<f.length;i++)r?(f[i].roulette.val(""),f[i].roulette.blur()):(n=h(i-1,f[i-1].roulette.val()),f[i].roulette.setData(n,n[0].value),i===o.index+1?f[i].roulette.focus():f[i].roulette.blur());var s=_(d);l.trigger(OGX.RouletteTree.CHANGE,s),r&&(d=d||-1)}function h(e){for(var t=[],i=0;i<e+1;i++)t.push(f[i].roulette.val());return r(t)}function _(e){if(void 0===e&&(e=f.length),e<0)return!1;for(var t={},i=0;i<e+1;i++)t[u.groups[i]]=f[i].roulette.val();return t}function o(e){for(var t,i=[],n=0;n<u.groups.length;n++)e.hasOwnProperty(u.groups[n])&&(t=e[u.groups[n]],String(t).length?(isNaN(t)||(t=String(t)),f[n].roulette.val(t),0<(d=n)&&(f[n].roulette.setData(r(i),t),c.enabled&&f[n].roulette.focus()),i.push(t)):g(f[n].roulette))}function r(e){for(var t=u.data,i=0;i<e.length;i++)e[i].length&&(t=t[e[i]]);var n=[{label:u.groups[e.length],value:""}];for(var a in t)n.push({label:a,value:a});return n}function s(){f=new OGX.List;var o,r,s=0;!function e(t,i){var n;if(!Array.isArray(t)&&"object"==typeof t){if(s<i){for(var a in s=i,l.append('<div class="ogx_roulette_tree_roulette" data-ogx-roulette="'+i+'"></div>'),r=u.groups[i-1],o=[{label:r,value:"",head:!0}],t)o.push({label:a,value:a});n=c.create(OGX.Roulette.NAME,{el:'.ogx_roulette_tree[data-ogx-id="'+c.id+'"] .ogx_roulette_tree_roulette[data-ogx-roulette="'+i+'"]',list:o,icon:u.icon,value:null,name:r}),1<s&&g(n),f.push({roulette:n,group:r,id:n.id})}if(i<u.groups.length)for(var a in t)e(t[a],i+1)}}(u.data,1)}function g(e){setTimeout(function(){e.blur()},0)}this._NAME_=OGX.RouletteTree.NAME,this.el=null,this.enable=function(){f&&(function(){for(var e=!0,t=0;t<f.length;t++)null===f[t].roulette.val()?e=e&&!1:t+1<f.length-1&&f[t+1].roulette.focus(),!e&&0<t&&g(f[t].roulette)}(),n(!0))},this.disable=function(){f&&n(!1)},this.val=function(e){if(void 0===e)return-1<d?_(d):{};o(e)},u=OGX.Data.merge(u,t),c.el=l=$(u.el),l.addClass("ogx_roulette_tree"),s(),d=-1,u.value&&setTimeout(function(){o(u.value)},0),debug(5,"roulettetree",u.id,"init")},OGX.RouletteTree.NAME="RouletteTree",OGX.RouletteTree.CHANGE="RouletteTreeChange",OGX.RouletteTree.BIND=OGX.RouletteTree.CHANGE,void 0===OGX)var OGX={};if(OGX.Router=function(e){"use strict";var g=e,i=window.location.pathname.split("/").slice(-1)[0],p=!1,m=!1,v={history:!0,reload:!1};function t(e){e.preventDefault(),e.stopImmediatePropagation(),p||navigator.app.backHistory()}function n(e){if(p)return e.preventDefault(),e.stopImmediatePropagation(),!1;null!==e.originalEvent.state?app.goto(e.originalEvent.state.url,!1):-1!==window.location.href.indexOf("#")&&app.goto(window.location.href.split("#").pop(),{history:!1})}this.start=function(){$(document).on("backbutton",t),$(window).on("popstate",n)},this.stop=function(){$(document).off("backbutton",t),$(window).off("popstate",n)},this.lock=function(){p=!0},this.unlock=function(){p=!1},this.isLocked=function(){return p},this.addToHist=function(e){var t={url:e};history.pushState(t,"title"+(new Date).getTime(),i+"#"+e)},this.goto=function(e,t,i){if(debug(3,"navigate to",e),p)return!1;OGX.Data.merge(t,v);var n=function(e){var t,i,n,a;debug(4,"Router route lookup",e);var o=[];for(var r in g.routes){for(n=r;i=/(?!\/)([a-z0-9_\-]+)\:([^\/]+)/gi.exec(n);)n=n.replace(i[0],i[2]),o.push(i[1]);if((t=e.match("^"+n+"$"))&&t.length){t.shift();var s=JSON.parse(JSON.stringify(g.routes[r]));a={};for(var l=0;l<t.length;l++)a[o[l]]=t[l];return{stage:e.split("/").shift(),route:s,data:a,pattern:r}}}return!1}(e);if(n){if(n.route.hasOwnProperty("scope")||(n.route.scope=["public"]),!OGX.Scope.check(n.route.scope))return debug(2,"invalid scope for",e),setTimeout(function(){app.goto(g.errors[403],{history:!1})},0),!1;delete n.route.scope;var a=OGX.Object.get({_NAME_:{eq:OGX.Stage.NAME},id:{eq:n.stage}},null,1);if(n.route.hasOwnProperty("origin:Route")){debug(5,"Router test origin",a.url,n.route["origin:Route"]);for(var o,r=!1,s=n.route["origin:Route"].split(","),l=0;l<s.length;l++)if("self"===s[l]){if(o=n.pattern.replace(/([a-z]+:)/,""),RegExp(o).test(a.url)){r=!0;break}}else if(0===a.url.indexOf(s[l])){r=!0;break}if(!r)return debug(1,"Expected origin",n.route["origin:Route"]),void app.goto(n.route["origin:Route"]);debug(5,"Router origin valid",n.route["origin:Route"]),delete n.route["origin:Route"]}n.url=e,m=n.pattern;var d,c,u=app.getStage(),f=!0,h=!0;if(n.stage!==u.id&&(u=app.cfind(OGX.Stage.NAME,n.stage),h=!1),u.url===n.url)if(t.reload)for(var _ in n.route)d=_.split(":")[0],(c=u.nodes.get({selector:{eq:d}},null,1))&&app.find(c._NAME_,c.id,"remove");else f=!1;else h&&function(o,e){var r,s,l,d=o.gather();!function e(t){var i,n=/(Fork|Data|Route)/gi;for(var a in t)-1!==a.indexOf(":")&&(r=a.split(":").shift(),s=a.split(":").pop(),n.test(s)?"Fork"===s&&e(OGX.Scope.match(t[a]).node):((i=d.get({selector:{eq:r}},null,1))&&(i.scroll&&(i=i.parent),l=!0,o.find(i._NAME_,i.id,"remove"),d.unset({_NAME_:{eq:i._NAME_},id:{eq:i.id}}),$(r).empty()),l||$(r).empty()))}(e)}(u,n.route);h||(app.showStage(n.stage),u=app.getStage()),u.pattern=m,u.url=n.url;return n.route,f&&OGX.OML.render(u,n.route,i,n.data),f&&t.history&&this.addToHist(e),!0}return debug(2,"404",e),setTimeout(function(){app.goto(g.errors[404],{history:!1})},0),!1}},OGX.Router.BACK="RouterBack",OGX.Router.EXIT="ReouterExit",void 0===OGX)var OGX={};if(OGX.Scope=function(e){this.scope=["public"],void 0!==e&&(this.scope=e),this.check=function(e){for(var t=0;t<this.scope.length;t++)if(-1!==e.indexOf(this.scope[t]))return!0;return!1},this.match=function(e){var t,i,n=new OGX.List;for(var a in e){i=0,t=a.split(",");for(var o=0;o<t.length;o++)for(var r=0;r<this.scope.length;r++)t[o]===this.scope[r]&&i++;i&&n.push({node:e[a],t:i})}return!!n.length&&(n.order("t",-1),n[0])}},OGX.Scope=new OGX.Scope,void 0===OGX)var OGX={};if(require("Scroller","Uxi","Touch"),OGX.Scroller=function(e){construct(this,"Scroller");var n,a,t,i,o,r,s,l,d,c,u,f=this,h=e,_={fade_speed:300,check_delay:100,css:!1,zindex:9999,observe:!0,auto_scroll:!1,scroll_callback:!1,trigger:!0},g=0,p="init",m=!1;function v(e){e?a.on(f.touch.down,y):a.off(f.touch.down,y)}function y(e){e=f.event(e),C(!1),b(!0),x(!0),v(!1),D("in"),E(!0)}function x(e){e?(c=setInterval(X,10),a.on(f.touch.move,O)):(clearInterval(c),a.off(f.touch.move,O))}function O(e){e=f.event(e)}function b(e){e?$(document).on(f.touch.up,w):$(document).off(f.touch.up,w)}function w(){x(!1),b(!1),v(!0),D("out")}function G(e){e?(window.addEventListener("resize",S),a.on("scroll",function(e){e.stopImmediatePropagation(),X()}),void 0!==OGX.NestedList&&$(document).on(OGX.NestedList.OPENED+" "+OGX.NestedList.CLOSED,function(){f.update()})):(window.removeEventListener("resize",S),a.off("scroll"),void 0!==OGX.NestedList&&$(document).off(OGX.NestedList.OPENED+" "+OGX.NestedList.CLOSED))}function X(){var e,t=(e=a.scrollTop())/s,i=Math.round(o.position().top);o.css("top",t+"px"),h.trigger&&!m&&(f.el.trigger(OGX.Scroller.SCROLL,e),-1*e==a.outerHeight(!0)-n.outerHeight(!0)?i!==Math.round(t)&&f.el.trigger(OGX.Scroller.BOTTOM):0===e&&i!==Math.round(t)&&f.el.trigger(OGX.Scroller.TOP)),h.scroll_callback&&h.scroll_callback()}function E(e){e?(d&&E(!1),l=n.position().top,d=setInterval(T,h.check_delay-10)):d&&(clearInterval(d),d=null)}function T(){var e=n.position().top;D(e!==l?"in":"out"),l=e}function C(e){e?u=setInterval(X,h.check_delay):clearInterval(u)}function D(e){h.fade_speed;var t=o.css("opacity");o.removeClass("ogx_scroller_track_anim_fade_in"),o.removeClass("ogx_scroller_track_anim_fade_out"),o.hasClass("ogx_scroller_track_anim")||o.addClass("ogx_scroller_track_anim"),"in"===e?o.addClass("ogx_scroller_track_anim_fade_in"):o.addClass("ogx_scroller_track_anim_fade_out")}function M(e){e?f.observe(!0,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["class","src","width","height"]},L):f.observe(!1)}function L(){g!==n.height()&&(g=n.height(),S(),h.auto_scroll&&f.bottom())}function S(){if(i=a.innerHeight(),t=n.height(),s=t/i,i<t){var e=Math.round(i/s);o.css("height",e+"px"),r.css("display","block")}else r.css("display","none");"init"===p&&(p=OGX.Scroller.READY,f.el.trigger(OGX.Scroller.READY))}this._NAME_=OGX.Scroller.NAME,this.el=null,this.enable=function(){S(),G(!0),h.observe&&setTimeout(function(){M(!0)},0),v(!0),debug(5,"scroller",h.id,"enabled")},this.disable=function(){G(!1),h.observe&&M(!1),b(!1),x(!1),v(!1),E(!1),C(!1),o.removeClass("ogx_scroller_track_anim_fade_in"),o.removeClass("ogx_scroller_track_anim_fade_out"),debug(5,"scroller",h.id,"disabled")},this.resize=function(){S()},this.destroy=function(){f.el.removeClass("ogx_scroller_outer"),n.remove(),r.remove()},this.top=function(){i<t&&(a[0].scrollTop=0,S())},this.bottom=function(){i<t&&(a.scrollTop(t),S())},this.mute=function(){m=!0},this.vocal=function(){m=!1},this.container=function(){return n},this.inner=function(){return n[0]},this.outer=function(){return a[0]},this.state=function(){return p},OGX.Data.merge(h,_),function(){f.el=$(h.el),f.el.addClass("ogx_scroller_outer ogx_hw");var e=(a=f.el).html();a.html('<div class="ogx_scroller_inner ogx_hw"></div>'),(n=a.children(".ogx_scroller_inner:first")).html(e);var t="ogx_scroller_track ogx_hw";h.css&&(t+=" "+h.css);var i="<div class="+t+'" style="z-index:'+h.zindex+';"><div class="ogx_scroller_track_button"></div></div>';a.prepend(i),r=a.children(".ogx_scroller_track:first"),o=r.find(".ogx_scroller_track_button:first")}(),S(),debug(5,"scroller",h.id,"init")},OGX.Scroller.NAME="Scroller",OGX.Scroller.READY="ScrollerReady",OGX.Scroller.TOP="ScrollerTop",OGX.Scroller.BOTTOM="ScrollerBottom",OGX.Scroller.SCROLL="ScrollerScroll",void 0===OGX)var OGX={};if(require("StackedTree","Uxi","Touch"),OGX.StackedTree=function(e){construct(this,"StackedTree");var i,o,r,s,l=this,n={scope:["public"],speed:200,list:[],display:{html:"{{$label}}"},displays:!1,chromeos:!1},d=e,c=[],a=[0],u=0,f=!1,h="ogx_stacked_tree";function _(e){e?(i.on(l.touch.down,"."+h+"_level_prev",t),i.on(OGX.DynamicList.SELECT,g)):(i.off(l.touch.down,"."+h+"_level_prev",t),i.off(OGX.DynamicList.SELECT,g))}function t(e){e.preventDefault(),e.stopImmediatePropagation(),y(--u,!0),a.pop(),l.el.trigger(OGX.StackedTree.BACK)}function g(e,t){f=t;var i=c[u].findIndex("__id__",t.__id__);t.hasOwnProperty("items")&&t.items.length&&function(e){if(!e.hasOwnProperty("scope"))return!0;for(var t=0;t<d.scope.length;t++)if(-1!==e.scope.indexOf(d.scope[t]))return!0;return!1}(t)?(a.push(i),v(++u,t.items),l.el.trigger(OGX.StackedTree.ENTER,t),setTimeout(function(){y(u)},0)):l.el.trigger(OGX.StackedTree.SELECT,t)}function p(e){e?$(window).on("resize",m):$(window).off("resize",m)}function m(){o.removeClass(h+"_anim"),r=o.width(),o.css("transform","translateX("+u*Math.round(r/a.length)*-1+"px)")}function v(e,t){o.removeClass(h+"_anim").css("width",100*(e+1)+"%"),r=o.width();var i,n='<div class="'+h+'_level" data-level="'+e+'">';0<e&&(i=(i=s.css(f)).replace(h+"_door",""),n+='<div class="'+h+"_item ogx_stacked_tree_level_prev "+i+'">'+s.html(f)+"</div>"),n+='<div class="'+h+'_level_list"></div></div>',o.append(n);var a=o.children("."+h+'_level[data-level="'+e+'"]').children("."+h+"_level_list");o.children("."+h+"_level").css("flex-basis",Math.floor(100/(e+1)*100)/100+"%"),function(e,t,i){c[e]&&l.remove(c[e].id,OGX.DynamicList.NAME);var n=l.create("DynamicList",{el:t,mode:"hit",scroll:!0,display:d.display,displays:d.displays,list:i});c[e]=n}(e,a[0],t)}function y(e,t){o.addClass(h+"_anim"),void 0!==t&&t&&(_(!1),o.on("transitionend",function(){o.off("transitionend"),o.removeClass(h+"_anim").css("width",100*(e+1)+"%"),l.remove(c[e+1].id,OGX.DynamicList.NAME),c.splice(e+1,1),o.children("."+h+'_level[data-level="'+(e+1)+'"]').remove(),o.children("."+h+"_level").css("flex-basis",Math.floor(100/(e+1)*100)/100+"%"),r=o.width(),_(!(f=!1))})),r=o.width(),o.css("transform","translateX("+e*Math.round(r/a.length)*-1+"px)")}function x(){if(void 0!==OGX.DynamicList)if(void 0!==OGX.Display){d=OGX.Data.merge(d,n,!1,!0);var e=(s=new OGX.Display(d)).val();if(e=function(e){if(e.display&&"object"==typeof e.display&&!e.display.hasOwnProperty("bind")&&(e.display=i(e.display)),e.displays)for(var t in e.displays)e.displays[t]=i(e.displays[t]);function i(e){var t=['{{return typeof($items) !== "undefined" && $items.length > 0}}',{add:"ogx_stacked_tree_door"}];if(e.hasOwnProperty("css"))if("object"==typeof e.css)e.css.hasOwnProperty("add")&&e.css.add?e.css.add+=" ogx_stacked_tree_item":e.css.add="ogx_stacked_tree_item",e.css.hasOwnProperty("conditions")?e.css.conditions.push(t):e.css.conditions=[t];else{var i="";e.css&&(i=e.css),i+=" ogx_stacked_tree_item",e.css={add:i,conditions:[t]}}else e.css={add:"ogx_stacked_tree_item",conditions:[t]};return e}return e}(e),s.val(e),d.display=e.display,d.displays=e.displays,l.el=i=$(d.el),i.addClass(h),d.list.length){var t=d.list.slice();d.list={items:t}}}else debug(1,"OGX.Display not found! ");else debug(1,"OGX.DynamicList not found! ")}this._NAME_=OGX.StackedTree.NAME,this.el=null,this.enable=function(){this.touch.enable(),_(!0),p(!0),debug(5,"stackedtree",d.id,"enabled")},this.disable=function(){this.touch.disable(),_(!1),p(!1),debug(5,"stackedtree",d.id,"disabled")},this.resize=function(){m()},this.destroy=function(){debug(5,"stackedtree destroy",d.id)},this.setTree=function(e){if(e.length){var t=e.slice();return d.list={items:t},!0}return!1},this.setScope=function(e){d.scope=e,f=!(a=[u=0])},debug(5,"stackedtree",d.id,"init"),x(),i.html('<div class="'+h+'_container" style="width:100%"></div>'),o=i.children("."+h+"_container:first"),d.list.items.length&&v(a[0],d.list.items)},OGX.StackedTree.NAME="StackedTree",OGX.StackedTree.BACK="StackedTreeBack",OGX.StackedTree.ENTER="StackedTreeEnter",OGX.StackedTree.SELECT="StackedTreeSelect",require("Stage","Uxi","Touch"),OGX.Stage=function(e){construct(this,"Stage");var n=this,a=e;function o(e){e?n.el.on(n.touch.down,".ogx_stage_exit",function(){app.theater.show()}):n.el.off(n.touch.down,".ogx_stage_exit")}this.el=null,this.id=a.id,this.anim=a.anim,this.theater=!1,this.home=null,this.url=null,this.route=null,this._NAME_=OGX.Stage.NAME,this.__destroy=function(){a.closeable&&o(!1)},function(){a.hasOwnProperty("theater")&&(n.theater=a.theater),n.home=a.home;var e=new OGX.Display(a),t="block";a.hasOwnProperty("use")&&a.use||(t="none");var i="";a.closeable&&(i='<div class="ogx_stage_exit"></div>'),i+=e.html(),n.el=container=$(a.el),container.html(i),container.addClass("ogx_stage").css("display",t),a.closeable&&o(!0)}()},OGX.Stage.NAME="Stage",OGX.Stage.SWAP="swap",OGX.Stage.FLIP="flip",void 0===OGX)var OGX={};if(require("Switch","Uxi","Bind","Touch"),OGX.Switch=function(e){construct(this,"Switch");var n,t=this,a=e,i={el:"document",bind:!1,labels:!0,data:[{label:"OFF",value:!1},{label:"ON",value:!0}],value:!0,name:"ogx_switch_check"},o="ogx_switch";function r(){a.value===a.data[0].value?a.value=a.data[1].value:a.value=a.data[0].value,setTimeout(s,0)}function s(){var e=n.find("."+o+"_dot:first"),t=n.find("."+o+"_label:first"),i=n.find("."+o+"_label:last");a.value===a.data[0].value?(e.removeClass(o+"_dot_right").addClass(o+"_dot_left"),t.removeClass(o+"_label_off").addClass(o+"_label_on").addClass(o+"_selected"),i.removeClass(o+"_label_on").addClass(o+"_label_off").removeClass(o+"_selected")):(e.removeClass(o+"_dot_left").addClass(o+"_dot_right"),i.removeClass(o+"_label_off").addClass(o+"_label_on").addClass(o+"_selected"),t.removeClass(o+"_label_on").addClass(o+"_label_off").removeClass(o+"_selected")),n.find("."+o+"_val:first").attr("value",a.value)}function l(e){e?n.on(t.touch.down,function(e){e.preventDefault(),r(),d(!1),n.trigger(OGX.Switch.CHANGE,a.value),n.children("."+o+"_val:first").trigger("change"),d(!0)}):n.off(t.touch.down)}function d(e){e?n.on("change","input[type=hidden]",function(e){a.value=OGX.Data.stringToVal(e.target.value),s()}):n.off("change","input[type=hidden]")}this._NAME_=OGX.Switch.NAME,this.el=null,this.enable=function(){l(!0),d(!0),n.removeClass(o+"_disabled"),debug(5,"switch",a.id,"enabled")},this.disable=function(){l(!1),d(!1),n.addClass(o+"_disabled"),debug(5,"switch",a.id,"disabled")},this.bindRender=function(e,t){},this.val=function(e){return void 0!==e&&a.value!==e&&r(),a.value},this.toggle=function(){r()},debug(5,"switch",a.id,"init"),function(){a=a||{},OGX.Data.merge(a,i),t.el=n=$(a.el),n.addClass(o+"_disabled");var e=n.parent();e[0].hasAttribute("data-value")&&(a.value=OGX.Data.stringToVal(e.data("value")),e.removeAttr("data-value"))}(),function(){var e="";a.labels&&(e+='<span class="'+o+'_label_on ogx_switch_label">'+a.data[0].label+"</span>");var t="";a.value===a.data[1].value&&(t=o+"_dot_right"),e+='<div class="'+o+'_track"><div class="'+o+'_track_bg"></div><div class="'+o+"_dot "+t+'"></div></div>',a.labels&&(e+='<span class="'+o+'_label_off ogx_switch_label">'+a.data[1].label+"</span>"),e+='<input class="'+o+'_val" type="hidden" name="'+a.name+'" value="'+a.value+'"></div>',n.html(e),n.addClass(o)}(),setTimeout(s,0)},OGX.Switch.NAME="Switch",OGX.Switch.CHANGE="SwitchChange",OGX.Switch.BIND=OGX.Switch.CHANGE,require("Tabs","Uxi","Touch"),OGX.Tabs=function(e){construct(this,"Tabs");var r,s=this,l=e,t={editable:!0,detachable:!1,detach_min:20,reorder:!0,icons:!1,index:0,list:new OGX.List,display:{html:"",css:""}},a=!1,o=0,d=!1,c=!1,u=!1,i=!1,f=!1,n={x:0,y:0},h="ogx_tabs";function _(){for(var e,t,i='<div class="'+h+'_container">',n=0;n<l.list.length;n++)t=l.display.css(l.list[n]),n===o&&(t+=" ogx_tabs_tab_active"),i+='<div class="'+h+"_tab "+t+'">',e=!1,"string"==typeof l.list[n]?e=l.list[n]:l.list[n].hasOwnProperty("label")&&(e=l.list[n].label),e&&(i+='<span class="'+h+'_tab_label">'+e+"</span>"),l.editable&&(i+='<span class="'+h+'_tab_close"><span></span></span>'),i+="</div>",t="";i+="</div>",l.editable&&(i+='<div class="'+h+'_tab_add"><span></span></div>',r.addClass(h+"_editable")),r.html(i),a=r.children("."+h+"_container:first").children("."+h+"_tab:eq("+o+")")}function g(e){d||(f=!1,c=$(e),u={from:c.index()},r.children("."+h+"_container:first").children("."+h+"_tab_active:first").removeClass(h+"_tab_active"),n.x=c.position().left,n.y=c.position().top,(d={el:$(e).clone(),x:n.x,y:c.position().top}).w=c.width(),d.el.width(d.w),c.addClass(h+"_tab_active").addClass(h+"_frozen"),a=c,d.el.addClass(h+"_tab_active").addClass(h+"_float").css("transform","translate3d("+n.x+"px, "+d.y+"px, 0px)"),r.children("."+h+"_container:first").prepend(d.el),i=setInterval(m,5))}function p(e,t){if(d)if(f=t,Math.abs(t.x)>Math.abs(t.y)){var i=d.x+t.x;d.el.css("transform","translate3d("+i+"px, "+d.y+"px, 0px)")}else{var n=d.y+t.y;if(d.el.css("transform","translate3d("+d.x+"px, "+n+"px, 0px)"),4<Math.abs(t.y)){u.to=c.index(),v();var a=l.list[u.from];"object"==typeof a&&(a=a.label);var o={label:a,index:u.to};s.removeTabAt(u.to),r.trigger(OGX.Tabs.REMOVE,o)}}}function m(){var i,n,a;d&&f&&(idx=c.index(),Math.abs(f.x)>Math.abs(f.y)&&r.children("."+h+"_container:first").children("."+h+"_tab").each(function(e,t){(i=$(t)).hasClass(h+"_tab_active")||(n=i.position(),a=i.width(),idx!==e&&(d.x+f.x>n.left+a/2&&d.x+f.x<n.left+a?(c.detach(),i.after(c)):d.x+f.x>n.left&&d.x+f.x<n.left+a/2&&(c.detach(),i.before(c))))}))}function v(){if(d&&(clearInterval(i),f=i=!1,d.el.remove(),d=!1,c.removeClass(h+"_frozen"),u.to=c.index(),u.to!==u.from)){var e=l.list.splice(u.from,1);l.list.insert(e[0],o),o=u.to,s.el.trigger(OGX.Tabs.REORDER,u)}}function y(e){e?(r.on("click","."+h+"_tab",function(){a&&a.removeClass(h+"_tab_active"),$(this).addClass(h+"_tab_active"),a=$(this),o!==a.index()&&(o=a.index(),r.trigger(OGX.Tabs.SELECT,l.list[a.index()]))}),l.editable&&r.on("click","."+h+"_tab_close",function(e){return e.preventDefault(),e.stopImmediatePropagation(),r.trigger(OGX.Tabs.CLOSE,{index:o,tab:l.list[o]}),s.removeCurrentTab(),updateContainerWidth(),!1})):(r.off("click","."+h+"_tab"),l.editable&&(r.off("click","."+h+"_tab_add"),r.off("click","."+h+"_tab_close")))}this._NAME_=OGX.Tabs.NAME,this.el=null,this.enable=function(){y(!0),l.reorder&&this.touch.hold.enable(),debug(5,"tabs",l.id,"enabled")},this.disable=function(){y(!1),l.reorder&&this.touch.hold.disable(),debug(5,"tabs",l.id,"disabled")},this.val=function(e){if(void 0===e)return a;var t;"string"==typeof e?t=l.list.indexOf(e):e.hasOwnProperty("label")&&(t=(t=l.list.findIndex("label",e.label)).index),this.selectIndex(t)},this.set=function(e){if(void 0===e)return l.list;e.hasOwnProperty("insert")||(e=new OGX.List(e)),l.list=e,setTimeout(_,0)},this.selectIndex=function(e){e!==o&&this.selectTabAt(e)},this.index=function(){return a?o:-1},this.addTab=function(e){l.icons&&(e.hasOwnProperty("icon")||(e.icon=l.icon_default)),l.list.push(e),o=l.list.length-1,setTimeout(function(){_(),function(){var e=r.width(),t=r.children("."+h+"_container:first"),i=t.width();e<i&&t.css("transform","translateX("+-1*(i-e)+"px)")}()},0)},this.addTabAt=function(e,t){l.icons&&(e.hasOwnProperty("icon")||(e.icon=l.icon_default)),l.list.insert(e,t),o=t,setTimeout(_,0)},this.removeCurrentTab=function(){a&&this.removeTabAt(o)},this.removeTabAt=function(e){return!!l.list.delete(e)&&(r.children("."+h+"_container:first").children("."+h+"_tab:eq("+e+")").remove(),a=null,function(){0<o?o--:o=0;s.selectTabAt(o)}(),!0)},this.selectTabAt=function(e){return a&&(a.removeClass(h+"_tab_active"),a=null),(a=r.children("."+h+"_container:first").children("."+h+"_tab:eq("+e+")")).addClass(h+"_tab_active"),o=e,!0},this.selectTab=function(e){a&&a.removeClass(h+"_tab_active");var t=l.list.findIndex("label",e);this.selectTabAt(t.index)},void 0!==OGX.List?(debug(5,"tabs",l.id,"init"),l=l||{},OGX.Data.merge(l,t),l.list.hasOwnProperty("insert")||(l.list=new OGX.List(l.list)),l.display.hasOwnProperty("_NAME_")||(l.display=new OGX.Display(l.display)),s.el=r=$(l.el),r.addClass(h),o=l.index,setTimeout(_,0),l.reorder&&s.touch.hold.set({target:".ogx_tabs_tab",cb_hold:g,cb_move:p,cb_up:v})):debug(1,"OGX.List not found! ")},OGX.Tabs.NAME="Tabs",OGX.Tabs.SELECT="TabsSelect",OGX.Tabs.CLOSE="TabsClose",OGX.Tabs.REORDER="TabsReoroder",OGX.Tabs.ADD="TabsAdded",OGX.Tabs.REMOVE="TabsRemoved",void 0===OGX)var OGX={};if(require("Tags","Uxi","Touch"),OGX.Tags=function(e){construct(this,"Tags");var o,t=this,r=e,i={editable:!1,insert:!0,name:!1,tags:[],current_tags:[],tags_ascii:[],mode:OGX.Tags.MODE_STRING,keycode:13,placeholder:"keywords",restrict:!1,max:0};function s(){var e;e=1===r.max&&r.current_tags.length?r.current_tags[0]:JSON.stringify(r.current_tags),o.find("input[type=hidden]").val(e),o.find("input[type=hidden]").trigger("change")}function n(e){var t=!1;switch(r.mode){case OGX.Tags.MODE_STRING:case OGX.Tags.MODE_ASCII:-1===r.current_tags.indexOf(e)&&(r.current_tags.push(e),t=!0);break;case OGX.Tags.MODE_OBJECT:var i=r.current_tags.find("label",e,1);i||((i=r.tags.find("label",e,1))?r.current_tags.push(i):r.current_tags.push({label:e}),t=!0)}if(t){var n="";!0===r.editable&&(n='<span class="ogx_tags_remove"></span>');var a='<span class="ogx_tags_tag"><span>'+e+"</span>"+n+"</span>";o.find(".ogx_tags_tags:first").append(a),s(),o.trigger(OGX.Tags.TAG_ADDED,e),o.trigger(OGX.Tags.CHANGE,[r.current_tags])}o.find(".ogx_tags_input:first").focus()}function a(i){var e=!1,n=!1;switch(r.mode){case OGX.Tags.MODE_STRING:case OGX.Tags.MODE_ASCII:var t=r.current_tags.indexOf(i);-1<t&&(r.current_tags.splice(t,1),e=!0);break;case OGX.Tags.MODE_OBJECT:e=r.current_tags.findDelete("label",i)}return e&&o.find(".ogx_tags_tags:first").find(".ogx_tags_tag").each(function(e,t){if($(t).find("span:first").text()===i)return $(t).remove(),n=!0,void s()}),n}function l(e,t){if(e){0<o.find(".ogx_tags_container:first").length&&(l(!1),f(!1));for(var i='<div class="ogx_tags_container">',n=0;n<t.length;n++)switch(r.mode){case OGX.Tags.MODE_STRING:case OGX.Tags.MODE_ASCII:i+='<span class="ogx_tags_tag ogx_tags_container_tag">'+t[n]+"</span>";break;case OGX.Tags.MODE_OBJECT:i+='<span class="ogx_tags_tag ogx_tags_container_tag">'+t[n].label+"</span>"}i+="</div>",o.append(i),f(!0)}else o.find(".ogx_tags_container").remove(),f(!1)}function d(e){for(var t="",i="",n=0;n<e.length;n++)switch(i=!0===r.editable?'<span class="ogx_tags_remove"></span>':"",r.mode){case OGX.Tags.MODE_STRING:case OGX.Tags.MODE_ASCII:t+='<span class="ogx_tags_tag"><span>'+e[n]+"</span>"+i+"</span>";break;case OGX.Tags.MODE_OBJECT:t+='<span class="ogx_tags_tag"><span>'+e[n].label+"</span>"+i+"</span>"}return r.current_tags=e,o.find(".ogx_tags_tags:first").html(t),s(),!0}function c(e){var t=function(e){for(var t="",i=0;i<e.length;i++)t+=e.toLowerCase().charCodeAt(i).toString();return t}(e.substr(0,3)),i=[];if(r.tags_ascii[t])for(var n=0;n<r.tags_ascii[t].length;n++)-1!==r.tags_ascii[t][n].toLowerCase().indexOf(e.toLowerCase())&&-1===r.current_tags.indexOf(r.tags[n])&&i.push(r.tags_ascii[t][n]);return i}function u(e){e?o.find(".ogx_tags_input:first").on("keyup",function(e){var t=$(this).val();if(3<=t.length)if(e.which===r.keycode&&r.insert)n(t),o.find(".ogx_tags_input:first").val(""),l(!1);else{var i;switch(r.mode){case OGX.Tags.MODE_STRING:i=function(e){for(var t=[],i=0;i<r.tags.length;i++)0===r.tags[i].toLowerCase().indexOf(e.toLowerCase())&&-1===r.current_tags.indexOf(r.tags[i])&&t.push(r.tags[i]);return t}(t);break;case OGX.Tags.MODE_OBJECT:i=function(e){for(var t=new RegExp(e,"gi"),i=r.tags.find("label",t),n=0;n<r.current_tags.length;n++)i.findDelete("label",r.current_tags[n].label);return i}(t);break;case OGX.Tags.MODE_ASCII:i=c(t)}0<i.length?l(!0,i):l(!1)}else l(!1)}):o.find(".ogx_tags_input:first").off("keyup")}function f(e){e?o.find(".ogx_tags_container:first").on(t.touch.down,".ogx_tags_container_tag",function(){n($(this).text()),o.find(".ogx_tags_input:first").val(""),l(!1),r.max&&r.current_tags.length===r.max&&(u(!1),o.find(".ogx_tags_input:first").css("display","none"))}):o.find(".ogx_tags_container:first").off(t.touch.down,".ogx_tags_container_tag")}function h(e){e?o.on(t.touch.down,".ogx_tags_remove",function(){var e=$(this).parent("span:first").find("span:first").text();a(e),o.trigger(OGX.Tags.TAG_REMOVED,e),o.trigger(OGX.Tags.CHANGE,[r.current_tags]),r.max&&r.current_tags.length<r.max&&(u(!0),o.find(".ogx_tags_input:first").css("display","block")),o.find(".ogx_tags_input:first").focus()}):o.off(t.touch.down,".ogx_tags_remove")}this._NAME_=OGX.Tags.NAME,this.el=null,this.enable=function(){u(!0),f(!0),h(!0),o.find(".ogx_tags_input:first").prop("placeholder",r.placeholder),o.find(".ogx_tags_input:first").prop("disabled",!1),debug(5,"tags",r.id,"enabled")},this.disable=function(){u(!1),f(!1),h(!1),o.find(".ogx_tags_input:first").prop("placeholder",""),o.find(".ogx_tags_input:first").prop("disabled",!0),debug(5,"tags",r.id,"disabled")},this.destroy=function(){r.restrict&&OGX.Form.unrestrictField(o.find(".ogx_tags_input:first")[0])},this.tags=function(e){return void 0!==e?(e.hasOwnProperty("insert")||(e=new OGX.List(e)),r.tags=e,!0):r.tags},this.val=function(e){return void 0!==e?(e.hasOwnProperty("insert")||(e=new OGX.List(e)),r.current_tags=e,r.max&&r.current_tags.length>=r.max&&o.find(".ogx_tags_input:first").css("display","none"),d(r.current_tags)):r.current_tags},this.clear=function(){r.max&&r.current_tags.length===r.max&&o.find(".ogx_tags_input:first").css("display","block"),r.current_tags=new OGX.List,o.find(".ogx_tags_tags:first").empty()},this.renderTags=function(e){return d(e)},this.addTag=function(e){return n(e)},this.removeTag=function(e){return a(e)},void 0!==OGX.List?r&&r.restrict&&void 0===OGX.Form?debug(1,"OGX.Form not found! "):(function(){for(var e in r=r||{},i)r.hasOwnProperty(e)||(r[e]=i[e]);r.tags.hasOwnProperty("insert")||(r.tags=new OGX.List(r.tags)),r.current_tags.hasOwnProperty("insert")||(r.current_tags=new OGX.List(r.current_tags)),t.el=o=$(r.el),o.addClass("ogx_tags")}(),function(){var e='<span class="ogx_tags_tags"></span><input type="text" class="ogx_tags_input" placeholder="'+r.placeholder+'">';if(r.name&&(e+='<input type="hidden" name="'+r.name+'">'),o.html(e),r.restrict){var t={multiline:!1,max:30};"object"==typeof r.restrict&&(t=r.restrict),t.el=o.find(".ogx_tags_input:first")[0],OGX.Form.restrictField(t)}}(),0<r.current_tags.length&&(d(r.current_tags),s())):debug(1,"OGX.List not found! ")},OGX.Tags.prototype.tagDataset=function(e,t,i){"use strict";void 0===i&&(i=!1);for(var n,a=[],o=0;o<e.length;o++)for(var r=0;r<t.length;r++)if(e[o].hasOwnProperty(t[r])){n=e[o][t[r]].split(" ");for(var s=0;s<n.length;s++)i&&-1!==i.indexOf(n[s])||-1===a.indexOf(n[s])&&a.push(n[s])}return a},OGX.Tags.prototype.tagDatatree=function(e,t){"use strict";!function(e,a){var o=[];if(function e(t){if(t.hasOwnProperty("items"))for(var i=0;i<t.items.length;i++){for(var n in t.items[i])-1<a.indexOf(n)&&-1===o.indexOf(t.items[i][n])&&o.push(t.items[i][n]);return e(t.items[i]),!0}}(e));}(e,t)},OGX.Tags.NAME="Tags",OGX.Tags.CHANGE="TagsChange",OGX.Tags.TAG_ADDED="TagsTagAdded",OGX.Tags.TAG_REMOVED="TagsTagRemoved",OGX.Tags.MODE_STRING="TagsModeString",OGX.Tags.MODE_OBJECT="TagsModeObject",OGX.Tags.MODE_ASCII="TagsModeAscii",OGX.Tags.BIND=OGX.Tags.CHANGE,void 0===OGX)var OGX={};if(OGX.Templater=function(){"use strict";var s;this.templatize=function(e,t,i,n,a){var o,r;for(s={},void 0===a&&(a={}),OGX.Data.merge(s,a),debug(5,"templater templatizing",e);o=/{{[^{]+(({[^{]+)+)?}}/gi.exec(e);)r=(r=OGX.OSE.exec(o[0],t,i,n,s))||"",e=e.replace(o[0],r);return debug(5,"templater templatized",e),e},this.getTemplate=function(e){return debug(4,"templater get template",e,"found?",!1!==OGX.Cache.get("html",e)),OGX.Cache.get("html",e)}},OGX.Templater=new OGX.Templater,require("Theater","Uxi","Touch"),OGX.Theater=function(e){construct(this,"Theater");var a,o,n,r=this,s=e,t={anim:!1,display:!0,icon_size:50,timeout:30},i={template:!1,html:'<span class="ogx_theater_stage_icon" style="background-image:url(\'{{$icon}}\')"></span><span class="ogx_theater_stage_label">{{$label}}</span>'},l='<div class="list"></div>',d=!0;function c(e){e?($(document).on("backbutton",u),$(window).on("popstate",u),list.el.on(OGX.DynamicList.SELECT,function(e,t){!function(e){debug(3,"theater show stage",e),r.el.trigger(OGX.Theater.HIDE);var t=app.find(OGX.Stage.NAME,e);t.wake(),t.resizeNodes();var i,n=list.el.find('.ogx_theater_stage[data-ogx-id="'+t.id+'"]').position();r.observe(!0,{childList:!0},function(){r.observe(!1),(i=o.children(".ogx_theater_trans:first")).on("transitionend",function(){i.off("transitionend"),r.hide(),i.remove(),t.url?(app.showStage(t.id,!1),app.router.addToHist(t.url)):app.goto(t.id+"/"+t.home)}),i.removeClass("ogx_theater_trans_hide"),setTimeout(function(){i.addClass("ogx_theater_trans_grow").css({opacity:1,width:"100%",height:"100%",transform:"translate3d(0px, 0px, 0px)"})},s.timeout)},o),o.append('<div class="ogx_theater_trans ogx_theater_trans_hide" style="width:'+s.icon_size+"px; height:"+s.icon_size+"px; transform:translate3d("+n.left+"px,"+n.top+'px, 0px);" data-ogx-id="'+t.id+'"><div class="icon" style="background-image:url(\'/img/'+t.theater.icon+"')\"></div></div>")}(t.id)})):($(document).off("backbutton",u),$(window).off("popstate",u),list.el.off(OGX.DynamicList.SELECT))}function u(){r.hide()}function f(){a.prepend(l);for(var e,t=[],i=0;i<n.length;i++)e={id:n[i].id,name:"",icon:""},"object"==typeof n[i].theater&&n[i].theater.hasOwnProperty("icon")&&(e.icon="./img/"+n[i].theater.icon,e.label=n[i].theater.label),t.push(e);$(".ogx_theater > .list").on(OGX.DynamicList.RENDER,function(e){$(".ogx_theater > .list").off(OGX.DynamicList.RENDER),setTimeout(function(){l=$(".ogx_theater:first").detach()},0)}),list=r.create("DynamicList",{el:".ogx_theater > .list",display:{html:s.display.html,css:"ogx_theater_stage"},key:"id",scroll:!0,mode:"hit",list:t,trigger:!0})}function h(){var e=app.gather(OGX.Stage.NAME);n=[];for(var t=0;t<e.length;t++)e[t].theater&&n.push(e[t])}this._NAME_=OGX.Theater.NAME,this.update=function(){h()},this.show=function(){d&&(debug(3,"show theater"),o.prepend(l),function(){r.el.trigger(OGX.Theater.SHOW);var i,n=app.getStage();r.observe(!0,{childList:!0},function(e){r.observe(!1),n.sleep(),i=o.children(".ogx_theater_trans:first");var t=list.el.find('.ogx_theater_stage[data-ogx-id="'+n.id+'"]').position();i.removeClass("ogx_theater_trans_hide"),setTimeout(function(){i.on("transitionend",function(){i.off("transitionend"),setTimeout(function(){i.remove()},0)}),i.addClass("ogx_theater_trans_show").addClass("ogx_theater_trans_shrink").css({opacity:0,width:s.icon_size+"px",height:s.icon_size+"px",transform:"translate3d("+t.left+"px, "+t.top+"px, 0px)"})},s.timeout)},o),o.append('<div class="ogx_theater_trans ogx_theater_trans_hide" data-ogx-id="'+n.id+'"><div class="icon" style="background-image:url(\'/img/'+n.theater.icon+"')\"></div></div>"),a.css("visibility","visible")}(),this.focusNodes(),c(!0),d=!1)},this.hide=function(){d||(debug(3,"hide theater"),this.blurNodes(),l=a.detach(),c(!1),d=!0)},this.tile=function(e,t){void 0===t&&(t="x")},void 0!==OGX.DynamicList?(OGX.Data.merge(s,t),s.display&&("object"!=typeof s.display&&(s.display={}),OGX.Data.merge(s.display,i),s.display.template&&(s.display.html=OGX.Templater.getTemplate(s.display.template))),r.el=a=$(s.el),a.addClass("ogx_theater").css("visibility","hidden"),o=$("body"),"undefined"!=typeof app?(h(),$(document).on(OGX.App.READY,f),debug(5,"theater init")):debug(1,"No instance of OGX.App!")):debug(1,"OGX.DynamicList not found! ")},OGX.Theater.NAME="Theater",OGX.Theater.ZOOM="TheaterZoom",OGX.Theater.SHOW="TheaterShow",OGX.Theater.HIDE="TheaterHide",OGX.Touch=function(e){"use strict";var t=this;this.touch=!1,this.touch||this.initTouch(e.chromeos),this.touch.swipe=new OGX.Touches.Swipe(this),this.touch.hold=new OGX.Touches.Hold(this),this.touch.drag=new OGX.Touches.Drag(this),this.touch.enable=function(){t.touch.swipe.enable(),t.touch.hold.enable(),t.touch.drag.enable()},this.touch.disable=function(){t.touch.swipe.disable(),t.touch.hold.disable(),t.touch.drag.disable()}},OGX.Touch.prototype.initTouch=function(e){void 0===e&&(e=!1),this.touch={hold:{}},this.touch.down="mousedown",this.touch.up="mouseup",this.touch.move="mousemove",void 0===window.ontouchstart||e||(this.touch.down="touchstart",this.touch.up="touchend",this.touch.move="touchmove")},OGX.Touch.prototype.touchable=function(){return void 0!==window.ontouchstart},OGX.Touch.prototype.event=function(e){return e.hasOwnProperty("originalEvent")&&void 0!==e.originalEvent.changedTouches?e.originalEvent.changedTouches[0]:e},OGX.Touches={},OGX.Touches.Swipe=function(e){"use strict";var t,i=e,n={speed:10,x:!0,y:!1,min_x:100,min_y:100,cb_down:!1,cb_swipe:!1,cb_up:!1,target:!1},a=!1,o={x:0,y:0},r={x:0,y:0},s=0,l=0,d=0,c=0,u=0,f=!1,h=!1,_=!1;function g(e){_||(_=!0,e=i.event(e),o.x=e.pageX,o.y=e.pageY,d=c=0,s=l=u=0,p(!0),a.cb_down&&a.cb_down(o))}function p(e){e?(m(!0),f=setInterval(O,a.speed)):(m(!1),f&&(clearInterval(f),f=!1))}function m(e){e?t.on(i.touch.move,x):t.off(i.touch.move,x)}function v(e){e?($("body").on(i.touch.up,y),t.on(i.touch.down,g)):($("body").off(i.touch.up,y),t.off(i.touch.down,g))}function y(e,t){h&&(void 0===t&&(t=!1),p(!1),_&&a.cb_up&&a.cb_up({pt0:o,pt1:r,distX:d,distY:c,dist:u,dirX:s,dirY:l,swipe:t}),_=!1)}function x(e){e=i.event(e),r.x=e.pageX,r.y=e.pageY,s=r.x>o.x?1:-1,l=r.y>o.y?1:-1,d=Math.abs(r.x-o.x),c=Math.abs(r.y-o.y),u=Math.sqrt(Math.abs(Math.pow(r.x-o.x,2)-Math.pow(r.y-o.y,2)))}function O(){a.cb_swipe&&(a.x&&a.min_x&&d>=a.min_x||a.y&&a.min_y&&c>=a.min_y?y(0,!0):a.cb_swipe({pt0:o,pt1:r,dirX:s,dirY:l,distX:d,distY:c,dist:u}))}this.set=function(e){a=a||OGX.Data.clone(n),OGX.Data.merge(a,e,!0),t=i.el,a.target},this.enable=function(){!h&&a&&v(h=!0)},this.disable=function(){h&&a&&(v(h=!1),p(!1))}},OGX.Touches.Hold=function(e){"use strict";var t={cb_hold:!1,cb_up:!1,cb_move:!1,time:1e3,el:this.el,target:!1},i=!1,n=!1,a=!1,o=!1,r=!1,s=!1,l=e,d={x:0,y:0},c={x:0,y:0},u=!1;function f(e){e=l.event(e),u=e.target.offsetParent,o||(o=!0,n=(new Date).getTime(),d.x=l.el.offset().left+e.pageX,d.y=l.el.offset().top+e.pageY,$("body").on(l.touch.move,h),a=setInterval(_,1))}function h(e){e=l.event(e),c.x=l.el.offset().left+e.pageX,c.y=l.el.offset().top+e.pageY,!r&&5<Math.abs(d.x-c.x)||5<Math.abs(d.y-c.y)?(clearInterval(a),a=!1):i.cb_move&&i.cb_move(c,{x:c.x-d.x,y:c.y-d.y})}function _(){o&&(new Date).getTime()-n>i.time&&(r||(r=!0,i.cb_hold?i.cb_hold(u):l.el.trigger(OGX.Touch.HOLD_START)))}function g(){o=r=!1,$("body").off(l.touch.move,h),clearInterval(a),a=!1,i.cb_up?i.cb_up():l.el.trigger(OGX.Touch.HOLD_END)}this.set=function(e){i=e,OGX.Data.merge(i,t)},this.enable=function(){!s&&i&&(s=!0,l.el.on(l.touch.down,i.target,f),$("body").on(l.touch.up,g))},this.disable=function(){s&&i&&(s=!1,(o||a)&&(o=r=!1,clearInterval(a),a=!1),l.el.off(l.touch.down,i.target,f),$("body").off(l.touch.up,g),$("body").off(l.touch.move,h))}},OGX.Touches.Drag=function(o){"use strict";var r,s,l,d,c,u,f=!1,t={x:!0,y:!0,min:10,limit_x:null,limit_y:null,target:!1,cb_down:!1,cb_drag:!1,cb_up:!1,border:10},h=o,i=!1,e=!1;function n(e){var t=[];t=f.target?[h.touch.down,f.target,a]:[h.touch.down,a],e?h.el.on.apply(h.el,t):h.el.off.apply(h.el,t)}function a(e){e=o.event(e),l=e.pageX,d=e.pageY;var t=h.el.position();r=t.left,s=t.top;var i=h.el.offset(),n=l-i.left,a=d-i.top;if(f.border){if(n<f.border||n>h.el.width()-f.border)return;if(a<f.border||a>h.el.height()-f.border)return}_(!(u=c=0)),g(!0),f.cb_down&&f.cb_down()}function _(e){e?i=i||setInterval(v,10):i&&(clearInterval(i),i=null)}function g(e){e?($("body").on(h.touch.move,m),$("body").on(h.touch.up,p)):($("body").off(h.touch.move,m),$("body").off(h.touch.up,p))}function p(e){_(!1),g(!1),e=o.event(e),f.x&&(c=e.pageX-l),f.y&&(u=e.pageY-d),f.cb_up&&f.cb_up({distX:c,distY:u})}function m(e){e=o.event(e);var t,i=!1;f.x&&(t=e.pageX-l,null!==f.limit_x?t>=f.limit_x.min&&t<=f.limit_x.max&&(f.min?Math.abs(t)>f.min&&(c=t,i=!0):(c=t,i=!0)):f.min?Math.abs(t)>f.min&&(c=t,i=!0):c=t),f.y&&(t=e.pageY-d,null!==f.limit_y?t>=f.limit_y.min&&t<=f.limit_y.max&&(f.min?Math.abs(t)>f.min&&(u=t,i=!0):(u=t,i=!0)):u=t),i&&f.cb_drag&&f.cb_drag({distX:c,distY:u})}function v(){h.el.css({transform:"translate3d("+(r+c)+"px, "+(s+u)+"px, 0px)"})}this.dragable=!0,this.set=function(e){f=e,OGX.Data.merge(f,t)},this.enable=function(){!e&&f&&n(e=!0)},this.disable=function(){e&&f&&(n(e=!1),g(!1),_(!1))}},OGX.Touch.HOLD_START="TouchHoldStart",OGX.Touch.HOLD_END="TouchHoldEnd",require("Tree","Uxi","Touch"),OGX.Tree=function(e){construct(this,"Tree");var n,a,o,r,t,i,s,l,d=this,c=e,u={show_root:!0,root_label:"root",editable:!1,sort:{enabled:!0,property:"label",way:1},toggle:!0,drag_after:1e3,icon_size:30,scope:["public"],chromeos:!1,types:{root:{mode:"folder",icons:{open:"folder_open",close:"folder_closed",empty:null}},file:{mode:"file",icon:"file"},folder:{mode:"folder",icons:{open:"folder_open",close:"folder_closed",empty:null}}},data:{id:0,type:"root",label:c.root_label,state:"closed",items:[]},template:'<div class="ogx_tree_item" data-id="{{$_id_}}"><span class="ogx_tree_item_arrow {{$arrow_style}} {{$arrow_display}}"><span style="width:{{$arrow_size}}; height:{{$arrow_size}}"></span></span><span class="ogx_tree_item_icon {{$icon}}" style="width:{{$size}}px; height:{{$size}}px;"></span><div class="ogx_tree_item_label">{{$label}}</div><div class="ogx_tree_item_container {{$container_display}}"></div></div>'};function f(){var e={icon:T({type:"root",state:"open"}),size:c.icon_size,_id_:c.data._id_,label:c.root_label,container_display:"",arrow_display:"",arrow_style:"ogx_tree_item_arrow_open",arrow_size:Math.round(c.icon_size/2)+"px"};n.html(OGX.Templater.templatize(c.template,e)),c.data.element=n.children(".ogx_tree_item:first")}function h(){f(),_(c.data,c.data.element)}function _(e,t){if(e.hasOwnProperty("items")){var i,n;i=c.sort.enabled?function(e,t,i){return e.sort(function(i,n){return function(e,t){return e[i]<t[i]?-1*n:e[i]>t[i]?n:0}}(t,i)),e}(e.items,c.sort.property,c.sort.way):e.items;for(var a=0;a<i.length;a++)n={icon:null,size:c.icon_size,_id_:e.items[a]._id_,label:e.items[a].label,container_display:"",arrow_display:"",arrow_style:"",arrow_size:Math.round(c.icon_size/2)+"px"},e.items[a].hasOwnProperty("state")||(e.items[a].state="close"),"folder"===C(e.items[a])?(e.items[a].items.length||(e.items[a].state="close",n.arrow_style="ogx_tree_item_arrow_disabled"),"open"===e.items[a].state?n.arrow_style="ogx_tree_item_arrow_open":(n.arrow_style+=" ogx_tree_item_arrow_close",n.container_display="ogx_tree_item_container_hidden")):n.arrow_display="ogx_tree_item_arrow_hidden",n.icon=T(e.items[a]),t.children(".ogx_tree_item_container:last").append(OGX.Templater.templatize(c.template,n)),e.items[a].element=t.children(".ogx_tree_item_container:last").children(".ogx_tree_item:last"),_(e.items[a],e.items[a].element)}}function g(e){var t=JSON.parse(JSON.stringify(e));return delete t._id_,delete t.element,t}function p(e){"folder"===C(e)&&(e.items.length||(e.state="close",e.element.children(".ogx_tree_item_arrow:first").addClass("ogx_tree_item_arrow_disabled")),"open"===e.state?(e.element.children(".ogx_tree_item_arrow:first").removeClass("ogx_tree_item_arrow_close").removeClass("ogx_tree_item_arrow_disabled").addClass("ogx_tree_item_arrow_open"),e.element.children(".ogx_tree_item_container:first").css("display","block")):(e.element.children(".ogx_tree_item_arrow:first").removeClass("ogx_tree_item_arrow_open").addClass("ogx_tree_item_arrow_close"),e.element.children(".ogx_tree_item_container:first").css("display","none")),e.element.children(".ogx_tree_item_icon:first").attr("class","ogx_tree_item_icon "+T(e)))}function m(){if(s){var e=b(s);e&&(e.children(".ogx_tree_item_icon:first").removeClass("ogx_tree_selected_item"),s=null)}}function v(i,n){var a,o;return E(function(e,t){return a=e.element.offset(),o=e.element.children(".ogx_tree_item_icon:first"),i>=a.left&&i<=a.left+o.width()&&n>=a.top&&n<=a.top+o.height()&&e})}function y(a){return E(function(e,t,i,n){return e._id_===a&&(i.items.splice(n,1),i.items.length||(i.state="close"),p(i),!0)})}function x(t,i){return E(function(e){return e._id_===i&&(e.items.push(t),e.state="open",p(e),!0)})}function O(i){return E(function(e,t){return e._id_===i&&e})}function b(e){var t=O(e);return!!t&&t.element}function w(i){return E(function(e,t){return i===t+"/"+e.label&&e})}function G(e){var t=w(e);return!!t&&t.element}function X(){l=1,E(function(e){return e._id_=l++,e.hasOwnProperty("type")||(e.hasOwnProperty("items")?e.type="folder":e.type="file"),!1})}function E(r,e){var s;if(void 0===e&&(e=c.data),s=function e(t,i,n,a){if(s=r(t,i,n,a))return s;if(t.hasOwnProperty("items")&&t.items.length)for(var o=0;o<t.items.length;o++)if(s=e(t.items[o],i+"/"+t.label,t,o))return s;return!1}(e,""))return s}function T(e){return!!c.types.hasOwnProperty(e.type)&&(c.types[e.type].hasOwnProperty("icons")?"close"===e.state&&!e.items.length&&c.types[e.type].icons.hasOwnProperty("empty")?c.types[e.type].icons.empty:c.types[e.type].icons[e.state]:c.types[e.type].icon)}function C(e){return!!c.types.hasOwnProperty(e.type)&&c.types[e.type].mode}function D(e){var t,i;i=g(O(t=e.data("id"))),c.toggle?e.children(".ogx_tree_item_icon:first").hasClass("ogx_tree_selected_item")?(m(),n.trigger(OGX.Tree.UNSELECT,i)):(m(),e.children(".ogx_tree_item_icon:first").addClass("ogx_tree_selected_item"),s=t,n.trigger(OGX.Tree.SELECT,i)):(m(),e.children(".ogx_tree_item_icon:first").addClass("ogx_tree_selected_item"),n.trigger(OGX.Tree.SELECT,i))}function M(e){e?(c.editable?(n.on(d.touch.down,".ogx_tree_item > .ogx_tree_item_icon",function(e){e.preventDefault(),D($(this).parent(0)),1!==$(this).parent(0).data("id")&&function(){t&&clearInterval(t);i=(new Date).getTime(),t=setInterval(L,50)}()}),$(document).on(d.touch.up,function(){N(),o&&(S(!1),function(){var e=o.offset().left,t=o.offset().top,i=v(e,t);a=!i||i&&(i._id_===a._id_||"folder"!==C(i))?(r.css("opacity",1),o.remove(),o=null):(function(e,t){y(e._id_),x(e,t._id_),t.element.children(".ogx_tree_item_container:first").empty(),t.state="open",_(t,t.element),p(t)}(a,i),r.remove(),o.remove(),o=null,n.trigger(OGX.Tree.DROP,a),null)}())})):n.on("click",".ogx_tree_item > .ogx_tree_item_icon",function(e){e.preventDefault(),D($(this).parent(0))}),n.on(d.touch.down,".ogx_tree_item_arrow",function(e){if(e.preventDefault(),N(),0<$(this).parent(0).children(".ogx_tree_item_container:first").children().length){var t=O($(this).parent(0).data("id"));"open"===t.state?(t.state="close",n.trigger(OGX.Tree.CLOSE,t)):(t.state="open",n.trigger(OGX.Tree.OPEN,t)),p(t)}})):(c.editable?n.off(d.touch.down,".ogx_tree_item > .ogx_tree_item_icon"):n.off("click",".ogx_tree_item > .ogx_tree_item_icon"),n.off(d.touch.down,".ogx_tree_item_arrow"))}function L(){(new Date).getTime()-i>=c.drag_after&&(s&&(a=O(s))&&function(e){(o=(r=e).clone()).children(".ogx_tree_item_arrow:first").css("display","none"),e.css("opacity",.3),o.addClass("ogx_tree_item_drag"),o.css({top:e.offset().top,left:e.offset().left}),n.prepend(o),S(!0),n.trigger(OGX.Tree.DRAG,a)}(a.element),N())}function S(e){e?$(document).on(d.touch.move,function(e){e=function(e){if(e.hasOwnProperty("originalEvent")&&void 0!==e.originalEvent.changedTouches)return e.originalEvent.changedTouches[0];return e}(e),o.css({top:e.pageY+"px",left:e.pageX+"px"})}):$(document).off(d.touch.move)}function N(){t&&(clearInterval(t),t=null)}this._NAME_=OGX.Tree.NAME,this.el=null,this.enable=function(){M(!0),debug(5,"tree",c.id,"enabled")},this.disable=function(){M(!1),debug(5,"tree",c.id,"disabled")},this.setIconSize=function(i){c.icon_size=i,n.find(".ogx_tree_item_icon").each(function(e,t){$(t).css({width:i+"px",height:i+"px"})}),$(".ogx_tree_item_arrow span").css({width:Math.round(c.icon_size/2)+"px",height:Math.round(c.icon_size/2)+"px"})},this.addItem=function(e){if(s){var t=O(s);return"folder"===C(t)&&(e._id_=++l,x(e,s),t.element.children(".ogx_tree_item_container:first").empty(),t.state="open",_(t,t.element),t.element.children(".ogx_tree_item_container:first").css("display","block")),!0}return!1},this.selectItemByPropVal=function(e,t){var i=function(i,n){return E(function(e,t){return!(!e.data.hasOwnProperty(i)||e.data[i]!==n)&&t+"/"+e.label})}(e,t);return!!i&&(m(),function(e){var t=b(e);t&&(s=e,t.children(".ogx_tree_item_icon:first").addClass("ogx_tree_selected_item"))}(i._id_),!0)},this.selectItemByPath=function(e){var t=G(e);return!!t&&(m(),t.addClass("ogx_tree_selected_item"),s=t.data("id"),!0)},this.updateSelectedItemDataProperty=function(e,t){return!!s&&(O(s).data[e]=t,!0)},this.updateSelectedItemData=function(e){return!!s&&(O(s).data=e,!0)},this.updateSelectedItemLabel=function(e){if(s){var t=O(s);return t.label=e,b(t._id_).children(".ogx_tree_item_label:first").html(e),!0}return!1},this.deleteItemByPath=function(e){var t=G(e);return!!t&&y(t.data("id"))},this.deleteSelectedItem=function(){return function(){if(s)return E(function(e,t,i,n){if(e._id_===s)return e.element.remove(),i.items.splice(n,1),p(i),!0});return!1}()},this.getSelectedItem=function(){return function(){if(s)return O(s);return!1}()},this.getTree=function(){var e=E(g,JSON.parse(JSON.stringify(c.data)));if(e)return e},this.setData=function(e){e.hasOwnProperty("types")&&this.setTypes(e.types),e.hasOwnProperty("tree")&&this.setTree(e.tree)},this.setTypes=function(e){c.types=e},this.setTree=function(e){c.data=e,c.data.hasOwnProperty("state")||(c.data.state="open"),X(),h()},this.newTree=function(){l=1,c.data={_id_:l,type:"root",state:"open",label:c.root_label,element:null,items:[]},f()},this.filterTree=function(e){!function(a){var o=[];(function e(t,i){if(-1!==(i+t.label).indexOf(a)&&o.push(i+"/"+t.label),t.hasOwnProperty("items")&&t.items.length)for(var n=0;n<t.items.length;n++)e(t.items[n],i+"/"+t.label,t,n)})(c.data,"")}(e)},void 0!==OGX.Templater?(function(){if(OGX.Data.merge(c,u),d.el=n=$(c.el),n.addClass("ogx_tree"),n.attr("data-ogx-id",d.id),Array.isArray(c.data)){var e=JSON.stringify(c.data);c.data={type:"root",label:c.root_label,items:JSON.parse(e)}}}(),X(),c.data&&h(),debug(5,"tree",c.id,"init")):debug(1,"OGX.Templater not found! ")},OGX.Tree.NAME="Tree",OGX.Tree.SELECT="TreeSelect",OGX.Tree.UNSELECT="TreeUnselect",OGX.Tree.OPEN="TreeOpen",OGX.Tree.CLOSE="TreeClose",OGX.Tree.DRAG="TreeDrag",OGX.Tree.DROP="TreeDrop",void 0===OGX)var OGX={};if(require("TreedList","Uxi"),OGX.TreedList=function(e){construct(this,"TreedList");var a=this,t={renderer:"Tree",list:new OGX.List,types:null,display:null,displays:null,group_by:null,group_mode:null,group_param:null},l=e,o=null,r=null;function i(){switch(s(l.list),l.renderer){case OGX.Tree.NAME:t={el:l.el,data:void 0},l.types&&(t.types=l.types),t.tree=function(){var e={type:"root",label:"root",state:"open",items:[]};return function e(t,i){if(Array.isArray(t)){for(var n=0;n<t.length;n++)t[n].type="file";i.items=t}else for(var a in t)i.items.push({type:"folder",label:a,state:"open",items:[]}),e(t[a],i.items[i.items.length-1])}(o,e),e}(),r=a.create(l.renderer,t);break;case OGX.StackedTree.NAME:(t=function(){var e={display:!1,displays:!1};l.display&&l.display.hasOwnProperty("bind")?(e.display=OGX.Data.clone(l.display),e.displays=OGX.Data.clone(l.displays)):(e.display={bind:"__type"},e.displays={__default:OGX.Data.clone(l.display)},"object"==typeof e.displays.__default.css?e.displays.__default.css.hasOwnProperty("add")?e.displays.__default.css.add+=" ogx_stacked_tree_item":e.displays.__default.css.add="ogx_stacked_tree_item":e.displays.__default.css={add:e.displays.__default.css+" ogx_stacked_tree_item"});for(var t=0;t<l.group_by.length;t++)grp=l.group_by[t],e.displays[grp]={html:"{{$label}}",css:"ogx_stacked_tree_item"};return e}()).el=l.el;var e=function(){var e={data:[]};return function e(t,i,n,a){var o;if(Array.isArray(t)){for(var r=0;r<t.length;r++)t[r].hasOwnProperty("scope")||(t[r].scope=["public"]);i.items=t}else for(var s in t)o={label:s,__type:l.group_by[a],scope:["public"],items:[]},n?(i.data.push(o),e(t[s],i.data[i.data.length-1],!1,a+1)):(i.items.push(o),e(t[s],i.items[i.items.length-1],!1,a+1))}(o,e,!0,0),e}();t.list=e.data,l.hasOwnProperty("id")&&(t.id=l.id+"_stacked"),r=a.create(l.renderer,t);break;case OGX.RouletteTree.NAME:var t;(t=OGX.Data.clone(l)).hasOwnProperty("id")&&(t.id=t.id+"_roultree"),t.data=o;for(var i=[],n=0;n<l.group_by.length;n++)i.push(l.group_by[n].split(".").pop());t.groups=i,r=a.create(l.renderer,t)}}function s(e,t,i,n){l.list=e,void 0!==t&&(l.group_by=t),void 0!==i&&(l.group_mode=i),void 0!==n&&(l.group_param=n),o=l.list.group(l.group_by,l.group_mode,l.group_param)}this._NAME_=OGX.TreedList.NAME,this.el=null,this.val=function(e,t,i,n){return void 0!==e&&s(e),o},this.getRenderer=function(){return r},this.getTree=function(){return o},function(){if(void 0!==OGX.List){switch(l&&void 0!==l||(l={}),OGX.Data.merge(l,t),l.list.hasOwnProperty("insert")||(l.list=new OGX.List(l.list)),$(l.el).addClass("ogx_treedlist"),l.renderer){case"StackedTree":if(void 0===OGX.StackedTree)return debug(1,"OGX.StackedTree not found! ");break;case"Tree":if(void 0===OGX.Tree)return debug(1,"OGX.Tree not found! ");break;case"RouletteTree":if(void 0===OGX.RouletteTree)return debug(1,"OGX.RouletteTree not found! ")}i(),debug(5,"treedlist",l.id,"init")}else debug(1,"OGX.List not found! ")}()},OGX.TreedList.NAME="TreedList",void 0===OGX)var OGX={};require("Uxi","Overlay","Loading"),OGX.Uxi=function(e){construct(this,"Uxi"),this.sleeping=!1,this.blured=!0,this.floating=!1,this.scroll=!1,this.enabled=!1,this.always_on=!1,this.nodes=new OGX.List,this.points={},this.observer=!1,this.parent=null;var t=!(config_default={id:(new Date).getTime()+""+Math.round(1e3*Math.random()),enabled:!0,always_on:!1,scroll:!1,el:!1});void 0===e&&(e={}),OGX.Data.merge(e,config_default),this.id=e.id,this.enabled=e.enabled,this.always_on=e.always_on,this.scroll=e.scroll,this.selector=e.el;var i="#"===this.id.substr(0,1);if(i&&(this.id=this.id.substr(1)),e.el){var n=$(e.el),a="ogx_uxi";this.enabled||(a+=" ogx_uxi_disabled");var o='<div class="'+a+'" data-ogx-id="'+this.id+'"';i&&(o+=' id="'+this.id+'"'),o+="></div>",e.scroll?(t=this.create("Scroller",{id:this.id+"_scroller",el:e.el}),e.el=t.inner(),(n=$(e.el)).addClass(a).attr("data-ogx-id",this.id),i&&n.attr("id",this.id),setTimeout(function(){t.resize()},0)):(n.append(o),e.el='.ogx_uxi[data-ogx-id="'+this.id+'"]')}},OGX.Uxi.prototype.enable=function(){},OGX.Uxi.prototype.disable=function(){},OGX.Uxi.prototype.ux=function(){},OGX.Uxi.prototype.construct=function(){},OGX.Uxi.prototype.destroy=function(){},OGX.Uxi.prototype.resize=function(){},OGX.Uxi.prototype.show=function(){this.el&&this.el.removeClass("ogx_uxi_hide")},OGX.Uxi.prototype.hide=function(){this.el&&this.el.addClass("ogx_uxi_hide")},OGX.Uxi.prototype.observe=function(e,t,i,n){var a=this,o=this.el;if(void 0!==n&&(o=n),e){if(!this.observer)return void 0===t&&(t={childList:!0,subtree:!0}),this.observer=new MutationObserver(function(e,t){e.forEach(function(e){void 0!==i?i(e):a.el.trigger(OGX.View.CHANGED,e)})}),this.observer.observe(o[0],t),!0}else if(this.observer)return this.observer.disconnect(),!(this.observer=null);return!1},OGX.Uxi.prototype.sleep=function(){this.sleeping||(this.blur(),this.sleeping=!0,this.scroll?(this.__parent=this.el.parent(".ogx_scroller_outer:first").parent(0),this.el=this.__parent.children(".ogx_scroller_outer:first").detach()):(this.__parent=this.el.parent(0),this.el=this.el.detach()))},OGX.Uxi.prototype.wake=function(e){e=void 0===e?this.__parent:$(e),this.sleeping&&(this.sleeping=!1,e.prepend(this.el),this.el=e.find('.ogx_uxi[data-ogx-id="'+this.id+'"]'),this.focus(),delete this.__parent)},OGX.Uxi.prototype.resizeNodes=function(){for(var e=this.gather(),t=0;t<e.length;t++)e[t].resize()},OGX.Uxi.prototype.kill=function(){debug(5,"destroy",this._NAME_,this.id),OGX.Object.destroy(this)},OGX.Uxi.prototype.reveal=function(){var e=this.path();if(e){for(var t=0;t<e.length;t++)0<t&&e[t]._NAME_===OGX.Carousel.NAME&&e[t-1]._NAME_===OGX.Container.NAME||(e[t].floating?e[t].show():e[t].show(this._NAME_,this.id));return!0}},OGX.Uxi.prototype.blur=function(e){void 0===e&&(e=!0),this.always_on||this.blured||(this.blured=!0,this.ux(!1),this.disable(),e&&this.blurNodes())},OGX.Uxi.prototype.blurNodes=function(){for(var e=this.gather(),t=0;t<e.length;t++)"function"==typeof e[t].blur&&e[t].blur(!1)},OGX.Uxi.prototype.focus=function(e){void 0===e&&(e=!0),this.blured&&(this.blured=!1,this.enabled&&(this.ux(!0),this.enable()),e&&this.focusNodes())},OGX.Uxi.prototype.focusNodes=function(){for(var e=this.gather(),t=0;t<e.length;t++)"function"==typeof e[t].focus&&e[t].focus(!1)},OGX.Uxi.prototype.path=function(){for(var e=new OGX.List,t=this;t&&t.hasOwnProperty("parent");)e.insert(t,0),t=t.parent;return e.shift(),e},OGX.Uxi.prototype.gather=function(e){var a=[],o={_NAME_:{eq:""}};return void 0!==e&&(o=Array.isArray(e)?{_NAME_:{regex:new RegExp(e.join("|"))}}:{_NAME_:{regex:new RegExp(e)}}),function e(t){if(void 0!==t&&void 0!==t.nodes&&t.nodes.length){var i=t.nodes.get(o);i&&(a=a.concat(i));for(var n=0;n<t.nodes.length;n++)void 0!==t.nodes[n]&&void 0!==t.nodes[n].nodes&&t.nodes[n].nodes.length&&(i=e(t.nodes[n]))&&i.length&&(a=a.concat(i[0]))}}(this),new OGX.List(a)},OGX.Uxi.prototype.cfind=function(e,t,i){var n={id:{eq:t}};e&&(n._NAME_={eq:e}),void 0===i&&(i=1);var a=OGX.Object.get(n,null,i);return 1===i?a:!!a.length&&a},OGX.Uxi.prototype.find=function(a,o,r){return void 0===r&&(r=!1),function e(t){var i;if(void 0!==t.nodes&&t.nodes.length){if(req={id:{eq:o}},a&&(req._NAME_={eq:a}),i=t.nodes.get(req,null,1)){if(r)switch(r){case"remove":return i.kill(),t.nodes.findDelete("id",o,1)}return i}for(var n=0;n<t.nodes.length;n++)if(i=e(t.nodes[n]))return i}return!1}(this)},OGX.Uxi.prototype.clear=function(){debug(5,"uxi clear",this._NAME_,this.id);for(var e=this.gather(),t=0;t<e.length;t++)e[t].kill();return debug(5,"uxi cleared",e.length,"nodes"),this.nodes=new OGX.List,!0},OGX.Uxi.prototype.add=function(e){(e.parent=this).nodes.insert(e)},OGX.Uxi.prototype.remove=function(e,t){return this.find(e,t,"remove")},OGX.Uxi.prototype.create=function(e,t){"undefined"==typeof __construct&&(__construct=!0);var i=Array.prototype.slice.call(arguments),n=[];t.hasOwnProperty("data")&&n.push(t.data),n=n.concat(i.splice(0,3)),void 0!==OGX[e]&&OGX[e].hasOwnProperty("FLOAT")&&OGX[e].FLOAT&&(t.parent=this,t.el=this.el[0]);var a=OGX.Object.create(e,t);return this.add(a),"function"==typeof a.construct&&a.construct.apply(a,n),this.blured||a.focus(),t.hasOwnProperty("node:OML")&&OGX.OML.render(a,t["node:OML"]),a},OGX.Uxi.prototype.parse=function(e){e=OGX.OML.parse(e),OGX.OML.render(this,e)},OGX.Uxi.prototype.topIndex=function(){var i,n=0;return this.el.find("*").each(function(e,t){i=$(t).css("z-index"),i=Number(i),isNaN(i)||n<i&&(n=i)}),n+1},require("View","Uxi","Touch"),OGX.View=function(t){construct(this,"View");var i=this,n=!1,a=t;this.el=null,this._NAME_=OGX.View.NAME,this.enable=function(){a.observe&&this.observe(!0)},this.disable=function(){a.observe&&this.observe(!1)},this.container=function(){return n},this.render=function(e){void 0===e?a.hasOwnProperty("html")&&a.html&&n.html(a.html):n.html(e),n.trigger(OGX.View.RENDER)},function(){i.el=n=$(a.el);var e=new OGX.Display(t);a.html=e.html(t.data),n.addClass("ogx_view ogx_hw"),a.css&&n.addClass(a.css),i.render()}()},OGX.View.NAME="View",OGX.View.CHANGED="ViewChanged",OGX.View.RENDER="ViewRender",require("Window","Uxi","Placeholder","Touch","Resize"),OGX.Window=function(__config){construct(this,"Window");var that=this,container=!1,config_default={anim:!1,resize:!1,drag:!0,show:!1,width:"100%",height:"100%",min_width:100,min_height:100,max_width:0,max_height:0,head:OGX.Window.HEAD_BACK,icons:[],title:"",win_html:'<div class="ogx_window_head ogx_window_head_{{$head}} ogx_window_head_{{$side}}">$INNER</div><div class="ogx_window_body">{{$html}}</div>',win_inner:['<span class="ogx_window_main_{{$head}} ogx_window_main_icon"></span>','<span class="ogx_window_title">{{$title}}</span>','<span class="ogx_window_icons">{{loop $icons as icon { echo <span class="ogx_window_icon" style="background-image:url(&icon)"></span>; } }}</span>'],zindex:!1,close_on_click_out:!1,close_dist:100,parent:null},config=__config,pt={x:null,y:null},dir={x:0,y:0},showto=50,zd;function listenBackIcon(e){e?that.el.on(that.touch.down,".ogx_window_main_back",onBack):that.el.off(that.touch.down,".ogx_window_main_back",onBack)}function onBack(e){e.preventDefault(),e.stopImmediatePropagation(),that.hide()}function listenIcons(e){e?that.el.on(that.touch.down,".ogx_window_icon",onIcon):that.el.off(that.touch.down,".ogx_window_icon",onIcon)}function onIcon(e){that.el.trigger(OGX.Window.HIT_ICON,{index:$(this).index(),id:config.id})}function onDrag(e){(e.distX*dir.x>config.close_dist||e.distY*dir.y>config.close_dist)&&that.hide()}function onRelease(e){e.distX*dir.x>config.close_dist||e.distY*dir.y>config.close_dist?that.hide():(e.distX||e.distY)&&(config.anim&&(that.el.addClass("ogx_window_anim_in"),that.el.on("transitionend",function(){that.el.off("transitionend"),that.el.removeClass("ogx_window_anim_in")})),that.el.css("transform","translate3d("+pt.x+"px, "+pt.y+"px, 0px)"))}function render(){var e=prepWindow();container.html(e),zd=config.zindex?config.zindex:config.parent.topIndex();var t=getLimitedSize();container.css({width:t.width,height:t.height,"z-index":zd})}function getLimitedSize(){var e,t,i,n={width:config.width,height:config.height};return(config.min_width||config.max_width)&&(-1!==config.width.indexOf("%")?(e=config.parent.el.width(),i=Number(config.width.split("%")[0])*e/100):-1!==(i=config.width).indexOf("px")&&(i=Number(i.split("px")[0])),config.min_width&&i<config.min_width?n.width=config.min_width+"px":config.max_width&&i>config.max_width&&(n.width=config.max_width+"px")),(config.min_height||config.max_height)&&(-1!==config.height.indexOf("%")?(t=config.parent.el.height(),i=Number(config.height.split("%")[0])*t/100):-1!==(i=config.height).indexOf("px")&&(i=Number(i.split("px")[0])),config.min_height&&i<config.min_height?n.height=config.min_height+"px":config.max_height&&i>config.max_height&&(n.height=config.max_height+"px")),n}function listenBody(e){e?that.parent.el.on(that.touch.down,".ogx_overlay",onBody):that.parent.el.off(that.touch.down,".ogx_overlay",onBody)}function onBody(e){that.status===OGX.Window.OPEN&&(that.hide(),that.parent.removeOverlay(OGX.Overlay.Fade))}function animWindow(e,t,i,n){void 0===t&&(t=config.anim);var a={opac:1,tX:0,tY:0},o=container.parent().width(),r=container.parent().height(),s=that.el.outerWidth(),l=that.el.outerHeight(),d=that.el.find(".ogx_window_main_icon:first");switch(e&&(placeWindow(!0),d.removeClass("ogx_window_main_icon_left ogx_window_main_icon_right ogx_window_main_icon_top")),t){case OGX.Window.ANIM_NONE:break;case OGX.Window.ANIM_TOP:e?(a.tY=0,d.addClass("ogx_window_main_icon_top")):a.tY=-l-10;break;case OGX.Window.ANIM_BOTTOM:e?(a.tY=0,d.addClass("ogx_window_main_icon_bottom")):a.tY=r+10;break;case OGX.Window.ANIM_RIGHT:e?(a.tX=o-s,d.addClass("ogx_window_main_icon_right")):a.tX=o+10;break;case OGX.Window.ANIM_LEFT:e?(a.tX=0,d.addClass("ogx_window_main_icon_left")):a.tX=-s-10}var c=100;e?(pt.x=a.tX,pt.y=a.tY):c=0,setTimeout(function(){dir.x,that.el.on("transitionend",function(){that.el.off("transitionend"),e?that.el.removeClass("ogx_window_anim_in").addClass("ogx_window_open"):that.el.removeClass("ogx_window_anim_out ogx_window_open"),void 0!==i&&i(n),e?(that.status=OGX.Window.OPEN,that.el.trigger(OGX.Window.OPEN,config.id)):(that.status=OGX.Window.CLOSED,that.el.trigger(OGX.Window.CLOSED,config.id))}),e?(that.status=OGX.Window.OPENING,that.el.trigger(OGX.Window.OPENING,config.id)):(that.status=OGX.Window.CLOSING,that.el.trigger(OGX.Window.CLOSING,config.id)),config.anim!==OGX.Window.ANIM_NONE&&(e?that.el.addClass("ogx_window_anim_in"):that.el.addClass("ogx_window_anim_out")),that.el.css({transform:"translate3d("+a.tX+"px, "+a.tY+"px, 0px)",opacity:a.opac,visibility:"visible"})},c)}function placeWindow(e){var t=container.parent().width(),i=container.parent().height(),n=that.el.outerHeight(),a=that.el.outerWidth();that.el.removeClass("ogx_window_anim_in").removeClass("ogx_window_anim_out");var o={x:0,y:0};switch(config.anim){case OGX.Window.ANIM_TOP:o.y=e?-n:n,dir.y=-1;break;case OGX.Window.ANIM_BOTTOM:o.y=e?i:i-n,dir.y=1;break;case OGX.Window.ANIM_RIGHT:o.x=e?t:t-a,dir.x=1;break;case OGX.Window.ANIM_LEFT:e&&(o.x=-a),dir.x=-1}that.el.css({transform:"translate3d("+o.x+"px, "+o.y+"px, 0px)"})}function prepWindow(){var e=new OGX.Display(config),t={};t.head=config.head,t.title=config.title,t.icons=config.icons,t.html=e.html();var i=config.win_html,n="";switch(config.anim){case OGX.Window.ANIM_RIGHT:case OGX.Window.ANIM_TOP:case OGX.Window.ANIM_BOTTOM:n=config.win_inner,t.side="right";break;case OGX.Window.ANIM_LEFT:n=config.win_inner.reverse(),t.side="left"}return n=n.toString().replace(/>,</g,"><"),i=i.replace("$INNER",n),OGX.Templater.templatize(i,t)}function onResize(){that.resizeNodes()}function initPlaceholders(){that.placeholders(config,['.ogx_window[data-ogx-id="'+that.id+'"] > .ogx_window_body'])}function initDefaults(){OGX.Data.merge(config,app.getDefaults("windows")),OGX.Data.merge(config,config_default),-1!==config.head.indexOf(".")&&(config.head=eval(config.head)),-1!==config.anim.indexOf(".")&&(config.anim=eval(config.anim)),that.el=container=$(config.el),container.addClass("ogx_window"),that.dragable=config.drag,that.resizable=config.resize}function init(){if(initDefaults(),render(),placeWindow(!0),config.drag){var e={},t={top:!1,bottom:!1,left:!1,right:!1,cb_resize:onResize};switch(t.min_width=config.min_width,t.min_height=config.min_width,t.max_width=config.max_width,t.max_height=config.max_height,e.cb_drag=onDrag,e.cb_up=onRelease,config.anim){case OGX.Window.ANIM_LEFT:e.x=!0,e.y=!1,e.limit_x={min:-300,max:0},t.right=!0;break;case OGX.Window.ANIM_RIGHT:e.x=!0,e.y=!1,e.limit_x={min:0,max:300},t.left=!0;break;case OGX.Window.ANIM_TOP:e.x=!1,e.y=!0,e.limit_y={min:-300,max:0},t.bottom=!0;break;case OGX.Window.ANIM_BOTTOM:e.x=!1,e.y=!0,e.limit_y={min:0,max:300},t.top=!0}that.touch.drag.set(e)}config.resize&&that.setResize(t),initPlaceholders(),config.show&&that.show(),debug(5,"window",config.id,"init")}this.el=null,this._NAME_=OGX.Window.NAME,this.id=config.id,this.dragable=null,this.resizeable=null,this.floating=!0,this.status=OGX.Window.CLOSED,this.enable=function(){config.close_on_click_out&&listenBody(!0),config.head&&listenBackIcon(!0),config.icons&&listenIcons(!0),config.drag&&this.touch.enable(),config.resize&&this.enableResize(),debug(5,"window",config.id,"enabled")},this.disable=function(){config.close_on_click_out&&listenBody(!1),config.head&&listenBackIcon(!1),config.icons&&listenIcons(!1),config.drag&&this.touch.disable(),config.resize&&this.disableResize(),debug(5,"window",config.id,"disabled")},this.show=function(e,t,i){-1===[OGX.Window.OPEN,OGX.Window.OPENING].indexOf(this.status)&&(this.focus(!0),this.front(),null==e&&(e=config.anim),setTimeout(function(){animWindow(!0,e,t,i)},showto),showto=showto&&0)},this.hide=function(e,t,i){-1===[OGX.Window.CLOSED,OGX.Window.CLOSING].indexOf(this.status)&&(this.blur(!0),null==e&&(e=config.anim),animWindow(!1,e,t,i))},this.resize=function(){var e=getLimitedSize();container.css({width:e.width,height:e.height}),this.place()},this.front=function(){zd=config.parent.topIndex(),this.el.css("z-index",zd)},this.place=function(){placeWindow(this.status===OGX.Window.CLOSED)},this.destroy=function(){config.drag&&this.touch.disable()},init()},OGX.Window.NAME="Window",OGX.Window.READY="WindowReady",OGX.Window.ANIM_LEFT="left",OGX.Window.ANIM_RIGHT="right",OGX.Window.ANIM_TOP="top",OGX.Window.ANIM_BOTTOM="bottom",OGX.Window.ANIM_NONE="none",OGX.Window.HEAD_BACK="back",OGX.Window.HEAD_CLOSE="close",OGX.Window.HEAD_NONE="none",OGX.Window.CLOSING="WindowClosing",OGX.Window.CLOSED="WindowClosed",OGX.Window.OPENING="WindowOpening",OGX.Window.OPEN="WindowOpen",OGX.Window.HIT_ICON="WindowHitIcon",OGX.Window.FLOAT=!0;